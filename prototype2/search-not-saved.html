<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EchoPark - Search Results</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background: white;
            overflow-x: hidden;
        }

        .mobile-container {
            width: 100%;
            max-width: 375px;
            min-height: 100vh;
            margin: 0 auto;
            position: relative;
            background: white;
            overflow-y: auto;
            overflow-x: hidden;
        }

        /* Mobile-first responsive design */
        @media (max-width: 600px) {
            .mobile-container {
                width: 100vw;
                max-width: none;
            }
            
            /* Make overlays full screen on mobile */
            .filter-menu-panel {
                width: 100vw !important;
            }
            
            .hamburger-menu {
                width: 100vw !important;
            }
            
            .signin-modal {
                width: 100vw !important;
                max-width: none !important;
            }
        }

        @media (min-width: 601px) {
            .mobile-container {
                width: 375px;
                border: 2px solid #007bff;
                box-shadow: 0 0 30px rgba(0,123,255,0.3);
                margin: 20px auto;
                border-radius: 20px;
            }
            
            body {
                background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            }
        }

        /* Navigation - Rebuilt with clean CSS */
        .navigation-container {
            background: white;
            border-bottom: 1px solid #e8e9eb;
            padding: 16px 24px 8px;
            position: relative;
            z-index: 1000;
        }

        .navigation-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .navigation-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .navigation-right {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .hamburger-icon {
            width: 24px;
            height: 24px;
            cursor: pointer;
        }

        .logo-icon {
            height: 28px;
            cursor: pointer;
        }

        .location-info {
            display: flex;
            align-items: center;
            gap: 3px;
        }

        .location-text {
            font-family: 'Roboto', sans-serif;
            font-weight: 500;
            font-size: 14px;
            color: #006fa6;
            line-height: 24px;
        }

        .icon {
            width: 24px;
            height: 24px;
        }

        .search-container {
            background: #f5f4f3;
            border: 1px solid #e8e9eb;
            border-radius: 32px;
            padding: 16px 24px;
            display: flex;
            align-items: center;
            gap: 24px;
            height: 56px;
        }

        .search-field {
            font-family: 'Roboto', sans-serif;
            font-weight: 400;
            font-size: 16px;
            color: #666b70;
            line-height: 24px;
            border: none;
            outline: none;
            background: transparent;
            flex: 1;
        }

        .search-btn {
            background: none;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0;
        }

        .search-icon {
            width: 24px;
            height: 24px;
            display: block;
        }

        /* Override any media query rules that might hide navigation */
        @media (max-width: 600px) {
            .nav-container,
            .nav-top,
            .nav-left,
            .nav-right,
            .logo,
            .location,
            .nav-icon {
                display: block !important;
                visibility: visible !important;
                opacity: 1 !important;
            }
            
            .nav-top {
                display: flex !important;
            }
            
            .nav-left,
            .nav-right,
            .location {
                display: flex !important;
            }
        }

        @media (min-width: 601px) {
            .nav-container,
            .nav-top,
            .nav-left,
            .nav-right,
            .logo,
            .location,
            .nav-icon {
                display: block !important;
                visibility: visible !important;
                opacity: 1 !important;
            }
            
            .nav-top {
                display: flex !important;
            }
            
            .nav-left,
            .nav-right,
            .location {
                display: flex !important;
            }
        }

        .nav-top {
            display: flex !important;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            visibility: visible !important;
            opacity: 1 !important;
        }

        .nav-left {
            display: flex !important;
            align-items: center;
            gap: 16px;
            visibility: visible !important;
            opacity: 1 !important;
        }

        .hamburger-menu {
            width: 24px;
            height: 24px;
            cursor: pointer;
        }

        .logo {
            height: 28px;
            cursor: pointer;
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
        }

        .nav-right {
            display: flex !important;
            align-items: center;
            gap: 16px;
            visibility: visible !important;
            opacity: 1 !important;
            background: rgba(255, 0, 0, 0.1) !important; /* Debug background */
        }

        .location {
            display: flex !important;
            align-items: center;
            gap: 3px;
            visibility: visible !important;
            opacity: 1 !important;
            background: rgba(0, 255, 0, 0.1) !important; /* Debug background */
        }

        .location-text {
            font-family: 'Roboto', sans-serif;
            font-weight: 500;
            font-size: 14px;
            color: #006fa6;
            line-height: 24px;
        }

        .nav-icon {
            width: 24px;
            height: 24px;
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
        }

        .search-bar {
            background: #f5f4f3 !important;
            border: 1px solid #e8e9eb;
            border-radius: 32px;
            padding: 16px 24px;
            display: flex;
            align-items: center;
            gap: 24px;
        }

        .search-input {
            font-family: 'Roboto', sans-serif;
            font-weight: 400;
            font-size: 16px;
            color: #666b70;
            line-height: 24px;
            border: none;
            outline: none;
            background: transparent;
            flex: 1;
        }

        .search-icon {
            width: 24px;
            height: 24px;
        }

        /* Filter Bar */
        .filter-bar {
            background: white !important;
            border-bottom: 1px solid #e8e9eb;
            display: flex;
            height: 51px;
            align-items: center;
            position: relative;
            z-index: 4000;
        }

        /* Name Search Overlay */
        .name-search-overlay {
            position: fixed;
            top: 158px; /* Positioned at the bottom of the filter bar */
            left: 0;
            right: 0;
            width: 100%;
            z-index: 3500; /* Lower than nav/filter bar (4000) but higher than content */
            display: none;
        }

        .name-search-modal {
            background: white;
            border: 1px solid #e8e9eb;
            border-radius: 0 0 16px 16px;
            padding: 24px 24px 16px;
            height: auto;
            min-height: 120px;
            animation: slideDownModal 0.3s ease-out;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            transition: transform 0.3s ease-out;
        }

        .name-search-modal.slide-up {
            animation: slideUpModal 0.3s ease-out;
        }

        .name-search-header {
            position: relative;
            margin-bottom: 24px;
        }

        .name-search-title {
            font-family: 'Roboto', sans-serif;
            font-weight: 400;
            font-size: 16px;
            color: #242c33;
            margin: 0;
            line-height: 24px;
        }

        .name-search-close {
            position: absolute;
            top: 0;
            right: 0;
            background: none;
            border: none;
            cursor: pointer;
            padding: 0;
            width: 24px;
            height: 24px;
        }

        .name-search-close-icon {
            width: 24px;
            height: 24px;
        }

        .name-search-form {
            margin-bottom: 24px;
        }

        .name-search-input-group {
            position: relative;
            margin-bottom: 24px;
        }

        .name-search-input {
            width: 100%;
            height: 34px;
            border: none;
            background: transparent;
            font-family: 'Roboto', sans-serif;
            font-weight: 400;
            font-size: 16px;
            color: #242c33;
            line-height: 16px;
            padding: 0;
            outline: none;
            text-overflow: ellipsis;
            white-space: nowrap;
            overflow: hidden;
        }

        .name-search-input-label {
            position: absolute;
            left: 0;
            top: 8px;
            font-size: 16px;
            color: #999;
            pointer-events: none;
            transition: all 0.2s ease;
            transform-origin: left top;
        }

        .name-search-input-line {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 1px;
            background: #e8e9eb;
            transition: background-color 0.2s ease;
        }

        /* Text field states */
        .name-search-input-group[data-state="focus"] .name-search-input-label {
            transform: translateY(-20px) scale(0.75);
            color: #006fa6;
        }

        .name-search-input-group[data-state="filled"] .name-search-input-label {
            transform: translateY(-20px) scale(0.75);
            color: #999;
        }

        .name-search-input-group[data-state="focus"] .name-search-input-line {
            background: #006fa6;
        }

        .name-search-actions {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 16px;
            padding: 0 24px;
        }

        .save-search-btn {
            background: #3e8500;
            border: none;
            border-radius: 100px;
            color: white;
            font-family: 'Roboto', sans-serif;
            font-weight: 500;
            font-size: 14px;
            padding: 13px 24px;
            cursor: pointer;
            transition: background-color 0.2s ease;
            width: fit-content;
        }

        .save-search-btn:hover {
            background: #2d5f00;
        }

        .manage-alerts-link {
            display: flex;
            align-items: center;
            gap: 8px;
            font-family: 'Roboto', sans-serif;
            font-weight: 500;
            font-size: 14px;
            color: #006fa6;
            text-decoration: none;
            line-height: 22px;
        }

        .manage-alerts-link:hover {
            text-decoration: underline;
        }

        .arrow-icon {
            width: 24px;
            height: 24px;
        }

        @keyframes slideDownModal {
            from {
                transform: translateY(-100%);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        @keyframes slideUpModal {
            from {
                transform: translateY(0);
                opacity: 1;
            }
            to {
                transform: translateY(-100%);
                opacity: 0;
            }
        }

        .filter-section {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 0 8px;
            height: 100%;
            cursor: pointer;
        }

        .filter-icon {
            width: 18px;
            height: 18px;
        }

        .filter-text {
            font-family: 'Roboto', sans-serif;
            font-weight: 500;
            font-size: 14px;
            color: #006fa6;
            line-height: 24px;
        }

        .filter-divider {
            width: 1px;
            height: 50.5px;
            background: #e8e9eb;
        }

        /* Filter Pills */
        .filter-pills {
            background: white !important;
            border-bottom: 1px solid #e8e9eb;
            padding: 16px 24px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .permanent-filter {
            background: #006fa6;
            border: 1px solid #006ea6;
            border-radius: 34px;
            padding: 4px 8px;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            height: 36px;
            width: fit-content;
        }

        .location-pill {
            background: #006fa6;
            border-radius: 32px;
            padding: 4px 12px;
            display: flex;
            align-items: center;
            gap: 8px;
            height: 34px;
        }

        .location-icon {
            width: 18px;
            height: 24px;
        }

        .location-text-white {
            font-family: 'Roboto', sans-serif;
            font-weight: 700;
            font-size: 14px;
            color: white;
            line-height: 22px;
        }

        .filter-separator {
            font-family: 'Roboto', sans-serif;
            font-weight: 400;
            font-size: 14px;
            color: white;
            line-height: 22px;
        }

        .filter-description {
            font-family: 'Roboto', sans-serif;
            font-weight: 400;
            font-size: 14px;
            color: white;
            line-height: 22px;
        }

        .filter-pills-row {
            display: flex;
            gap: 8px;
            align-items: center;
            flex-wrap: wrap;
            min-height: 36px;
        }

        .filter-pill {
            background: #e6f1f5;
            border: 1px solid #006ea6;
            border-radius: 32px;
            padding: 4px 12px;
            display: flex;
            align-items: center;
            gap: 4px;
            height: 36px;
        }

        .filter-pill-text {
            font-family: 'Roboto', sans-serif;
            font-weight: 400;
            font-size: 14px;
            color: #006fa6;
            line-height: 22px;
        }

        .filter-pill-close {
            width: 30px;
            height: 30px;
            background: transparent;
            border: none;
            border-radius: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        .close-icon {
            width: 8px;
            height: 8px;
        }

        .more-filters {
            background: white;
            border: 1px solid #006ea6;
            border-radius: 32px;
            padding: 4px 16px;
            display: flex;
            align-items: center;
            height: 36px;
        }

        .more-filters-text {
            font-family: 'Roboto', sans-serif;
            font-weight: 400;
            font-size: 14px;
            color: #006fa6;
            line-height: 22px;
        }

        /* Results Header */
        .results-header {
            padding: 24px;
        }

        .results-title {
            font-family: 'Roboto', sans-serif;
            font-weight: 400;
            font-size: 16px;
            color: #242c33;
            line-height: 24px;
        }

        /* SRP Tiles */
        .results-grid {
            padding: 0 24px 24px;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .srp-tile {
            background: white;
            border: 1px solid #e8e9eb;
            border-radius: 8px;
            overflow: hidden;
            position: relative;
        }

        .tile-image-container {
            position: relative;
            height: 294px;
            overflow: hidden;
        }

        .tile-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .favorite-button {
            position: absolute;
            top: 16px;
            right: 16px;
            width: 32px;
            height: 32px;
            background: white;
            border: 1px solid #e8e9eb;
            border-radius: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        .favorite-icon {
            width: 24px;
            height: 24px;
        }

        .carousel-dots {
            position: absolute;
            left: 50%;
            top: 294px;
            transform: translateX(-50%) translateY(-50%);
            width: 121px;
            height: 12px;
            z-index: 10;
        }

        .carousel-dots img {
            width: 100%;
            height: 100%;
        }

        .tile-content {
            padding: 16px;
            border-top: 1px solid #e8e9eb;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .tile-details {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .tile-meta {
            display: flex;
            align-items: center;
            gap: 4px;
            font-family: 'Roboto', sans-serif;
            font-weight: 300;
            font-size: 16px;
            line-height: 16px;
            position: relative;
        }

        .tile-year {
            color: #242c33;
        }

        .tile-separator {
            color: #bcbfc2;
            line-height: 26px;
        }

        .tile-mileage {
            color: #242c33;
        }

        .tile-stock {
            color: #666b70;
            font-size: 12px;
            letter-spacing: 0.2px;
        }

        .tile-title {
            font-family: 'Roboto', sans-serif;
            font-weight: 500;
            font-size: 18px;
            line-height: 24px;
            color: #242c33;
            height: 48px;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            line-clamp: 2;
            -webkit-box-orient: vertical;
        }

        .tile-price-location {
            display: flex;
            align-items: end;
            gap: 21px;
        }

        .tile-price {
            display: flex;
            align-items: end;
            gap: 21px;
        }

        .price-container {
            display: flex;
            flex-direction: column;
            height: 50px;
            justify-content: end;
        }

        .price-currency {
            font-family: 'Roboto', sans-serif;
            font-weight: 700;
            font-size: 15.48px;
            line-height: 21px;
            color: #3e8500;
            letter-spacing: -0.4px;
        }

        .price-amount {
            font-family: 'Roboto', sans-serif;
            font-weight: 700;
            font-size: 26px;
            line-height: 24px;
            color: #3e8500;
            letter-spacing: 0.4px;
        }

        .tile-location {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: end;
            text-align: right;
            height: 42px;
        }

        .location-label {
            font-family: 'Roboto', sans-serif;
            font-weight: 500;
            font-size: 14px;
            line-height: 16px;
            color: #242c33;
            margin-bottom: 0;
        }

        .location-details {
            font-family: 'Roboto', sans-serif;
            font-weight: 400;
            font-size: 14px;
            line-height: 16px;
            color: #242c33;
        }

        .location-distance {
            font-size: 12px;
        }

        .tile-actions {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .calculator-button {
            width: 40px;
            height: 40px;
            border: 2px solid #006fa6;
            border-radius: 28px;
            background: transparent;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        .calculator-icon {
            width: 20px;
            height: 20px;
        }

        .test-drive-button {
            border: 2px solid #006fa6;
            border-radius: 28px;
            background: transparent;
            padding: 0 16px;
            height: 40px;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            width: 200px;
        }

        .test-drive-icon {
            width: 24px;
            height: 24px;
        }

        .test-drive-text {
            font-family: 'Roboto', sans-serif;
            font-weight: 700;
            font-size: 14px;
            color: #006fa6;
            line-height: 14px;
            white-space: nowrap;
        }

        /* Hamburger Menu */
        .hamburger-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            display: none;
        }

        .hamburger-menu-panel {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            width: 100%;
            height: 100%;
            background: #313d47;
            z-index: 5000;
            transform: translateX(-100%);
            transition: transform 0.3s ease;
            overflow-y: auto;
        }

        .hamburger-menu-panel.open {
            transform: translateX(0);
        }

        .hamburger-header {
            position: absolute;
            top: 16px;
            left: 24px;
            right: 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 40px;
        }

        .hamburger-logo {
            height: 24px;
            width: 80px;
            object-fit: contain;
        }

        .hamburger-close {
            width: 24px;
            height: 24px;
            cursor: pointer;
        }

        .hamburger-content {
            position: absolute;
            top: 80px;
            left: 0;
            right: 0;
            bottom: 72px;
            padding: 0 8px 24px 8px;
            overflow-y: auto;
        }

        .primary-links {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 32px;
        }

        .primary-link {
            background: #313d47;
            border-radius: 8px;
            height: 80px;
            display: flex;
            align-items: center;
            padding: 0 16px;
            cursor: pointer;
        }

        .primary-link-text {
            font-family: 'Roboto', sans-serif;
            font-weight: 300;
            font-size: 26px;
            line-height: 1.2;
            color: white;
            letter-spacing: -0.2px;
        }

        .secondary-links {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .secondary-link {
            background: #313d47;
            border-radius: 8px;
            height: 40px;
            display: flex;
            align-items: center;
            padding: 0 16px;
            cursor: pointer;
        }

        .secondary-link-text {
            font-family: 'Roboto', sans-serif;
            font-weight: 400;
            font-size: 16px;
            line-height: 24px;
            color: white;
        }

        .hamburger-signin {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: #313d47;
            height: 72px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 24px;
            z-index: 10;
            box-shadow: 0 -4px 8px rgba(0, 0, 0, 0.3);
        }

        .btn-signin {
            background: #3e8500;
            border: none;
            border-radius: 28px;
            padding: 13px 40px;
            height: 56px;
            width: 336px;
            font-family: 'Roboto', sans-serif;
            font-weight: 500;
            font-size: 16px;
            color: white;
            text-align: center;
            cursor: pointer;
            letter-spacing: 0.4px;
        }

        /* Toast */
        .toast-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: transparent;
            z-index: 2000;
            display: none;
            pointer-events: none;
        }

        .toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: #f4f5f7;
            border: 1px solid #e8e9eb;
            border-radius: 16px;
            padding: 16px;
            max-width: 357px;
            width: calc(100% - 18px);
            z-index: 2001;
            display: none;
        }

        .toast.alert-toast {
            background: #E6F1F5;
            border: 1px solid #006FA6;
        }

        .toast.show {
            transform: translateX(-50%) translateY(0);
            animation: slideUpToast 0.3s ease-out;
        }

        .toast.hide {
            transform: translateX(-50%) translateY(100px);
            animation: slideDownToast 0.3s ease-out;
        }

        @keyframes slideUpToast {
            from {
                transform: translateX(-50%) translateY(100px);
            }
            to {
                transform: translateX(-50%) translateY(0);
            }
        }

        @keyframes slideDownToast {
            from {
                transform: translateX(-50%) translateY(0);
            }
            to {
                transform: translateX(-50%) translateY(100px);
            }
        }

        .toast-content {
            display: flex;
            align-items: flex-start;
            gap: 16px;
        }

        .toast-left {
            display: flex;
            align-items: flex-start;
            gap: 8px;
            flex: 1;
        }

        .toast-icon {
            width: 24px;
            height: 24px;
            flex-shrink: 0;
        }

        .toast-text {
            flex: 1;
            font-family: 'Roboto', sans-serif;
            font-weight: 400;
            font-size: 16px;
            color: #666b70;
            line-height: 24px;
        }

        .toast-link {
            font-family: 'Roboto', sans-serif;
            font-weight: 500;
            font-size: 16px;
            color: #006fa6;
            text-decoration: none;
            transition: opacity 0.15s ease;
        }

        .toast-link:hover {
            text-decoration: underline;
        }

        .toast-close {
            background: none;
            border: none;
            cursor: pointer;
            padding: 0;
            flex-shrink: 0;
        }

        .toast-close-icon {
            width: 24px;
            height: 24px;
        }

        /* Sign-in Modal */
        .signin-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 5000;
            display: none;
        }

        .signin-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: white;
            z-index: 5001;
            display: none;
            transform: translateX(100%);
            transition: transform 0.3s ease-out;
            overflow-y: auto;
            padding-bottom: 80px; /* Space for sticky button */
        }

        .signin-modal.show {
            transform: translateX(0);
        }

        .signin-header {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            z-index: 10;
        }

        .signin-title-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 24px;
            background: white;
        }

        .signin-title-text {
            font-family: 'Roboto', sans-serif;
            font-weight: 700;
            font-size: 22px;
            color: #242c33;
            margin: 0;
        }

        .signin-close {
            background: none;
            border: none;
            cursor: pointer;
            padding: 0;
            width: 24px;
            height: 24px;
        }

        .signin-close-icon {
            width: 24px;
            height: 24px;
        }

        .signin-content {
            padding: 0 24px 24px 24px;
            margin-top: 80px;
            display: flex;
            flex-direction: column;
            gap: 32px;
        }

        .signin-welcome {
            display: flex;
            flex-direction: column;
            gap: 7px;
        }

        .signin-hello {
            font-family: 'Roboto', sans-serif;
            font-weight: 300;
            font-size: 32px;
            color: #242c33;
            margin: 0;
            line-height: 40px;
            letter-spacing: -0.4px;
        }

        .signin-new-user {
            display: flex;
            align-items: center;
            gap: 13px;
        }

        .signin-new-text {
            font-family: 'Roboto', sans-serif;
            font-weight: 400;
            font-size: 14px;
            color: #242c33;
            line-height: 22px;
        }

        .signin-create-link {
            font-family: 'Roboto', sans-serif;
            font-weight: 500;
            font-size: 14px;
            color: #006fa6;
            text-decoration: none;
            line-height: 24px;
        }

        .signin-create-link:hover {
            text-decoration: underline;
        }

        .signin-form {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .signin-input-group {
            min-height: 48px;
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            margin-bottom: 24px;
        }

        .signin-input {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border: none;
            background: transparent;
            font-family: 'Roboto', sans-serif;
            font-weight: 400;
            font-size: 16px;
            color: #242c33;
            line-height: 16px;
            padding: 0;
            outline: none;
            z-index: 2;
        }

        .signin-input-label {
            position: absolute;
            top: 50%;
            left: 0;
            transform: translateY(-50%);
            font-family: 'Roboto', sans-serif;
            font-weight: 400;
            font-size: 16px;
            color: #a2a6ab;
            line-height: 16px;
            pointer-events: none;
            transition: all 0.2s ease;
            z-index: 1;
        }

        .signin-input-line {
            position: absolute;
            bottom: 8px;
            left: 0;
            right: 0;
            height: 2px;
            background: #bcbfc2;
            transition: background-color 0.2s ease;
        }

        /* Default state */
        .signin-input-group[data-state="default"] .signin-input-label {
            color: #a2a6ab;
            font-size: 16px;
            top: 50%;
        }

        .signin-input-group[data-state="default"] .signin-input-line {
            background: #bcbfc2;
        }

        /* Focus state */
        .signin-input-group[data-state="focus"] .signin-input-label {
            color: #004d80;
            font-size: 12px;
            top: -8px;
            letter-spacing: 0.2px;
        }

        .signin-input-group[data-state="focus"] .signin-input-line {
            background: #004d80;
        }

        /* Filled state */
        .signin-input-group[data-state="filled"] .signin-input-label {
            color: #a2a6ab;
            font-size: 12px;
            top: -8px;
            letter-spacing: 0.2px;
        }

        .signin-input-group[data-state="filled"] .signin-input-line {
            background: #bcbfc2;
        }

        /* Disabled state */
        .signin-input-group[data-state="disabled"] .signin-input-label {
            color: #a2a6ab;
            font-size: 12px;
            top: -8px;
            letter-spacing: 0.2px;
        }

        .signin-input-group[data-state="disabled"] .signin-input-line {
            background: #bcbfc2;
        }

        /* Error state */
        .signin-input-group[data-state="error"] .signin-input-line {
            background: #bcbfc2;
        }

        .signin-error-message {
            position: absolute;
            bottom: -18px;
            left: 0;
            font-family: 'Roboto', sans-serif;
            font-size: 12px;
            color: #b30715;
            line-height: 16px;
            display: none;
            white-space: nowrap;
        }

        .signin-input-group[data-state="error"] .signin-error-message {
            display: block;
        }

        .signin-actions {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 24px;
        }

        .btn-signin-primary {
            width: 327px;
            height: 56px;
            background: #3e8500;
            border: none;
            border-radius: 100px;
            font-family: 'Roboto', sans-serif;
            font-weight: 500;
            font-size: 16px;
            color: white;
            cursor: pointer;
            letter-spacing: 0.4px;
            transition: background-color 0.2s ease;
        }

        .btn-signin-primary:hover {
            background: #2d5f00;
        }

        .signin-forgot-link {
            font-family: 'Roboto', sans-serif;
            font-weight: 500;
            font-size: 14px;
            color: #006fa6;
            text-decoration: none;
            line-height: 24px;
        }

        .signin-forgot-link:hover {
            text-decoration: underline;
        }

        /* Account Creation Confirmation Content */
        .account-confirmation-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 32px;
            padding: 80px 24px 40px;
            min-height: 100vh;
            box-sizing: border-box;
        }

        .account-confirmation-icon {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .success-circle {
            position: relative;
            width: 64px;
            height: 64px;
        }

        .success-circle-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #3e8500;
            border-radius: 50%;
        }

        .success-check {
            position: absolute;
            top: 12.5%;
            left: 13.28%;
            right: 11.72%;
            bottom: 12.5%;
            width: calc(100% - 25%);
            height: calc(100% - 25%);
        }

        .account-confirmation-text {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 16px;
            text-align: center;
            max-width: 285px;
        }

        .account-confirmation-title {
            font-family: 'Roboto', sans-serif;
            font-weight: 300;
            font-size: 32px;
            line-height: 40px;
            color: #242c33;
            margin: 0;
            letter-spacing: -0.4px;
        }

        .account-confirmation-message {
            font-family: 'Roboto', sans-serif;
            font-weight: 400;
            font-size: 16px;
            line-height: 22px;
            color: #242c33;
            margin: 0;
        }

        .account-confirmation-actions {
            display: flex;
            flex-direction: column;
            gap: 16px;
            width: 100%;
            max-width: 327px;
        }

        .btn-primary {
            background: #3e8500;
            border: none;
            border-radius: 100px;
            color: white;
            font-family: 'Roboto', sans-serif;
            font-weight: 500;
            font-size: 16px;
            line-height: 16px;
            padding: 13px 40px;
            height: 56px;
            cursor: pointer;
            letter-spacing: 0.4px;
            width: 100%;
        }

        .btn-primary:hover {
            background: #2d5f00;
        }

        .btn-secondary {
            background: transparent;
            border: 2px solid #313d47;
            border-radius: 28px;
            color: #242c33;
            font-family: 'Roboto', sans-serif;
            font-weight: 500;
            font-size: 16px;
            line-height: 16px;
            padding: 13px 40px;
            height: 56px;
            cursor: pointer;
            letter-spacing: 0.4px;
            width: 100%;
        }

        .btn-secondary:hover {
            background: #f5f5f5;
        }

        /* Filter Menu Styles */
        .filter-menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 5000;
            display: none;
        }

        .filter-menu-panel {
            position: absolute;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: white;
            transform: translateX(-100%);
            transition: transform 0.3s ease-out;
            overflow-y: auto;
            padding-bottom: 80px; /* Space for sticky button */
        }

        .filter-menu-overlay.show .filter-menu-panel {
            transform: translateX(0);
        }

        .filter-menu-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 24px 24px 0;
            border-bottom: 1px solid #bcbfc2;
        }

        .filter-menu-tabs {
            display: flex;
            gap: 39px;
        }

        .filter-tab {
            display: flex;
            align-items: center;
            gap: 8px;
            position: relative;
            padding-bottom: 16px;
        }

        .filter-tab {
            cursor: pointer;
            transition: all 0.2s ease;
        }

        /* Default/Inactive state */
        .filter-tab .filter-tab-text {
            color: #006fa6;
            font-weight: 500;
        }

        .filter-tab .filter-tab-bar {
            display: none;
        }

        /* Selected state */
        .filter-tab.active .filter-tab-text {
            color: #006fa6;
            font-weight: 500;
        }

        .filter-tab.active .filter-tab-bar {
            display: block;
            height: 2px;
            background: #006fa6;
        }

        /* Hover state */
        .filter-tab:hover:not(.active) .filter-tab-text {
            color: #006fa6;
            font-weight: 500;
        }

        .filter-tab:hover:not(.active) .filter-tab-bar {
            display: block;
            height: 1px;
            background: #006fa6;
        }

        /* Pressed state */
        .filter-tab:active .filter-tab-text {
            color: #004d80;
            font-weight: 500;
        }

        .filter-tab:active .filter-tab-bar {
            display: block;
            height: 2px;
            background: #004d80;
        }

        .filter-tab-bar {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
        }

        .filter-tab-icon {
            width: 24px;
            height: 24px;
        }

        .filter-tab-text {
            font-family: 'Roboto', sans-serif;
            font-size: 16px;
            font-weight: 400;
            color: #242c33;
            line-height: 16px;
        }

        .filter-menu-close {
            background: none;
            border: none;
            cursor: pointer;
        }

        .filter-close-icon {
            width: 24px;
            height: 24px;
        }

        .filter-pills-section {
            padding: 16px 24px;
        }

        .permanent-filter-pill {
            background: #006fa6;
            border: 1px solid #006ea6;
            border-radius: 34px;
            padding: 4px 12px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
            width: fit-content;
        }

        .permanent-filter-pill .location-icon {
            width: 18px;
            height: 24px;
        }

        .permanent-filter-pill .location-text {
            color: white;
            font-weight: bold;
            font-size: 14px;
        }

        .permanent-filter-pill .separator {
            color: white;
            font-size: 14px;
        }

        .permanent-filter-pill .filter-description {
            color: white;
            font-size: 14px;
        }

        .filter-pills-row {
            display: flex;
            gap: 8px;
            margin-bottom: 8px;
            flex-wrap: wrap;
            min-height: 36px;
        }

        .filter-pill.removable {
            background: #e6f1f5;
            border: 1px solid #006ea6;
            border-radius: 32px;
            padding: 4px 12px;
            display: flex;
            align-items: center;
            gap: 4px;
            height: 36px;
        }

        .filter-pill.count {
            background: white;
            border: 1px solid #006ea6;
            border-radius: 32px;
            padding: 4px 16px;
        }

        .filter-pill-text {
            color: #006fa6;
            font-size: 14px;
        }

        .filter-pill-close {
            background: none;
            border: none;
            cursor: pointer;
            padding: 6px;
            border-radius: 24px;
        }

        .filter-pill-close .close-icon {
            width: 8px;
            height: 8px;
        }

        .reset-link {
            padding: 0 0 0 0;
        }

        .reset-link span {
            color: #006fa6;
            font-weight: 500;
            font-size: 14px;
            cursor: pointer;
        }

        .filter-options-list {
            flex: 1;
        }

        .filter-option {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 24px;
            border-bottom: 1px solid #e8e9eb;
            cursor: pointer;
        }

        .filter-option-text {
            font-family: 'Roboto', sans-serif;
            font-size: 16px;
            color: #242c33;
            line-height: 24px;
        }

        .filter-option:first-child .filter-option-text {
            font-weight: bold;
        }

        .filter-arrow {
            width: 12px;
            height: 8px;
            transform: rotate(0deg);
        }


        .filter-menu-bottom {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            padding: 16px;
            border-top: 1px solid #e8e9eb;
            z-index: 1000;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
        }

        /* Sort Menu Styles */
        .sort-menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: transparent;
            z-index: 2000;
            display: none;
        }

        .sort-menu-overlay.show {
            display: block;
        }

        .sort-menu-panel {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(44, 44, 46, 0.95);
            border-radius: 12px;
            width: auto;
            min-width: 200px;
            max-width: 90vw;
            max-height: 400px;
            overflow: hidden;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(20px);
        }

        .sort-menu-header {
            padding: 16px 20px 12px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .sort-menu-title {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            font-weight: 600;
            font-size: 17px;
            color: white;
            margin: 0;
            text-align: center;
        }

        .sort-menu-options {
            padding: 8px 0;
        }

        .sort-option {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 20px;
            cursor: pointer;
            transition: background-color 0.15s ease;
            position: relative;
        }

        .sort-option:hover {
            background-color: rgba(255, 255, 255, 0.05);
        }

        .sort-option:last-child {
            border-bottom: none;
        }

        .sort-option-text {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            font-weight: 400;
            font-size: 16px;
            color: white;
        }

        .sort-option-check {
            width: 16px;
            height: 16px;
            display: none;
            color: white;
            font-weight: bold;
        }

        .sort-option.selected .sort-option-check {
            display: block;
        }

        .price-payment-bottom {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            padding: 16px 24px 24px;
            border-top: 1px solid #e8e9eb;
            z-index: 1000;
        }

        .body-style-bottom {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            padding: 16px 24px 24px;
            border-top: 1px solid #e8e9eb;
            z-index: 1000;
        }

        .view-results-btn {
            width: 100%;
            height: 56px;
            background: #3e8500;
            border: none;
            border-radius: 28px;
            cursor: pointer;
        }

        .view-results-text {
            color: white;
            font-weight: 500;
            font-size: 16px;
            letter-spacing: 0.4px;
        }

        /* My Searches Content Styles */
        .my-searches-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 40px 24px;
            gap: 24px;
        }

        .my-searches-message {
            text-align: center;
        }

        .my-searches-text {
            font-family: 'Roboto', sans-serif;
            font-weight: 300;
            font-size: 22px;
            line-height: 1.2;
            color: #242c33;
            margin: 0;
        }

        .my-searches-actions {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 16px;
        }

        .my-searches-signin-btn {
            background: #3e8500;
            border: none;
            border-radius: 100px;
            padding: 13px 24px;
            height: 40px;
            min-width: 114px;
            max-width: 336px;
            cursor: pointer;
            color: white;
            font-family: 'Roboto', sans-serif;
            font-weight: 500;
            font-size: 14px;
            line-height: 14px;
            text-align: center;
        }

        .my-searches-create-link {
            color: #006fa6;
            font-family: 'Roboto', sans-serif;
            font-weight: 500;
            font-size: 14px;
            line-height: 22px;
            text-decoration: none;
            cursor: pointer;
        }

        .my-searches-not-signed-in {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 24px;
        }

        /* Signed In My Searches Content - CACHE BUST v2 */
        .my-searches-signed-in {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 0 !important;
            gap: 16px;
            width: 100% !important;
        }

        .saved-searches-section {
            display: flex;
            flex-direction: column;
            gap: 16px;
            width: 100%;
        }

        .saved-searches-heading {
            font-family: 'Roboto', sans-serif;
            font-weight: 300;
            font-size: 16px;
            line-height: 24px;
            color: #242c33;
            margin: 0;
        }

        .saved-searches-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
            width: 100%;
        }

        .saved-search-card {
            background: white;
            border: 1px solid #e8e9eb;
            border-radius: 8px;
            padding: 24px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            min-height: 86px;
            cursor: pointer;
            transition: all 0.2s ease;
            width: 100% !important;
            box-sizing: border-box;
            margin: 0 !important;
            position: relative;
        }

        /* Default state */
        .saved-search-card {
            background: white;
            border: 1px solid #e8e9eb;
        }

        /* Hover state */
        .saved-search-card:hover:not(.selected) {
            background: #f4f5f7;
            border: 1px solid #e8e9eb;
        }

        /* Selected state - use inset border to prevent layout shift */
        .saved-search-card.selected {
            background: white;
            border: 1px solid #e8e9eb;
            box-shadow: inset 0 0 0 2px #3e8500;
        }

        .saved-search-card.selected .car-icon {
            filter: brightness(0) saturate(100%) invert(24%) sepia(100%) saturate(1000%) hue-rotate(90deg) brightness(1.2);
        }

        /* Pressed state */
        .saved-search-card:active {
            background: #f4f5f7;
            border: 1px solid #e8e9eb;
            box-shadow: inset 0 0 0 2px #3e8500;
        }

        .saved-search-info {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 4px;
            margin-right: 8px;
            min-width: 0; /* Allow flex item to shrink below content size */
        }

        .saved-search-name {
            font-family: 'Roboto', sans-serif;
            font-weight: bold;
            font-size: 16px;
            line-height: 24px;
            color: #242c33;
            margin: 0;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .saved-search-criteria {
            font-family: 'Roboto', sans-serif;
            font-weight: 400;
            font-size: 12px;
            line-height: 16px;
            color: #242c33;
            margin: 0;
            letter-spacing: 0.2px;
        }

        .saved-search-status {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .car-icon-container {
            position: relative;
            width: 20px;
            height: 20px;
        }

        .car-icon {
            width: 20px;
            height: 20px;
            display: block;
        }

        .notification-badge {
            position: absolute;
            top: 1px;
            right: 1px;
            width: 8px;
            height: 7px;
            background: #3e8500;
            border-radius: 50%;
        }

        .new-results {
            font-family: 'Roboto', sans-serif;
            font-weight: 400;
            font-size: 14px;
            line-height: 22px;
            color: #242c33;
            display: block;
        }

        /* New Car Badge */
        .new-car-badge {
            background: #eaf5dc;
            border-radius: 2px;
            padding: 4px 8px;
            display: flex;
            align-items: center;
            gap: 4px;
            position: relative;
        }

        .new-car-badge::after {
            content: '';
            position: absolute;
            right: -2px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: #eaf5dc;
            border-radius: 0 2px 2px 0;
        }

        .new-car-badge-icon {
            width: 12px;
            height: 12px;
        }

        .new-car-badge-count {
            font-family: 'Roboto', sans-serif;
            font-weight: 500;
            font-size: 10px;
            color: #326b00;
            line-height: 12px;
        }

        /* SRP Tile New Car Badge */
        .srp-tile-new-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
            background: #eaf5dc;
            border-radius: 2px 0 0 2px;
            position: absolute;
            right: -16px;
            top: 0;
        }

        .srp-tile-new-badge::after {
            content: '';
            position: absolute;
            right: -2px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: #eaf5dc;
            border-radius: 0 2px 2px 0;
        }

        .srp-tile-new-badge-icon {
            width: 18px;
            height: 18px;
            filter: brightness(0) saturate(100%) invert(20%) sepia(100%) saturate(2000%) hue-rotate(90deg) brightness(0.8) contrast(1.2);
        }

        .manage-alerts-link {
            display: flex;
            align-items: center;
            gap: 8px;
            justify-content: center;
            cursor: pointer;
        }

        .manage-alerts-link span {
            font-family: 'Roboto', sans-serif;
            font-weight: 500;
            font-size: 14px;
            line-height: 22px;
            color: #006fa6;
        }

        .manage-alerts-link .arrow-icon {
            width: 24px;
            height: 24px;
        }

        /* Empty State Styles */
        .my-searches-empty-state {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px 24px;
            gap: 16px;
            height: 460px;
        }

        .empty-state-illustration {
            width: 144px;
            height: 144px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .empty-state-icon {
            width: 120px;
            height: 132px;
        }

        .empty-state-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            width: 100%;
        }

        .empty-state-heading {
            font-family: 'Roboto', sans-serif;
            font-weight: 300;
            font-size: 22px;
            line-height: 1.2;
            color: #242C33;
            text-align: center;
            margin: 0;
        }

        .empty-state-description {
            font-family: 'Roboto', sans-serif;
            font-weight: 400;
            font-size: 14px;
            line-height: 1.55;
            color: #242C33;
            text-align: center;
            margin: 0;
            max-width: 317px;
        }

        /* Body Style Filter Overlay */
        .body-style-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 6000;
            display: none;
        }

        .body-style-panel {
            position: absolute;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: white;
            transform: translateX(100%);
            transition: transform 0.3s ease-out;
            overflow-y: auto;
            padding-bottom: 80px; /* Space for sticky button */
        }

        .body-style-overlay.show .body-style-panel {
            transform: translateX(0);
        }

        .body-style-header {
            padding: 24px 24px 0;
        }

        .body-style-back {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            padding: 2px 0;
        }

        .body-style-back-icon {
            width: 24px;
            height: 24px;
            transform: rotate(90deg);
        }

        .body-style-back-text {
            font-family: 'Roboto', sans-serif;
            font-weight: bold;
            font-size: 16px;
            line-height: 24px;
            color: #006fa6;
        }

        .body-style-heading {
            padding: 24px 24px 0;
        }

        .body-style-heading h3 {
            font-family: 'Roboto', sans-serif;
            font-weight: bold;
            font-size: 16px;
            line-height: 24px;
            color: #242c33;
            margin: 0;
        }

        .body-style-options {
            padding-top: 24px;
        }

        .body-style-option {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 24px;
            border-top: 1px solid #e8e9eb;
            border-bottom: 1px solid #e8e9eb;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }


        .body-style-option:hover {
            background-color: #f4f5f7;
        }

        .body-style-info {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .body-style-name {
            font-family: 'Roboto', sans-serif;
            font-weight: 400;
            font-size: 16px;
            line-height: 24px;
            color: #242c33;
        }

        .body-style-count {
            font-family: 'Roboto', sans-serif;
            font-weight: 300;
            font-size: 16px;
            line-height: 24px;
            color: #666b70;
        }

        .body-style-icon {
            width: 48px;
            height: auto;
        }

        /* Body Style Selected States */
        .body-style-option.selected {
            background-color: #f4f5f7;
        }

        .body-style-option.selected .body-style-info::before {
            content: '';
            display: inline-block;
            width: 24px;
            height: 24px;
            background-color: #3e8500;
            border-radius: 4px;
            margin-right: 8px;
            background-image: url('Illustrations/filter menu icons/distance&stores icons/Side Navigation/Child/Icons/System/check.svg');
            background-size: 16px 16px;
            background-position: center;
            background-repeat: no-repeat;
        }

        .body-style-option.selected .body-style-info {
            display: flex;
            align-items: center;
        }

        .body-style-option.selected .body-style-icon {
            filter: brightness(0) saturate(100%) invert(27%) sepia(51%) saturate(2878%) hue-rotate(87deg) brightness(91%) contrast(101%);
        }

        /* Body Style Filter Pills */
        .body-style-pill {
            background: #e6f1f5;
            border: 1px solid #006fa6;
        }

        .body-style-pill .filter-pill-text {
            color: #006fa6;
            cursor: pointer;
        }

        .body-style-pill .filter-pill-text:hover {
            text-decoration: underline;
        }

        .body-style-pill .filter-pill-close {
            width: 24px;
            height: 24px;
        }

        /* Price & Payment Filter Overlay */
        .price-payment-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 6000;
            display: none;
        }

        .price-payment-panel {
            position: absolute;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: white;
            transform: translateX(100%);
            transition: transform 0.3s ease-out;
            overflow-y: auto;
            padding-bottom: 80px; /* Space for sticky button */
        }

        .price-payment-overlay.show .price-payment-panel {
            transform: translateX(0);
        }

        .price-payment-header {
            padding: 24px 24px 0;
        }

        .price-payment-back {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            padding: 2px 0;
        }

        .price-payment-back-icon {
            width: 24px;
            height: 24px;
            transform: rotate(90deg);
        }

        .price-payment-back-text {
            font-family: 'Roboto', sans-serif;
            font-weight: bold;
            font-size: 16px;
            line-height: 24px;
            color: #006fa6;
        }

        .price-payment-heading {
            padding: 24px 24px 0;
        }

        .price-payment-heading h3 {
            font-family: 'Roboto', sans-serif;
            font-weight: bold;
            font-size: 16px;
            line-height: 24px;
            color: #242c33;
            margin: 0;
        }

        .price-payment-content {
            padding: 24px 24px 0;
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        /* Segmented Control */
        .segmented-control {
            background: white;
            border: 1px solid #d4d7d9;
            border-radius: 19.5px;
            padding: 4px;
            display: flex;
            width: 100%;
            box-sizing: border-box;
        }

        .segmented-option {
            flex: 1;
            background: white;
            border-radius: 16px;
            padding: 8px 16px;
            text-align: center;
            cursor: default;
            transition: none;
        }

        .segmented-option.selected {
            background: #3e8500;
            color: white;
        }

        .segmented-option span {
            font-family: 'Roboto', sans-serif;
            font-weight: 500;
            font-size: 14px;
            line-height: 14px;
            color: #242c33;
            white-space: nowrap;
        }

        .segmented-option.selected span {
            color: white;
        }

        /* Price Inputs */
        .price-inputs {
            display: flex;
            justify-content: space-between;
            gap: 16px;
        }

        .price-input-group {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .price-input-label {
            font-family: 'Roboto', sans-serif;
            font-weight: 400;
            font-size: 14px;
            line-height: 22px;
            color: #666b70;
        }

        .price-input-container {
            border: 1px solid #d4d7d9;
            border-radius: 8px;
            height: 40px;
            padding: 0 8px;
            display: flex;
            align-items: center;
            width: 100px;
        }

        .price-input {
            border: none;
            outline: none;
            background: transparent;
            font-family: 'Roboto', sans-serif;
            font-weight: 400;
            font-size: 16px;
            line-height: 16px;
            color: #242c33;
            width: 100%;
        }

        /* Range Slider */
        .range-slider-container {
            width: 100%;
            position: relative;
        }

        .range-slider-wrapper {
            position: relative;
            height: 24px;
            display: flex;
            align-items: center;
        }

        .range-slider-track {
            position: absolute;
            width: 100%;
            height: 4px;
            background: #d4d7d9;
            border-radius: 11px;
            pointer-events: none;
        }

        .range-slider-range {
            position: absolute;
            height: 4px;
            background: #3e8500;
            border-radius: 11px;
            pointer-events: none;
        }

        .range-slider {
            position: absolute;
            width: 100%;
            height: 24px;
            border-radius: 11px;
            background: transparent;
            outline: none;
            -webkit-appearance: none;
            appearance: none;
            pointer-events: none;
            cursor: pointer;
        }

        .range-slider-min {
            z-index: 1;
        }

        .range-slider-max {
            z-index: 1;
        }

        .range-slider-thumb {
            position: absolute;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #3e8500;
            border: 2px solid white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            cursor: pointer;
            pointer-events: auto;
            z-index: 3;
        }

        .range-slider-thumb-min {
            z-index: 4;
        }

        .range-slider-thumb-max {
            z-index: 5;
        }

        .range-slider::-webkit-slider-track {
            background: #d4d7d9;
            height: 4px;
            border-radius: 11px;
        }

        .range-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 0;
            height: 0;
            background: transparent;
            cursor: pointer;
        }

        .range-slider::-moz-range-track {
            background: #d4d7d9;
            height: 4px;
            border-radius: 11px;
            border: none;
        }

        .range-slider::-moz-range-thumb {
            width: 0;
            height: 0;
            background: transparent;
            cursor: pointer;
            border: none;
        }

        /* Hide existing pills except location, body style, price range, and removable pills */
        .filter-pill:not(.location-pill):not(.body-style-pill):not(.price-range-pill):not(.removable) {
            display: flex;
        }

        /* Price range pill styling */
        .price-range-pill {
            background: #e6f1f5;
            border: 1px solid #006fa6;
            border-radius: 16px;
            padding: 6px 12px;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            font-family: 'Roboto', sans-serif;
            font-weight: 400;
            font-size: 14px;
            line-height: 20px;
            color: #006fa6;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .price-range-pill:hover {
            background: #d1e7f0;
        }

        .price-range-pill .filter-pill-text {
            font-family: 'Roboto', sans-serif;
            font-weight: 400;
            font-size: 14px;
            line-height: 20px;
            color: #006fa6;
        }

        .price-range-pill .filter-pill-close {
            width: 24px;
            height: 24px;
        }

        /* Hide the +6 pill specifically */
        .more-filters {
            display: none !important;
        }

        /* FINAL OVERRIDE - Force navigation visibility in ALL conditions */
        .nav-container,
        .nav-top,
        .nav-left,
        .nav-right,
        .logo,
        .location,
        .nav-icon,
        .location-text {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            position: relative !important;
            z-index: 9999 !important;
            /* Force hardware acceleration and rendering */
            transform: translateZ(0) !important;
            will-change: transform !important;
            backface-visibility: hidden !important;
            -webkit-backface-visibility: hidden !important;
        }
        
        .nav-top {
            display: flex !important;
        }
        
        .nav-left,
        .nav-right,
        .location {
            display: flex !important;
        }
        
        /* Additional force rendering for developer tools */
        @media screen {
            .nav-container,
            .nav-top,
            .nav-left,
            .nav-right,
            .logo,
            .location,
            .nav-icon {
                display: block !important;
                visibility: visible !important;
                opacity: 1 !important;
                transform: translateZ(0) !important;
            }
            
            .nav-top {
                display: flex !important;
            }
            
            .nav-left,
            .nav-right,
            .location {
                display: flex !important;
            }
        }
    </style>
    
    <!-- Force override for My Searches content -->
    <style>
        #mySearchesSignedIn {
            padding: 0 !important;
            width: 100% !important;
        }
        #mySearchesSignedIn .saved-search-card {
            width: 100% !important;
            margin: 0 !important;
        }
        #mySearchesSignedIn .saved-searches-section {
            width: 100% !important;
        }
        #mySearchesSignedIn .saved-searches-list {
            width: 100% !important;
        }
    </style>
</head>
<body>
    <div class="mobile-container">
        <!-- Navigation - Rebuilt -->
        <div class="navigation-container">
            <div class="navigation-top">
                <div class="navigation-left">
                    <img src="Illustrations/07_SRP/hamburger-menu.svg" alt="Menu" class="hamburger-icon" onclick="openHamburgerMenu()">
                    <img src="Illustrations/05_Brand/logo-full-color.svg" alt="EchoPark" class="logo-icon" onclick="navigateToHomepage()">
                </div>
                <div class="navigation-right">
                    <div class="location-info">
                        <span class="location-text">75214</span>
                        <img src="Illustrations/07_SRP/map-icon.svg" alt="Location" class="icon">
                    </div>
                    <img src="Illustrations/07_SRP/favorites.svg" alt="Favorites" class="icon">
                    <img src="Illustrations/07_SRP/account.svg" alt="Account" class="icon">
                </div>
            </div>
            <div class="search-container" onclick="navigateToSavedSearches()">
                <input type="text" class="search-field" placeholder="Search make, model, or feature" readonly>
                <button class="search-btn">
                    <img src="Illustrations/Filter Bar Icons/Inputs/Button/Smalls/search-default.svg" alt="Search" class="search-icon">
                </button>
            </div>
        </div>

        <!-- Filter Bar -->
        <div class="filter-bar">
            <div class="filter-section" onclick="openFilterMenu()">
                <img src="Illustrations/04_UI/filter.svg" alt="Filter" class="filter-icon">
                <span class="filter-text">Filters</span>
            </div>
            <div class="filter-divider"></div>
            <div class="filter-section" onclick="openSortMenu()">
                <img src="Illustrations/04_UI/sort.svg" alt="Sort" class="filter-icon">
                <span class="filter-text">Sort by</span>
            </div>
            <div class="filter-divider"></div>
            <div class="filter-section" onclick="handleSaveSearch()">
                <img src="Illustrations/04_UI/save-search.svg" alt="Save" class="filter-icon" id="saveSearchIcon">
                <span class="filter-text" id="saveSearchText">Save search</span>
            </div>
        </div>

        <!-- Name Search Overlay -->
        <div class="name-search-overlay" id="nameSearchOverlay" style="display: none;">
            <div class="name-search-modal" id="nameSearchModal">
            <div class="name-search-header">
                <button class="name-search-close" onclick="closeNameSearch()">
                    <img src="Illustrations/Toast icons/pop-up close icon.svg" alt="Close" class="name-search-close-icon">
                </button>
            </div>
            <div class="name-search-form">
                <div class="name-search-input-group" data-state="default">
                    <input type="text" class="name-search-input" id="searchNameInput" placeholder=" ">
                    <label class="name-search-input-label">Name this search</label>
                    <div class="name-search-input-line"></div>
                </div>
            </div>
                <div class="name-search-actions">
                    <button class="save-search-btn" onclick="saveNamedSearch()">Save</button>
                    <a href="#" class="manage-alerts-link" onclick="manageAlerts()">
                        <span>Manage alerts</span>
                        <img src="Illustrations/right arrow.svg" alt="Arrow" class="arrow-icon">
                    </a>
                </div>
            </div>
        </div>

        <!-- Filter Pills -->
        <div class="filter-pills">
            <div class="permanent-filter">
                <div class="location-pill">
                    <img src="Illustrations/Filter Bar Icons/location pill.svg" alt="Location" class="location-icon">
                    <span class="location-text-white">75214</span>
                </div>
                <span class="filter-separator">|</span>
                <span class="filter-description" style="white-space: nowrap;">Cars within 250 mi</span>
            </div>
            <div class="filter-pills-row">
                <div class="more-filters">
                    <span class="more-filters-text">+6</span>
                </div>
            </div>
        </div>

        <!-- Results Header -->
        <div class="results-header">
            <h1 class="results-title">4 used Blue, GMC, Mazda, Hatchback, Truck, Coupes for sale at EchoPark</h1>
        </div>

        <!-- Results Grid -->
        <div class="results-grid">
            <!-- SRP Tile 1 -->
            <div class="srp-tile">
                <div class="tile-image-container">
                    <img src="Illustrations/07_SRP/srp-tile-car-image.png" alt="Car" class="tile-image">
                    <button class="favorite-button" onclick="toggleFavorite(this)">
                        <img src="Illustrations/07_SRP/favorite.svg" alt="Favorite" class="favorite-icon">
                    </button>
                </div>
                <div class="carousel-dots">
                    <img src="Illustrations/07_SRP/carousel-dots.svg" alt="Carousel dots">
                </div>
                <div class="tile-content">
                    <div class="tile-details">
                        <div class="tile-meta">
                            <span class="tile-year">2020</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-mileage">126k mi</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-stock">Stock #: PDW077969</span>
                        </div>
                        <h3 class="tile-title">Lamborghini Aventador LP 750-4 Superveloce Roadster SE</h3>
                    </div>
                    <div class="tile-price-location">
                        <div class="tile-price">
                            <div class="price-container">
                                <div style="display: flex; align-items: end;">
                                    <span class="price-currency">$</span>
                                    <span class="price-amount">30,499</span>
                                </div>
                            </div>
                        </div>
                        <div class="tile-location">
                            <p class="location-label">Pick up today at</p>
                            <p class="location-details">
                                <span>SW Houston store</span>
                                <span class="location-distance"> (125 mi)</span>
                            </p>
                        </div>
                    </div>
                    <div class="tile-actions">
                        <button class="calculator-button">
                            <img src="Illustrations/07_SRP/calculator.svg" alt="Calculator" class="calculator-icon">
                        </button>
                        <button class="test-drive-button">
                            <img src="Illustrations/SRP tile/Icon buttons/Test Drive.svg" alt="Test Drive" class="test-drive-icon">
                            <span class="test-drive-text">Schedule test drive</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Repeat for more tiles -->
            <div class="srp-tile">
                <div class="tile-image-container">
                    <img src="Illustrations/07_SRP/srp-tile-car-image.png" alt="Car" class="tile-image">
                    <button class="favorite-button" onclick="toggleFavorite(this)">
                        <img src="Illustrations/07_SRP/favorite.svg" alt="Favorite" class="favorite-icon">
                    </button>
                </div>
                <div class="carousel-dots">
                    <img src="Illustrations/07_SRP/carousel-dots.svg" alt="Carousel dots">
                </div>
                <div class="tile-content">
                    <div class="tile-details">
                        <div class="tile-meta">
                            <span class="tile-year">2021</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-mileage">45k mi</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-stock">Stock #: ABC123456</span>
                        </div>
                        <h3 class="tile-title">BMW 3 Series 330i Sedan</h3>
                    </div>
                    <div class="tile-price-location">
                        <div class="tile-price">
                            <div class="price-container">
                                <div style="display: flex; align-items: end;">
                                    <span class="price-currency">$</span>
                                    <span class="price-amount">28,999</span>
                                </div>
                            </div>
                        </div>
                        <div class="tile-location">
                            <p class="location-label">Pick up today at</p>
                            <p class="location-details">
                                <span>North Dallas store</span>
                                <span class="location-distance"> (45 mi)</span>
                            </p>
                        </div>
                    </div>
                    <div class="tile-actions">
                        <button class="calculator-button">
                            <img src="Illustrations/07_SRP/calculator.svg" alt="Calculator" class="calculator-icon">
                        </button>
                        <button class="test-drive-button">
                            <img src="Illustrations/SRP tile/Icon buttons/Test Drive.svg" alt="Test Drive" class="test-drive-icon">
                            <span class="test-drive-text">Schedule test drive</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- SRP Tile 3 -->
            <div class="srp-tile">
                <div class="tile-image-container">
                    <img src="Illustrations/07_SRP/srp-tile-car-image.png" alt="Car" class="tile-image">
                    <button class="favorite-button" onclick="toggleFavorite(this)">
                        <img src="Illustrations/07_SRP/favorite.svg" alt="Favorite" class="favorite-icon">
                    </button>
                </div>
                <div class="carousel-dots">
                    <img src="Illustrations/07_SRP/carousel-dots.svg" alt="Carousel dots">
                </div>
                <div class="tile-content">
                    <div class="tile-details">
                        <div class="tile-meta">
                            <span class="tile-year">2019</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-mileage">89k mi</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-stock">Stock #: ABC123456</span>
                        </div>
                        <h3 class="tile-title">BMW 3 Series 330i xDrive Sedan</h3>
                    </div>
                    <div class="tile-price-location">
                        <div class="tile-price">
                            <div class="price-container">
                                <div style="display: flex; align-items: end;">
                                    <span class="price-currency">$</span>
                                    <span class="price-amount">28,999</span>
                                </div>
                            </div>
                        </div>
                        <div class="tile-location">
                            <p class="location-label">Pick up today at</p>
                            <p class="location-details">
                                <span class="location-distance">North Dallas store</span>
                                <span class="location-distance"> (45 mi)</span>
                            </p>
                        </div>
                    </div>
                    <div class="tile-actions">
                        <button class="calculator-button">
                            <img src="Illustrations/07_SRP/calculator.svg" alt="Calculator" class="calculator-icon">
                        </button>
                        <button class="test-drive-button">
                            <img src="Illustrations/SRP tile/Icon buttons/Test Drive.svg" alt="Test Drive" class="test-drive-icon">
                            <span class="test-drive-text">Schedule test drive</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- SRP Tile 4 -->
            <div class="srp-tile">
                <div class="tile-image-container">
                    <img src="Illustrations/07_SRP/srp-tile-car-image.png" alt="Car" class="tile-image">
                    <button class="favorite-button" onclick="toggleFavorite(this)">
                        <img src="Illustrations/07_SRP/favorite.svg" alt="Favorite" class="favorite-icon">
                    </button>
                </div>
                <div class="carousel-dots">
                    <img src="Illustrations/07_SRP/carousel-dots.svg" alt="Carousel dots">
                </div>
                <div class="tile-content">
                    <div class="tile-details">
                        <div class="tile-meta">
                            <span class="tile-year">2021</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-mileage">34k mi</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-stock">Stock #: DEF789012</span>
                        </div>
                        <h3 class="tile-title">Audi A4 Quattro Premium Plus Sedan</h3>
                    </div>
                    <div class="tile-price-location">
                        <div class="tile-price">
                            <div class="price-container">
                                <div style="display: flex; align-items: end;">
                                    <span class="price-currency">$</span>
                                    <span class="price-amount">35,499</span>
                                </div>
                            </div>
                        </div>
                        <div class="tile-location">
                            <p class="location-label">Pick up today at</p>
                            <p class="location-details">
                                <span class="location-distance">Plano store</span>
                                <span class="location-distance"> (28 mi)</span>
                            </p>
                        </div>
                    </div>
                    <div class="tile-actions">
                        <button class="calculator-button">
                            <img src="Illustrations/07_SRP/calculator.svg" alt="Calculator" class="calculator-icon">
                        </button>
                        <button class="test-drive-button">
                            <img src="Illustrations/SRP tile/Icon buttons/Test Drive.svg" alt="Test Drive" class="test-drive-icon">
                            <span class="test-drive-text">Schedule test drive</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- SRP Tile 5 -->
            <div class="srp-tile">
                <div class="tile-image-container">
                    <img src="Illustrations/07_SRP/srp-tile-car-image.png" alt="Car" class="tile-image">
                    <button class="favorite-button" onclick="toggleFavorite(this)">
                        <img src="Illustrations/07_SRP/favorite.svg" alt="Favorite" class="favorite-icon">
                    </button>
                </div>
                <div class="carousel-dots">
                    <img src="Illustrations/07_SRP/carousel-dots.svg" alt="Carousel dots">
                </div>
                <div class="tile-content">
                    <div class="tile-details">
                        <div class="tile-meta">
                            <span class="tile-year">2020</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-mileage">67k mi</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-stock">Stock #: GHI345678</span>
                        </div>
                        <h3 class="tile-title">Mercedes-Benz C-Class C300 4MATIC Sedan</h3>
                    </div>
                    <div class="tile-price-location">
                        <div class="tile-price">
                            <div class="price-container">
                                <div style="display: flex; align-items: end;">
                                    <span class="price-currency">$</span>
                                    <span class="price-amount">32,999</span>
                                </div>
                            </div>
                        </div>
                        <div class="tile-location">
                            <p class="location-label">Pick up today at</p>
                            <p class="location-details">
                                <span class="location-distance">Frisco store</span>
                                <span class="location-distance"> (52 mi)</span>
                            </p>
                        </div>
                    </div>
                    <div class="tile-actions">
                        <button class="calculator-button">
                            <img src="Illustrations/07_SRP/calculator.svg" alt="Calculator" class="calculator-icon">
                        </button>
                        <button class="test-drive-button">
                            <img src="Illustrations/SRP tile/Icon buttons/Test Drive.svg" alt="Test Drive" class="test-drive-icon">
                            <span class="test-drive-text">Schedule test drive</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- SRP Tile 6 -->
            <div class="srp-tile">
                <div class="tile-image-container">
                    <img src="Illustrations/07_SRP/srp-tile-car-image.png" alt="Car" class="tile-image">
                    <button class="favorite-button" onclick="toggleFavorite(this)">
                        <img src="Illustrations/07_SRP/favorite.svg" alt="Favorite" class="favorite-icon">
                    </button>
                </div>
                <div class="carousel-dots">
                    <img src="Illustrations/07_SRP/carousel-dots.svg" alt="Carousel dots">
                </div>
                <div class="tile-content">
                    <div class="tile-details">
                        <div class="tile-meta">
                            <span class="tile-year">2022</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-mileage">23k mi</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-stock">Stock #: JKL901234</span>
                        </div>
                        <h3 class="tile-title">Lexus IS 300 F Sport Sedan</h3>
                    </div>
                    <div class="tile-price-location">
                        <div class="tile-price">
                            <div class="price-container">
                                <div style="display: flex; align-items: end;">
                                    <span class="price-currency">$</span>
                                    <span class="price-amount">38,999</span>
                                </div>
                            </div>
                        </div>
                        <div class="tile-location">
                            <p class="location-label">Pick up today at</p>
                            <p class="location-details">
                                <span class="location-distance">McKinney store</span>
                                <span class="location-distance"> (38 mi)</span>
                            </p>
                        </div>
                    </div>
                    <div class="tile-actions">
                        <button class="calculator-button">
                            <img src="Illustrations/07_SRP/calculator.svg" alt="Calculator" class="calculator-icon">
                        </button>
                        <button class="test-drive-button">
                            <img src="Illustrations/SRP tile/Icon buttons/Test Drive.svg" alt="Test Drive" class="test-drive-icon">
                            <span class="test-drive-text">Schedule test drive</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- SRP Tile 7 -->
            <div class="srp-tile">
                <div class="tile-image-container">
                    <img src="Illustrations/07_SRP/srp-tile-car-image.png" alt="Car" class="tile-image">
                    <button class="favorite-button" onclick="toggleFavorite(this)">
                        <img src="Illustrations/07_SRP/favorite.svg" alt="Favorite" class="favorite-icon">
                    </button>
                </div>
                <div class="carousel-dots">
                    <img src="Illustrations/07_SRP/carousel-dots.svg" alt="Carousel dots">
                </div>
                <div class="tile-content">
                    <div class="tile-details">
                        <div class="tile-meta">
                            <span class="tile-year">2018</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-mileage">112k mi</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-stock">Stock #: MNO567890</span>
                        </div>
                        <h3 class="tile-title">Infiniti Q50 3.0t Sport Sedan</h3>
                    </div>
                    <div class="tile-price-location">
                        <div class="tile-price">
                            <div class="price-container">
                                <div style="display: flex; align-items: end;">
                                    <span class="price-currency">$</span>
                                    <span class="price-amount">24,999</span>
                                </div>
                            </div>
                        </div>
                        <div class="tile-location">
                            <p class="location-label">Pick up today at</p>
                            <p class="location-details">
                                <span class="location-distance">Garland store</span>
                                <span class="location-distance"> (41 mi)</span>
                            </p>
                        </div>
                    </div>
                    <div class="tile-actions">
                        <button class="calculator-button">
                            <img src="Illustrations/07_SRP/calculator.svg" alt="Calculator" class="calculator-icon">
                        </button>
                        <button class="test-drive-button">
                            <img src="Illustrations/SRP tile/Icon buttons/Test Drive.svg" alt="Test Drive" class="test-drive-icon">
                            <span class="test-drive-text">Schedule test drive</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- SRP Tile 8 -->
            <div class="srp-tile">
                <div class="tile-image-container">
                    <img src="Illustrations/07_SRP/srp-tile-car-image.png" alt="Car" class="tile-image">
                    <button class="favorite-button" onclick="toggleFavorite(this)">
                        <img src="Illustrations/07_SRP/favorite.svg" alt="Favorite" class="favorite-icon">
                    </button>
                </div>
                <div class="carousel-dots">
                    <img src="Illustrations/07_SRP/carousel-dots.svg" alt="Carousel dots">
                </div>
                <div class="tile-content">
                    <div class="tile-details">
                        <div class="tile-meta">
                            <span class="tile-year">2021</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-mileage">45k mi</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-stock">Stock #: PQR123456</span>
                        </div>
                        <h3 class="tile-title">Acura TLX A-Spec SH-AWD Sedan</h3>
                    </div>
                    <div class="tile-price-location">
                        <div class="tile-price">
                            <div class="price-container">
                                <div style="display: flex; align-items: end;">
                                    <span class="price-currency">$</span>
                                    <span class="price-amount">31,499</span>
                                </div>
                            </div>
                        </div>
                        <div class="tile-location">
                            <p class="location-label">Pick up today at</p>
                            <p class="location-details">
                                <span class="location-distance">Allen store</span>
                                <span class="location-distance"> (35 mi)</span>
                            </p>
                        </div>
                    </div>
                    <div class="tile-actions">
                        <button class="calculator-button">
                            <img src="Illustrations/07_SRP/calculator.svg" alt="Calculator" class="calculator-icon">
                        </button>
                        <button class="test-drive-button">
                            <img src="Illustrations/SRP tile/Icon buttons/Test Drive.svg" alt="Test Drive" class="test-drive-icon">
                            <span class="test-drive-text">Schedule test drive</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- SRP Tile 9 -->
            <div class="srp-tile">
                <div class="tile-image-container">
                    <img src="Illustrations/07_SRP/srp-tile-car-image.png" alt="Car" class="tile-image">
                    <button class="favorite-button" onclick="toggleFavorite(this)">
                        <img src="Illustrations/07_SRP/favorite.svg" alt="Favorite" class="favorite-icon">
                    </button>
                </div>
                <div class="carousel-dots">
                    <img src="Illustrations/07_SRP/carousel-dots.svg" alt="Carousel dots">
                </div>
                <div class="tile-content">
                    <div class="tile-details">
                        <div class="tile-meta">
                            <span class="tile-year">2020</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-mileage">78k mi</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-stock">Stock #: STU789012</span>
                        </div>
                        <h3 class="tile-title">Volvo S60 T5 Momentum Sedan</h3>
                    </div>
                    <div class="tile-price-location">
                        <div class="tile-price">
                            <div class="price-container">
                                <div style="display: flex; align-items: end;">
                                    <span class="price-currency">$</span>
                                    <span class="price-amount">27,999</span>
                                </div>
                            </div>
                        </div>
                        <div class="tile-location">
                            <p class="location-label">Pick up today at</p>
                            <p class="location-details">
                                <span class="location-distance">Richardson store</span>
                                <span class="location-distance"> (29 mi)</span>
                            </p>
                        </div>
                    </div>
                    <div class="tile-actions">
                        <button class="calculator-button">
                            <img src="Illustrations/07_SRP/calculator.svg" alt="Calculator" class="calculator-icon">
                        </button>
                        <button class="test-drive-button">
                            <img src="Illustrations/SRP tile/Icon buttons/Test Drive.svg" alt="Test Drive" class="test-drive-icon">
                            <span class="test-drive-text">Schedule test drive</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- SRP Tile 10 -->
            <div class="srp-tile">
                <div class="tile-image-container">
                    <img src="Illustrations/07_SRP/srp-tile-car-image.png" alt="Car" class="tile-image">
                    <button class="favorite-button" onclick="toggleFavorite(this)">
                        <img src="Illustrations/07_SRP/favorite.svg" alt="Favorite" class="favorite-icon">
                    </button>
                </div>
                <div class="carousel-dots">
                    <img src="Illustrations/07_SRP/carousel-dots.svg" alt="Carousel dots">
                </div>
                <div class="tile-content">
                    <div class="tile-details">
                        <div class="tile-meta">
                            <span class="tile-year">2019</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-mileage">95k mi</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-stock">Stock #: VWX345678</span>
                        </div>
                        <h3 class="tile-title">Genesis G70 3.3T Sport Sedan</h3>
                    </div>
                    <div class="tile-price-location">
                        <div class="tile-price">
                            <div class="price-container">
                                <div style="display: flex; align-items: end;">
                                    <span class="price-currency">$</span>
                                    <span class="price-amount">29,999</span>
                                </div>
                            </div>
                        </div>
                        <div class="tile-location">
                            <p class="location-label">Pick up today at</p>
                            <p class="location-details">
                                <span class="location-distance">Mesquite store</span>
                                <span class="location-distance"> (47 mi)</span>
                            </p>
                        </div>
                    </div>
                    <div class="tile-actions">
                        <button class="calculator-button">
                            <img src="Illustrations/07_SRP/calculator.svg" alt="Calculator" class="calculator-icon">
                        </button>
                        <button class="test-drive-button">
                            <img src="Illustrations/SRP tile/Icon buttons/Test Drive.svg" alt="Test Drive" class="test-drive-icon">
                            <span class="test-drive-text">Schedule test drive</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- SRP Tile 11 -->
            <div class="srp-tile">
                <div class="tile-image-container">
                    <img src="Illustrations/07_SRP/srp-tile-car-image.png" alt="Car" class="tile-image">
                    <button class="favorite-button" onclick="toggleFavorite(this)">
                        <img src="Illustrations/07_SRP/favorite.svg" alt="Favorite" class="favorite-icon">
                    </button>
                </div>
                <div class="carousel-dots">
                    <img src="Illustrations/07_SRP/carousel-dots.svg" alt="Carousel dots">
                </div>
                <div class="tile-content">
                    <div class="tile-details">
                        <div class="tile-meta">
                            <span class="tile-year">2021</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-mileage">42k mi</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-stock">Stock #: YZA901234</span>
                        </div>
                        <h3 class="tile-title">Cadillac CT4 Luxury Sedan</h3>
                    </div>
                    <div class="tile-price-location">
                        <div class="tile-price">
                            <div class="price-container">
                                <div style="display: flex; align-items: end;">
                                    <span class="price-currency">$</span>
                                    <span class="price-amount">33,999</span>
                                </div>
                            </div>
                        </div>
                        <div class="tile-location">
                            <p class="location-label">Pick up today at</p>
                            <p class="location-details">
                                <span class="location-distance">Denton store</span>
                                <span class="location-distance"> (58 mi)</span>
                            </p>
                        </div>
                    </div>
                    <div class="tile-actions">
                        <button class="calculator-button">
                            <img src="Illustrations/07_SRP/calculator.svg" alt="Calculator" class="calculator-icon">
                        </button>
                        <button class="test-drive-button">
                            <img src="Illustrations/SRP tile/Icon buttons/Test Drive.svg" alt="Test Drive" class="test-drive-icon">
                            <span class="test-drive-text">Schedule test drive</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- SRP Tile 12 -->
            <div class="srp-tile">
                <div class="tile-image-container">
                    <img src="Illustrations/07_SRP/srp-tile-car-image.png" alt="Car" class="tile-image">
                    <button class="favorite-button" onclick="toggleFavorite(this)">
                        <img src="Illustrations/07_SRP/favorite.svg" alt="Favorite" class="favorite-icon">
                    </button>
                </div>
                <div class="carousel-dots">
                    <img src="Illustrations/07_SRP/carousel-dots.svg" alt="Carousel dots">
                </div>
                <div class="tile-content">
                    <div class="tile-details">
                        <div class="tile-meta">
                            <span class="tile-year">2020</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-mileage">71k mi</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-stock">Stock #: BCD567890</span>
                        </div>
                        <h3 class="tile-title">Jaguar XE P250 R-Dynamic Sedan</h3>
                    </div>
                    <div class="tile-price-location">
                        <div class="tile-price">
                            <div class="price-container">
                                <div style="display: flex; align-items: end;">
                                    <span class="price-currency">$</span>
                                    <span class="price-amount">36,499</span>
                                </div>
                            </div>
                        </div>
                        <div class="tile-location">
                            <p class="location-label">Pick up today at</p>
                            <p class="location-details">
                                <span class="location-distance">Lewisville store</span>
                                <span class="location-distance"> (33 mi)</span>
                            </p>
                        </div>
                    </div>
                    <div class="tile-actions">
                        <button class="calculator-button">
                            <img src="Illustrations/07_SRP/calculator.svg" alt="Calculator" class="calculator-icon">
                        </button>
                        <button class="test-drive-button">
                            <img src="Illustrations/SRP tile/Icon buttons/Test Drive.svg" alt="Test Drive" class="test-drive-icon">
                            <span class="test-drive-text">Schedule test drive</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- SRP Tile 13 -->
            <div class="srp-tile">
                <div class="tile-image-container">
                    <img src="Illustrations/07_SRP/srp-tile-car-image.png" alt="Car" class="tile-image">
                    <button class="favorite-button" onclick="toggleFavorite(this)">
                        <img src="Illustrations/07_SRP/favorite.svg" alt="Favorite" class="favorite-icon">
                    </button>
                </div>
                <div class="carousel-dots">
                    <img src="Illustrations/07_SRP/carousel-dots.svg" alt="Carousel dots">
                </div>
                <div class="tile-content">
                    <div class="tile-details">
                        <div class="tile-meta">
                            <span class="tile-year">2019</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-mileage">103k mi</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-stock">Stock #: EFG123456</span>
                        </div>
                        <h3 class="tile-title">Alfa Romeo Giulia Ti Sport Sedan</h3>
                    </div>
                    <div class="tile-price-location">
                        <div class="tile-price">
                            <div class="price-container">
                                <div style="display: flex; align-items: end;">
                                    <span class="price-currency">$</span>
                                    <span class="price-amount">26,999</span>
                                </div>
                            </div>
                        </div>
                        <div class="tile-location">
                            <p class="location-label">Pick up today at</p>
                            <p class="location-details">
                                <span class="location-distance">Carrollton store</span>
                                <span class="location-distance"> (39 mi)</span>
                            </p>
                        </div>
                    </div>
                    <div class="tile-actions">
                        <button class="calculator-button">
                            <img src="Illustrations/07_SRP/calculator.svg" alt="Calculator" class="calculator-icon">
                        </button>
                        <button class="test-drive-button">
                            <img src="Illustrations/SRP tile/Icon buttons/Test Drive.svg" alt="Test Drive" class="test-drive-icon">
                            <span class="test-drive-text">Schedule test drive</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- SRP Tile 14 -->
            <div class="srp-tile">
                <div class="tile-image-container">
                    <img src="Illustrations/07_SRP/srp-tile-car-image.png" alt="Car" class="tile-image">
                    <button class="favorite-button" onclick="toggleFavorite(this)">
                        <img src="Illustrations/07_SRP/favorite.svg" alt="Favorite" class="favorite-icon">
                    </button>
                </div>
                <div class="carousel-dots">
                    <img src="Illustrations/07_SRP/carousel-dots.svg" alt="Carousel dots">
                </div>
                <div class="tile-content">
                    <div class="tile-details">
                        <div class="tile-meta">
                            <span class="tile-year">2022</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-mileage">19k mi</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-stock">Stock #: HIJ789012</span>
                        </div>
                        <h3 class="tile-title">Lincoln MKZ Reserve Sedan</h3>
                    </div>
                    <div class="tile-price-location">
                        <div class="tile-price">
                            <div class="price-container">
                                <div style="display: flex; align-items: end;">
                                    <span class="price-currency">$</span>
                                    <span class="price-amount">37,999</span>
                                </div>
                            </div>
                        </div>
                        <div class="tile-location">
                            <p class="location-label">Pick up today at</p>
                            <p class="location-details">
                                <span class="location-distance">Flower Mound store</span>
                                <span class="location-distance"> (44 mi)</span>
                            </p>
                        </div>
                    </div>
                    <div class="tile-actions">
                        <button class="calculator-button">
                            <img src="Illustrations/07_SRP/calculator.svg" alt="Calculator" class="calculator-icon">
                        </button>
                        <button class="test-drive-button">
                            <img src="Illustrations/SRP tile/Icon buttons/Test Drive.svg" alt="Test Drive" class="test-drive-icon">
                            <span class="test-drive-text">Schedule test drive</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- SRP Tile 15 -->
            <div class="srp-tile">
                <div class="tile-image-container">
                    <img src="Illustrations/07_SRP/srp-tile-car-image.png" alt="Car" class="tile-image">
                    <button class="favorite-button" onclick="toggleFavorite(this)">
                        <img src="Illustrations/07_SRP/favorite.svg" alt="Favorite" class="favorite-icon">
                    </button>
                </div>
                <div class="carousel-dots">
                    <img src="Illustrations/07_SRP/carousel-dots.svg" alt="Carousel dots">
                </div>
                <div class="tile-content">
                    <div class="tile-details">
                        <div class="tile-meta">
                            <span class="tile-year">2020</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-mileage">84k mi</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-stock">Stock #: KLM345678</span>
                        </div>
                        <h3 class="tile-title">Maserati Ghibli S Q4 Sedan</h3>
                    </div>
                    <div class="tile-price-location">
                        <div class="tile-price">
                            <div class="price-container">
                                <div style="display: flex; align-items: end;">
                                    <span class="price-currency">$</span>
                                    <span class="price-amount">42,999</span>
                                </div>
                            </div>
                        </div>
                        <div class="tile-location">
                            <p class="location-label">Pick up today at</p>
                            <p class="location-details">
                                <span class="location-distance">Grapevine store</span>
                                <span class="location-distance"> (31 mi)</span>
                            </p>
                        </div>
                    </div>
                    <div class="tile-actions">
                        <button class="calculator-button">
                            <img src="Illustrations/07_SRP/calculator.svg" alt="Calculator" class="calculator-icon">
                        </button>
                        <button class="test-drive-button">
                            <img src="Illustrations/SRP tile/Icon buttons/Test Drive.svg" alt="Test Drive" class="test-drive-icon">
                            <span class="test-drive-text">Schedule test drive</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- SRP Tile 16 -->
            <div class="srp-tile">
                <div class="tile-image-container">
                    <img src="Illustrations/07_SRP/srp-tile-car-image.png" alt="Car" class="tile-image">
                    <button class="favorite-button" onclick="toggleFavorite(this)">
                        <img src="Illustrations/07_SRP/favorite.svg" alt="Favorite" class="favorite-icon">
                    </button>
                </div>
                <div class="carousel-dots">
                    <img src="Illustrations/07_SRP/carousel-dots.svg" alt="Carousel dots">
                </div>
                <div class="tile-content">
                    <div class="tile-details">
                        <div class="tile-meta">
                            <span class="tile-year">2021</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-mileage">56k mi</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-stock">Stock #: NOP901234</span>
                        </div>
                        <h3 class="tile-title">Porsche Panamera 4S Sedan</h3>
                    </div>
                    <div class="tile-price-location">
                        <div class="tile-price">
                            <div class="price-container">
                                <div style="display: flex; align-items: end;">
                                    <span class="price-currency">$</span>
                                    <span class="price-amount">89,999</span>
                                </div>
                            </div>
                        </div>
                        <div class="tile-location">
                            <p class="location-label">Pick up today at</p>
                            <p class="location-details">
                                <span class="location-distance">Southlake store</span>
                                <span class="location-distance"> (36 mi)</span>
                            </p>
                        </div>
                    </div>
                    <div class="tile-actions">
                        <button class="calculator-button">
                            <img src="Illustrations/07_SRP/calculator.svg" alt="Calculator" class="calculator-icon">
                        </button>
                        <button class="test-drive-button">
                            <img src="Illustrations/SRP tile/Icon buttons/Test Drive.svg" alt="Test Drive" class="test-drive-icon">
                            <span class="test-drive-text">Schedule test drive</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- SRP Tile 17 -->
            <div class="srp-tile">
                <div class="tile-image-container">
                    <img src="Illustrations/07_SRP/srp-tile-car-image.png" alt="Car" class="tile-image">
                    <button class="favorite-button" onclick="toggleFavorite(this)">
                        <img src="Illustrations/07_SRP/favorite.svg" alt="Favorite" class="favorite-icon">
                    </button>
                </div>
                <div class="carousel-dots">
                    <img src="Illustrations/07_SRP/carousel-dots.svg" alt="Carousel dots">
                </div>
                <div class="tile-content">
                    <div class="tile-details">
                        <div class="tile-meta">
                            <span class="tile-year">2019</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-mileage">91k mi</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-stock">Stock #: QRS567890</span>
                        </div>
                        <h3 class="tile-title">Bentley Continental GT Coupe</h3>
                    </div>
                    <div class="tile-price-location">
                        <div class="tile-price">
                            <div class="price-container">
                                <div style="display: flex; align-items: end;">
                                    <span class="price-currency">$</span>
                                    <span class="price-amount">125,999</span>
                                </div>
                            </div>
                        </div>
                        <div class="tile-location">
                            <p class="location-label">Pick up today at</p>
                            <p class="location-details">
                                <span class="location-distance">Highland Park store</span>
                                <span class="location-distance"> (42 mi)</span>
                            </p>
                        </div>
                    </div>
                    <div class="tile-actions">
                        <button class="calculator-button">
                            <img src="Illustrations/07_SRP/calculator.svg" alt="Calculator" class="calculator-icon">
                        </button>
                        <button class="test-drive-button">
                            <img src="Illustrations/SRP tile/Icon buttons/Test Drive.svg" alt="Test Drive" class="test-drive-icon">
                            <span class="test-drive-text">Schedule test drive</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- SRP Tile 18 -->
            <div class="srp-tile">
                <div class="tile-image-container">
                    <img src="Illustrations/07_SRP/srp-tile-car-image.png" alt="Car" class="tile-image">
                    <button class="favorite-button" onclick="toggleFavorite(this)">
                        <img src="Illustrations/07_SRP/favorite.svg" alt="Favorite" class="favorite-icon">
                    </button>
                </div>
                <div class="carousel-dots">
                    <img src="Illustrations/07_SRP/carousel-dots.svg" alt="Carousel dots">
                </div>
                <div class="tile-content">
                    <div class="tile-details">
                        <div class="tile-meta">
                            <span class="tile-year">2020</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-mileage">73k mi</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-stock">Stock #: TUV123456</span>
                        </div>
                        <h3 class="tile-title">Rolls-Royce Ghost Sedan</h3>
                    </div>
                    <div class="tile-price-location">
                        <div class="tile-price">
                            <div class="price-container">
                                <div style="display: flex; align-items: end;">
                                    <span class="price-currency">$</span>
                                    <span class="price-amount">189,999</span>
                                </div>
                            </div>
                        </div>
                        <div class="tile-location">
                            <p class="location-label">Pick up today at</p>
                            <p class="location-details">
                                <span class="location-distance">Preston Hollow store</span>
                                <span class="location-distance"> (38 mi)</span>
                            </p>
                        </div>
                    </div>
                    <div class="tile-actions">
                        <button class="calculator-button">
                            <img src="Illustrations/07_SRP/calculator.svg" alt="Calculator" class="calculator-icon">
                        </button>
                        <button class="test-drive-button">
                            <img src="Illustrations/SRP tile/Icon buttons/Test Drive.svg" alt="Test Drive" class="test-drive-icon">
                            <span class="test-drive-text">Schedule test drive</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- SRP Tile 19 -->
            <div class="srp-tile">
                <div class="tile-image-container">
                    <img src="Illustrations/07_SRP/srp-tile-car-image.png" alt="Car" class="tile-image">
                    <button class="favorite-button" onclick="toggleFavorite(this)">
                        <img src="Illustrations/07_SRP/favorite.svg" alt="Favorite" class="favorite-icon">
                    </button>
                </div>
                <div class="carousel-dots">
                    <img src="Illustrations/07_SRP/carousel-dots.svg" alt="Carousel dots">
                </div>
                <div class="tile-content">
                    <div class="tile-details">
                        <div class="tile-meta">
                            <span class="tile-year">2021</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-mileage">38k mi</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-stock">Stock #: WXY789012</span>
                        </div>
                        <h3 class="tile-title">Ferrari 488 GTB Coupe</h3>
                    </div>
                    <div class="tile-price-location">
                        <div class="tile-price">
                            <div class="price-container">
                                <div style="display: flex; align-items: end;">
                                    <span class="price-currency">$</span>
                                    <span class="price-amount">245,999</span>
                                </div>
                            </div>
                        </div>
                        <div class="tile-location">
                            <p class="location-label">Pick up today at</p>
                            <p class="location-details">
                                <span class="location-distance">University Park store</span>
                                <span class="location-distance"> (41 mi)</span>
                            </p>
                        </div>
                    </div>
                    <div class="tile-actions">
                        <button class="calculator-button">
                            <img src="Illustrations/07_SRP/calculator.svg" alt="Calculator" class="calculator-icon">
                        </button>
                        <button class="test-drive-button">
                            <img src="Illustrations/SRP tile/Icon buttons/Test Drive.svg" alt="Test Drive" class="test-drive-icon">
                            <span class="test-drive-text">Schedule test drive</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- SRP Tile 20 -->
            <div class="srp-tile">
                <div class="tile-image-container">
                    <img src="Illustrations/07_SRP/srp-tile-car-image.png" alt="Car" class="tile-image">
                    <button class="favorite-button" onclick="toggleFavorite(this)">
                        <img src="Illustrations/07_SRP/favorite.svg" alt="Favorite" class="favorite-icon">
                    </button>
                </div>
                <div class="carousel-dots">
                    <img src="Illustrations/07_SRP/carousel-dots.svg" alt="Carousel dots">
                </div>
                <div class="tile-content">
                    <div class="tile-details">
                        <div class="tile-meta">
                            <span class="tile-year">2020</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-mileage">65k mi</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-stock">Stock #: ZAB345678</span>
                        </div>
                        <h3 class="tile-title">McLaren 720S Coupe</h3>
                    </div>
                    <div class="tile-price-location">
                        <div class="tile-price">
                            <div class="price-container">
                                <div style="display: flex; align-items: end;">
                                    <span class="price-currency">$</span>
                                    <span class="price-amount">289,999</span>
                                </div>
                            </div>
                        </div>
                        <div class="tile-location">
                            <p class="location-label">Pick up today at</p>
                            <p class="location-details">
                                <span class="location-distance">Lakewood store</span>
                                <span class="location-distance"> (46 mi)</span>
                            </p>
                        </div>
                    </div>
                    <div class="tile-actions">
                        <button class="calculator-button">
                            <img src="Illustrations/07_SRP/calculator.svg" alt="Calculator" class="calculator-icon">
                        </button>
                        <button class="test-drive-button">
                            <img src="Illustrations/SRP tile/Icon buttons/Test Drive.svg" alt="Test Drive" class="test-drive-icon">
                            <span class="test-drive-text">Schedule test drive</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- SRP Tile 21 -->
            <div class="srp-tile">
                <div class="tile-image-container">
                    <img src="Illustrations/07_SRP/srp-tile-car-image.png" alt="Car" class="tile-image">
                    <button class="favorite-button" onclick="toggleFavorite(this)">
                        <img src="Illustrations/07_SRP/favorite.svg" alt="Favorite" class="favorite-icon">
                    </button>
                </div>
                <div class="carousel-dots">
                    <img src="Illustrations/07_SRP/carousel-dots.svg" alt="Carousel dots">
                </div>
                <div class="tile-content">
                    <div class="tile-details">
                        <div class="tile-meta">
                            <span class="tile-year">2019</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-mileage">87k mi</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-stock">Stock #: CDE901234</span>
                        </div>
                        <h3 class="tile-title">Aston Martin DB11 Coupe</h3>
                    </div>
                    <div class="tile-price-location">
                        <div class="tile-price">
                            <div class="price-container">
                                <div style="display: flex; align-items: end;">
                                    <span class="price-currency">$</span>
                                    <span class="price-amount">165,999</span>
                                </div>
                            </div>
                        </div>
                        <div class="tile-location">
                            <p class="location-label">Pick up today at</p>
                            <p class="location-details">
                                <span class="location-distance">Preston Center store</span>
                                <span class="location-distance"> (43 mi)</span>
                            </p>
                        </div>
                    </div>
                    <div class="tile-actions">
                        <button class="calculator-button">
                            <img src="Illustrations/07_SRP/calculator.svg" alt="Calculator" class="calculator-icon">
                        </button>
                        <button class="test-drive-button">
                            <img src="Illustrations/SRP tile/Icon buttons/Test Drive.svg" alt="Test Drive" class="test-drive-icon">
                            <span class="test-drive-text">Schedule test drive</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- SRP Tile 22 -->
            <div class="srp-tile">
                <div class="tile-image-container">
                    <img src="Illustrations/07_SRP/srp-tile-car-image.png" alt="Car" class="tile-image">
                    <button class="favorite-button" onclick="toggleFavorite(this)">
                        <img src="Illustrations/07_SRP/favorite.svg" alt="Favorite" class="favorite-icon">
                    </button>
                </div>
                <div class="carousel-dots">
                    <img src="Illustrations/07_SRP/carousel-dots.svg" alt="Carousel dots">
                </div>
                <div class="tile-content">
                    <div class="tile-details">
                        <div class="tile-meta">
                            <span class="tile-year">2021</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-mileage">29k mi</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-stock">Stock #: FGH567890</span>
                        </div>
                        <h3 class="tile-title">Lamborghini Huracn EVO Coupe</h3>
                    </div>
                    <div class="tile-price-location">
                        <div class="tile-price">
                            <div class="price-container">
                                <div style="display: flex; align-items: end;">
                                    <span class="price-currency">$</span>
                                    <span class="price-amount">199,999</span>
                                </div>
                            </div>
                        </div>
                        <div class="tile-location">
                            <p class="location-label">Pick up today at</p>
                            <p class="location-details">
                                <span class="location-distance">Uptown store</span>
                                <span class="location-distance"> (37 mi)</span>
                            </p>
                        </div>
                    </div>
                    <div class="tile-actions">
                        <button class="calculator-button">
                            <img src="Illustrations/07_SRP/calculator.svg" alt="Calculator" class="calculator-icon">
                        </button>
                        <button class="test-drive-button">
                            <img src="Illustrations/SRP tile/Icon buttons/Test Drive.svg" alt="Test Drive" class="test-drive-icon">
                            <span class="test-drive-text">Schedule test drive</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- SRP Tile 23 -->
            <div class="srp-tile">
                <div class="tile-image-container">
                    <img src="Illustrations/07_SRP/srp-tile-car-image.png" alt="Car" class="tile-image">
                    <button class="favorite-button" onclick="toggleFavorite(this)">
                        <img src="Illustrations/07_SRP/favorite.svg" alt="Favorite" class="favorite-icon">
                    </button>
                </div>
                <div class="carousel-dots">
                    <img src="Illustrations/07_SRP/carousel-dots.svg" alt="Carousel dots">
                </div>
                <div class="tile-content">
                    <div class="tile-details">
                        <div class="tile-meta">
                            <span class="tile-year">2020</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-mileage">76k mi</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-stock">Stock #: IJK123456</span>
                        </div>
                        <h3 class="tile-title">Bugatti Chiron Super Sport</h3>
                    </div>
                    <div class="tile-price-location">
                        <div class="tile-price">
                            <div class="price-container">
                                <div style="display: flex; align-items: end;">
                                    <span class="price-currency">$</span>
                                    <span class="price-amount">3,999,999</span>
                                </div>
                            </div>
                        </div>
                        <div class="tile-location">
                            <p class="location-label">Pick up today at</p>
                            <p class="location-details">
                                <span class="location-distance">Preston Royal store</span>
                                <span class="location-distance"> (40 mi)</span>
                            </p>
                        </div>
                    </div>
                    <div class="tile-actions">
                        <button class="calculator-button">
                            <img src="Illustrations/07_SRP/calculator.svg" alt="Calculator" class="calculator-icon">
                        </button>
                        <button class="test-drive-button">
                            <img src="Illustrations/SRP tile/Icon buttons/Test Drive.svg" alt="Test Drive" class="test-drive-icon">
                            <span class="test-drive-text">Schedule test drive</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- SRP Tile 24 -->
            <div class="srp-tile">
                <div class="tile-image-container">
                    <img src="Illustrations/07_SRP/srp-tile-car-image.png" alt="Car" class="tile-image">
                    <button class="favorite-button" onclick="toggleFavorite(this)">
                        <img src="Illustrations/07_SRP/favorite.svg" alt="Favorite" class="favorite-icon">
                    </button>
                </div>
                <div class="carousel-dots">
                    <img src="Illustrations/07_SRP/carousel-dots.svg" alt="Carousel dots">
                </div>
                <div class="tile-content">
                    <div class="tile-details">
                        <div class="tile-meta">
                            <span class="tile-year">2022</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-mileage">12k mi</span>
                            <span class="tile-separator">|</span>
                            <span class="tile-stock">Stock #: LMN789012</span>
                        </div>
                        <h3 class="tile-title">Koenigsegg Jesko Absolut</h3>
                    </div>
                    <div class="tile-price-location">
                        <div class="tile-price">
                            <div class="price-container">
                                <div style="display: flex; align-items: end;">
                                    <span class="price-currency">$</span>
                                    <span class="price-amount">4,500,000</span>
                                </div>
                            </div>
                        </div>
                        <div class="tile-location">
                            <p class="location-label">Pick up today at</p>
                            <p class="location-details">
                                <span class="location-distance">Turtle Creek store</span>
                                <span class="location-distance"> (39 mi)</span>
                            </p>
                        </div>
                    </div>
                    <div class="tile-actions">
                        <button class="calculator-button">
                            <img src="Illustrations/07_SRP/calculator.svg" alt="Calculator" class="calculator-icon">
                        </button>
                        <button class="test-drive-button">
                            <img src="Illustrations/SRP tile/Icon buttons/Test Drive.svg" alt="Test Drive" class="test-drive-icon">
                            <span class="test-drive-text">Schedule test drive</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Hamburger Menu -->
    <div class="hamburger-overlay" id="hamburgerOverlay" onclick="closeHamburgerMenu()"></div>
    <div class="hamburger-menu-panel" id="hamburgerMenu">
        <div class="hamburger-header">
            <img src="Illustrations/05_Brand/logo-green-white.svg" alt="EchoPark" class="hamburger-logo" onclick="navigateToHomepage()">
            <img src="Illustrations/Close_darkmode.svg" alt="Close" class="hamburger-close" onclick="closeHamburgerMenu()">
        </div>
        <div class="hamburger-content">
            <div class="primary-links">
                <div class="primary-link" onclick="navigateToSearch()">
                    <span class="primary-link-text">Shop cars</span>
                </div>
                <div class="primary-link">
                    <span class="primary-link-text">Sell/Trade</span>
                </div>
                <div class="primary-link">
                    <span class="primary-link-text">Finance</span>
                </div>
            </div>
            <div class="secondary-links">
                <div class="secondary-link">
                    <span class="secondary-link-text">Find a location</span>
                </div>
                <div class="secondary-link">
                    <span class="secondary-link-text">Get a loan</span>
                </div>
                <div class="secondary-link">
                    <span class="secondary-link-text">About EchoPark</span>
                </div>
                <div class="secondary-link">
                    <span class="secondary-link-text">Protection plans</span>
                </div>
                <div class="secondary-link">
                    <span class="secondary-link-text">190-Point inspection</span>
                </div>
                <div class="secondary-link">
                    <span class="secondary-link-text">OwnerZone</span>
                </div>
                <div class="secondary-link">
                    <span class="secondary-link-text">Help center & FAQs</span>
                </div>
                <div class="secondary-link">
                    <span class="secondary-link-text">Shop brand-new cars</span>
                </div>
                <div class="secondary-link">
                    <span class="secondary-link-text">Shop powersports</span>
                </div>
            </div>
        </div>
        <div class="hamburger-signin">
            <button class="btn-signin" onclick="openSignIn()">Sign in</button>
        </div>
    </div>
    
    <!-- Toast - moved outside mobile container -->
    <div class="toast-overlay" id="toastOverlay"></div>
    <div class="toast" id="toast">
            <div class="toast-content">
                <div class="toast-left">
                    <img src="Illustrations/Toast icons/info.svg" alt="Info" class="toast-icon">
                    <div class="toast-text">
                        Get notified when new cars match your search. <a href="#" class="toast-link" onclick="openSignIn()">Sign in or create an account</a>
                    </div>
                </div>
                <button class="toast-close" onclick="closeToast()">
                    <img src="Illustrations/Toast icons/pop-up close icon.svg" alt="Close" class="toast-close-icon">
                </button>
            </div>
        </div>
    </div>

    <!-- Filter Menu Overlay -->
    <div id="filterMenu" class="filter-menu-overlay">
        <div class="filter-menu-panel">
            <!-- Header -->
            <div class="filter-menu-header">
                <div class="filter-menu-tabs">
                    <div class="filter-tab active" onclick="switchToFiltersTab()">
                        <img src="Illustrations/filter menu icons/Filter menu icon.svg" alt="Filter" class="filter-tab-icon">
                        <span class="filter-tab-text">Filters</span>
                        <div class="filter-tab-bar"></div>
                    </div>
                    <div class="filter-tab" onclick="switchToMySearchesTab()">
                        <img src="Illustrations/filter menu icons/Saved searches filter menu.svg" alt="Saved" class="filter-tab-icon">
                        <span class="filter-tab-text">My searches</span>
                        <div class="filter-tab-bar"></div>
                    </div>
                </div>
                <button class="filter-menu-close" onclick="closeFilterMenu()">
                    <img src="Illustrations/filter menu icons/Filter menu close.svg" alt="Close" class="filter-close-icon">
                </button>
            </div>

            <!-- Filter Pills Section -->
            <div class="filter-pills-section">
                <div class="permanent-filter-pill">
                    <img src="Illustrations/Filter Bar Icons/location pill.svg" alt="Location" class="location-icon">
                    <span class="location-text">75214</span>
                    <span class="separator">|</span>
                    <span class="filter-description">Cars within 250 mi</span>
                </div>
                <div class="filter-pills-row">
                </div>
                <div class="reset-link" onclick="resetAllFilters()">
                    <span>Reset</span>
                </div>
            </div>

            <!-- Filter Options List -->
            <div class="filter-options-list" id="filterOptionsList">
                <div class="filter-option">
                    <span class="filter-option-text">Distance & shipping</span>
                    <img src="Illustrations/filter menu icons/Parent filter icon.svg" alt="Arrow" class="filter-arrow">
                </div>
                <div class="filter-option">
                    <span class="filter-option-text">Make/Model/Trim</span>
                    <img src="Illustrations/filter menu icons/Parent filter icon.svg" alt="Arrow" class="filter-arrow">
                </div>
                <div class="filter-option" onclick="openBodyStyleFilter()">
                    <span class="filter-option-text">Body style</span>
                    <img src="Illustrations/filter menu icons/Parent filter icon.svg" alt="Arrow" class="filter-arrow">
                </div>
                <div class="filter-option" onclick="openPricePaymentFilter()">
                    <span class="filter-option-text">Price & payment</span>
                    <img src="Illustrations/filter menu icons/Parent filter icon.svg" alt="Arrow" class="filter-arrow">
                </div>
                <div class="filter-option">
                    <span class="filter-option-text">Year</span>
                    <img src="Illustrations/filter menu icons/Parent filter icon.svg" alt="Arrow" class="filter-arrow">
                </div>
                <div class="filter-option">
                    <span class="filter-option-text">Mileage</span>
                    <img src="Illustrations/filter menu icons/Parent filter icon.svg" alt="Arrow" class="filter-arrow">
                </div>
                <div class="filter-option">
                    <span class="filter-option-text">Features</span>
                    <img src="Illustrations/filter menu icons/Parent filter icon.svg" alt="Arrow" class="filter-arrow">
                </div>
                <div class="filter-option">
                    <span class="filter-option-text">MPG & engine type</span>
                    <img src="Illustrations/filter menu icons/Parent filter icon.svg" alt="Arrow" class="filter-arrow">
                </div>
                <div class="filter-option">
                    <span class="filter-option-text">Drive type & transmission</span>
                    <img src="Illustrations/filter menu icons/Parent filter icon.svg" alt="Arrow" class="filter-arrow">
                </div>
                <div class="filter-option">
                    <span class="filter-option-text">Color</span>
                    <img src="Illustrations/filter menu icons/Parent filter icon.svg" alt="Arrow" class="filter-arrow">
                </div>
            </div>

            <!-- My Searches Content (Hidden by default) -->
            <div class="my-searches-content" id="mySearchesContent" style="display: none;">
                <!-- Not Signed In Content -->
                <div class="my-searches-not-signed-in" id="mySearchesNotSignedIn">
                    <div class="my-searches-message">
                        <p class="my-searches-text">Sign in to save searches & get notified about new matches.</p>
                    </div>
                    <div class="my-searches-actions">
                        <button class="my-searches-signin-btn" onclick="openSignInFromMySearches()">Sign in</button>
                        <a href="#" class="my-searches-create-link" onclick="openAccountCreationFromMySearches(); return false;">Create an account</a>
                    </div>
                </div>

                <!-- Signed In Content -->
                <div class="my-searches-signed-in" id="mySearchesSignedIn" style="display: none;">
                    <div class="saved-searches-section">
                        <h3 class="saved-searches-heading">Saved searches</h3>
                        <div class="saved-searches-list">
                            <div class="saved-search-card">
                                <div class="saved-search-info">
                                    <h4 class="saved-search-name">Save search 1</h4>
                                    <p class="saved-search-criteria">Electric, Tesla, 15-30K</p>
                                </div>
                                <div class="saved-search-status">
                                    <div class="car-icon-container">
                                        <img src="Illustrations/02_Filter/saved-search-car-icon.svg" alt="Car" class="car-icon">
                                    </div>
                                    <span class="new-results">15 new</span>
                                </div>
                            </div>
                            <div class="saved-search-card selected">
                                <div class="saved-search-info">
                                    <h4 class="saved-search-name">Save search 2</h4>
                                    <p class="saved-search-criteria">Electric, Tesla, 15-30K</p>
                                </div>
                                <div class="saved-search-status">
                                    <div class="car-icon-container">
                                        <img src="Illustrations/02_Filter/saved-search-car-icon.svg" alt="Car" class="car-icon">
                                    </div>
                                    <span class="new-results">10 new</span>
                                </div>
                            </div>
                            <div class="saved-search-card">
                                <div class="saved-search-info">
                                    <h4 class="saved-search-name">Save search 3</h4>
                                    <p class="saved-search-criteria">Electric, Tesla, 15-30K, +100 more</p>
                                </div>
                            </div>
                            <div class="saved-search-card">
                                <div class="saved-search-info">
                                    <h4 class="saved-search-name">Electric, Tesla, 15...</h4>
                                </div>
                                <div class="saved-search-status">
                                    <div class="car-icon-container">
                                        <img src="Illustrations/02_Filter/saved-search-car-icon.svg" alt="Car" class="car-icon">
                                    </div>
                                    <span class="new-results">74 new</span>
                                </div>
                            </div>
                        </div>
                        <div class="manage-alerts-link">
                            <span>Manage alerts</span>
                            <img src="Illustrations/right arrow.svg" alt="Arrow" class="arrow-icon">
                        </div>
                    </div>
                </div>

                <!-- Signed In But No Saved Searches Content -->
                <div class="my-searches-empty-state" id="mySearchesEmptyState" style="display: none;">
                    <div class="empty-state-illustration">
                        <img src="Illustrations/09_Empty_States/no-saved-searches.svg" alt="No saved searches" class="empty-state-icon">
                    </div>
                    <div class="empty-state-content">
                        <h3 class="empty-state-heading">You don't have any saved searches</h3>
                        <p class="empty-state-description">Save a search to get notified when new cars match what you're looking for.</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Bottom Button - Outside of scrollable container -->
        <div class="filter-menu-bottom">
            <button class="view-results-btn" onclick="closeFilterMenu(); navigateToSearch();">
                <span class="view-results-text">View results</span>
            </button>
        </div>
    </div>

    <!-- Body Style Filter Overlay -->
    <div id="bodyStyleOverlay" class="body-style-overlay">
        <div class="body-style-panel">
            <!-- Header -->
            <div class="body-style-header">
                <div class="body-style-back" onclick="closeBodyStyleFilter()">
                    <img src="Illustrations/filter menu icons/distance&stores icons/Right Icon.svg" alt="Back" class="body-style-back-icon">
                    <span class="body-style-back-text">All filters</span>
                </div>
            </div>
            
            <!-- Body Style Heading -->
            <div class="body-style-heading">
                <h3>Body style</h3>
            </div>
            
            <!-- Body Style Options -->
            <div class="body-style-options">
                <div class="body-style-option" onclick="selectBodyStyle('Convertible', 66)">
                    <div class="body-style-info">
                        <span class="body-style-name">Convertible</span>
                        <span class="body-style-count">(66)</span>
                    </div>
                    <img src="Illustrations/Body style illustrations/Convertible.svg" alt="Convertible" class="body-style-icon">
                </div>
                
                <div class="body-style-option" onclick="selectBodyStyle('Coupe', 102)">
                    <div class="body-style-info">
                        <span class="body-style-name">Coupe</span>
                        <span class="body-style-count">(102)</span>
                    </div>
                    <img src="Illustrations/Body style illustrations/Coupe.svg" alt="Coupe" class="body-style-icon">
                </div>
                
                <div class="body-style-option" onclick="selectBodyStyle('Hatchback', 87)">
                    <div class="body-style-info">
                        <span class="body-style-name">Hatchback</span>
                        <span class="body-style-count">(87)</span>
                    </div>
                    <img src="Illustrations/Body style illustrations/Hatchback.svg" alt="Hatchback" class="body-style-icon">
                </div>
                
                <div class="body-style-option" onclick="selectBodyStyle('Sedan', 3102)">
                    <div class="body-style-info">
                        <span class="body-style-name">Sedan</span>
                        <span class="body-style-count">(3,102)</span>
                    </div>
                    <img src="Illustrations/Body style illustrations/Sedan.svg" alt="Sedan" class="body-style-icon">
                </div>
                
                <div class="body-style-option" onclick="selectBodyStyle('SUV', 124)">
                    <div class="body-style-info">
                        <span class="body-style-name">SUV</span>
                        <span class="body-style-count">(124)</span>
                    </div>
                    <img src="Illustrations/Body style illustrations/SUV.svg" alt="SUV" class="body-style-icon">
                </div>
                
                <div class="body-style-option" onclick="selectBodyStyle('Truck', 573)">
                    <div class="body-style-info">
                        <span class="body-style-name">Truck</span>
                        <span class="body-style-count">(573)</span>
                    </div>
                    <img src="Illustrations/Body style illustrations/Truck.svg" alt="Truck" class="body-style-icon">
                </div>
                
                <div class="body-style-option" onclick="selectBodyStyle('Van/Minivan', 77)">
                    <div class="body-style-info">
                        <span class="body-style-name">Van/Minivan</span>
                        <span class="body-style-count">(77)</span>
                    </div>
                    <img src="Illustrations/Body style illustrations/Minivan.svg" alt="Van/Minivan" class="body-style-icon">
                </div>
                
                <div class="body-style-option" onclick="selectBodyStyle('Wagon', 2)">
                    <div class="body-style-info">
                        <span class="body-style-name">Wagon</span>
                        <span class="body-style-count">(2)</span>
                    </div>
                    <img src="Illustrations/Body style illustrations/Wagon.svg" alt="Wagon" class="body-style-icon">
                </div>
            </div>
            
            <!-- Bottom Button -->
            <div class="body-style-bottom">
                <button class="view-results-btn" onclick="closeBodyStyleFilter(); navigateToSearch();">
                    <span class="view-results-text">View results</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Price & Payment Filter Overlay -->
    <div id="pricePaymentOverlay" class="price-payment-overlay">
        <div class="price-payment-panel">
            <!-- Header -->
            <div class="price-payment-header">
                <div class="price-payment-back" onclick="closePricePaymentFilter()">
                    <img src="Illustrations/filter menu icons/distance&stores icons/Right Icon.svg" alt="Back" class="price-payment-back-icon">
                    <span class="price-payment-back-text">All filters</span>
                </div>
            </div>
            
            <!-- Price & Payment Heading -->
            <div class="price-payment-heading">
                <h3>Price & payment</h3>
            </div>
            
            <!-- Price & Payment Content -->
            <div class="price-payment-content">
                <!-- Segmented Control (Non-interactive) -->
                <div class="segmented-control">
                    <div class="segmented-option selected">
                        <span>Price</span>
                    </div>
                    <div class="segmented-option">
                        <span>Payment</span>
                    </div>
                </div>
                
                <!-- Price Range Inputs -->
                <div class="price-inputs">
                    <div class="price-input-group">
                        <label class="price-input-label">Min</label>
                        <div class="price-input-container">
                            <input type="text" class="price-input" value="$5,000" id="minPrice">
                        </div>
                    </div>
                    <div class="price-input-group">
                        <label class="price-input-label">Max</label>
                        <div class="price-input-container">
                            <input type="text" class="price-input" value="$70,000" id="maxPrice">
                        </div>
                    </div>
                </div>
                
                <!-- Range Slider -->
                <div class="range-slider-container">
                    <div class="range-slider-wrapper">
                        <div class="range-slider-track"></div>
                        <div class="range-slider-range" id="rangeBar"></div>
                        <input type="range" class="range-slider range-slider-min" id="minPriceRange" min="0" max="100000" value="5000" step="1000">
                        <input type="range" class="range-slider range-slider-max" id="maxPriceRange" min="0" max="100000" value="70000" step="1000">
                        <div class="range-slider-thumb range-slider-thumb-min" id="minThumb"></div>
                        <div class="range-slider-thumb range-slider-thumb-max" id="maxThumb"></div>
                    </div>
                </div>
            </div>
            
            <!-- Bottom Button -->
            <div class="price-payment-bottom">
                <button class="view-results-btn" onclick="closePricePaymentFilter(); navigateToSearch();">
                    <span class="view-results-text">View results</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Sort Menu Overlay -->
    <div id="sortMenu" class="sort-menu-overlay">
        <div class="sort-menu-panel">
            <div class="sort-menu-header">
                <h3 class="sort-menu-title">Sort by</h3>
            </div>
            <div class="sort-menu-options">
                <div class="sort-option" onclick="selectSortOption(this, 'new-arrivals')">
                    <span class="sort-option-text">New Arrivals</span>
                    <span class="sort-option-check"></span>
                </div>
                <div class="sort-option selected" onclick="selectSortOption(this, 'distance-nearest')">
                    <span class="sort-option-text">Distance: Nearest</span>
                    <span class="sort-option-check"></span>
                </div>
                <div class="sort-option" onclick="selectSortOption(this, 'mileage-highest')">
                    <span class="sort-option-text">Mileage: Highest</span>
                    <span class="sort-option-check"></span>
                </div>
                <div class="sort-option" onclick="selectSortOption(this, 'mileage-lowest')">
                    <span class="sort-option-text">Mileage: Lowest</span>
                    <span class="sort-option-check"></span>
                </div>
                <div class="sort-option" onclick="selectSortOption(this, 'price-highest')">
                    <span class="sort-option-text">Price: Highest</span>
                    <span class="sort-option-check"></span>
                </div>
                <div class="sort-option" onclick="selectSortOption(this, 'price-lowest')">
                    <span class="sort-option-text">Price: Lowest</span>
                    <span class="sort-option-check"></span>
                </div>
                <div class="sort-option" onclick="selectSortOption(this, 'year-newest')">
                    <span class="sort-option-text">Year: Newest</span>
                    <span class="sort-option-check"></span>
                </div>
                <div class="sort-option" onclick="selectSortOption(this, 'year-oldest')">
                    <span class="sort-option-text">Year: Oldest</span>
                    <span class="sort-option-check"></span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global state
        let isSignedIn = true; // Always signed in for this prototype
        let isSearchSaved = false;
        let alertsEnabled = true; // Always enabled for this prototype
        let hasShownAlertToast = localStorage.getItem('hasShownAlertToast') === 'true'; // Restore from localStorage
        
        // Set localStorage to match prototype state
        localStorage.setItem('isSignedIn', 'true');
        localStorage.setItem('alertsEnabled', 'true');

        // Check if coming from a saved search
        const isViewingSavedSearch = sessionStorage.getItem('isViewingSavedSearch') === 'true';
        const selectedSavedSearch = sessionStorage.getItem('selectedSavedSearch');
        const appliedFilters = sessionStorage.getItem('appliedFilters');

        // Initialize saved searches in localStorage for this prototype
        initializeSavedSearches();
        
        // Run comprehensive tests
        runPrototypeTests();
        
        // Apply saved search filters on page load
        if (isViewingSavedSearch && appliedFilters) {
            try {
                const filters = JSON.parse(appliedFilters);
                applySavedSearchFilters(filters);
                
                // Add new car badges to SRP tiles
                if (selectedSavedSearch) {
                    addNewCarBadgesToTiles(selectedSavedSearch);
                }
            } catch (e) {
                console.error('Error parsing applied filters:', e);
            }
        }
        
        function initializeSavedSearches() {
            // Always clear and remake saved searches for this prototype
            const prototypeSearches = [
                {
                    name: 'Under $15k for Sally',
                    bodyStyles: ['Sedan'],
                    priceRange: { min: '5000', max: '15000' },
                    createdAt: new Date().toISOString()
                },
                {
                    name: 'Dream car',
                    bodyStyles: ['Convertible'],
                    priceRange: { min: '25000', max: '70000' },
                    fuelType: 'gas',
                    make: 'BMW',
                    model: '3 Series',
                    createdAt: new Date().toISOString()
                },
                {
                    name: 'High safety rating',
                    bodyStyles: ['SUV'],
                    priceRange: { min: '5000', max: '70000' },
                    drivetrain: 'awd',
                    yearMin: 2020,
                    createdAt: new Date().toISOString()
                }
            ];
            localStorage.setItem('savedSearches', JSON.stringify(prototypeSearches));
            console.log('Initialized saved searches:', prototypeSearches);
        }

        function runPrototypeTests() {
            console.log(' PROTOTYPE TESTING AGENT - Starting comprehensive tests...');
            
            const tests = [];
            
            // Helper function to easily add new tests when issues are discovered
            function addTest(name, testFunction) {
                tests.push({ name, test: testFunction });
            }
            
            // ===== CORE FUNCTIONALITY TESTS =====
            
            addTest('Saved searches initialization', () => {
                const savedSearches = JSON.parse(localStorage.getItem('savedSearches') || '[]');
                const expectedNames = ['Under $15k for Sally', 'Dream car', 'High safety rating'];
                const actualNames = savedSearches.map(s => s.name);
                return expectedNames.every(name => actualNames.includes(name));
            });
            
            addTest('Filter pills show individual filters for saved search', () => {
                // Simulate selecting a saved search
                sessionStorage.setItem('isViewingSavedSearch', 'true');
                sessionStorage.setItem('selectedSavedSearch', 'Under $15k for Sally');
                sessionStorage.setItem('appliedFilters', JSON.stringify({
                    bodyStyle: 'sedan',
                    priceMin: 5000,
                    priceMax: 15000
                }));
                
                updateFilterPills();
                
                const filterPills = document.querySelectorAll('.filter-pill.removable');
                const hasIndividualFilters = Array.from(filterPills).some(pill => 
                    pill.textContent.includes('Sedan') || pill.textContent.includes('$5,000 - $15,000')
                );
                
                // Clean up
                sessionStorage.removeItem('isViewingSavedSearch');
                sessionStorage.removeItem('selectedSavedSearch');
                sessionStorage.removeItem('appliedFilters');
                
                return hasIndividualFilters;
            });
            
            addTest('New car badges appear on SRP tiles', () => {
                const srpTiles = document.querySelectorAll('.srp-tile');
                if (srpTiles.length === 0) return false;
                
                // Simulate adding badges
                addNewCarBadgesToTiles('Under $15k for Sally');
                
                const badges = document.querySelectorAll('.srp-tile-new-badge');
                return badges.length > 0;
            });
            
            addTest('Vehicle count generation is consistent', () => {
                const count1 = getVehicleCount('Under $15k for Sally');
                const count2 = getVehicleCount('Under $15k for Sally');
                const count3 = getVehicleCount('Dream car');
                
                return count1 === count2 && count1 !== count3 && count1 >= 1 && count1 <= 9;
            });
            
            addTest('Saved search selection works in My searches', () => {
                // Find the search index from localStorage
                const savedSearches = JSON.parse(localStorage.getItem('savedSearches') || '[]');
                const searchIndex = savedSearches.findIndex(s => s.name === 'Under $15k for Sally');
                
                if (searchIndex === -1) return false;
                
                // Apply the saved search using the correct function
                applySavedSearch(searchIndex);
                
                const isViewingSavedSearch = sessionStorage.getItem('isViewingSavedSearch') === 'true';
                const selectedSavedSearch = sessionStorage.getItem('selectedSavedSearch');
                
                return isViewingSavedSearch && selectedSavedSearch === 'Under $15k for Sally';
            });
            
            addTest('Car icon color filters are applied', () => {
                const selectedIconStyle = getComputedStyle(document.querySelector('.saved-search-card.selected .car-icon'));
                const srpBadgeStyle = getComputedStyle(document.querySelector('.srp-tile-new-badge-icon'));
                
                // Check if filters are applied (they should have filter property)
                return selectedIconStyle.filter !== 'none' && srpBadgeStyle.filter !== 'none';
            });
            
            // ===== ISSUES DISCOVERED IN CHAT =====
            // Add new tests here when we identify logic issues
            
            addTest('Issue: Filter pills show individual filters instead of location filters', () => {
                // Simulate selecting a saved search
                sessionStorage.setItem('isViewingSavedSearch', 'true');
                sessionStorage.setItem('selectedSavedSearch', 'Under $15k for Sally');
                sessionStorage.setItem('appliedFilters', JSON.stringify({
                    bodyStyle: 'sedan',
                    priceMin: 5000,
                    priceMax: 15000
                }));
                
                updateFilterPills();
                
                const filterPills = document.querySelectorAll('.filter-pill.removable');
                const hasLocationFilter = Array.from(filterPills).some(pill => 
                    pill.textContent.includes('75214') || pill.textContent.includes('Cars within')
                );
                const hasIndividualFilters = Array.from(filterPills).some(pill => 
                    pill.textContent.includes('Sedan') || pill.textContent.includes('$5,000 - $15,000')
                );
                
                // Clean up
                sessionStorage.removeItem('isViewingSavedSearch');
                sessionStorage.removeItem('selectedSavedSearch');
                sessionStorage.removeItem('appliedFilters');
                
                // Should show individual filters, not location filters
                return !hasLocationFilter && hasIndividualFilters;
            });
            
            addTest('Issue: applySavedSearch function updates filter pills correctly', () => {
                // Test the actual applySavedSearch function
                const testSearch = {
                    name: 'Under $15k for Sally',
                    bodyStyles: ['Sedan'],
                    priceRange: { min: '5000', max: '15000' }
                };
                
                // Find the search index
                const savedSearches = JSON.parse(localStorage.getItem('savedSearches') || '[]');
                const searchIndex = savedSearches.findIndex(s => s.name === 'Under $15k for Sally');
                
                if (searchIndex === -1) return false;
                
                // Apply the saved search
                applySavedSearch(searchIndex);
                
                // Check if filter pills were updated with individual filters
                const filterPills = document.querySelectorAll('.filter-pill.removable');
                const hasIndividualFilters = Array.from(filterPills).some(pill => 
                    pill.textContent.includes('Sedan') || pill.textContent.includes('$5,000 - $15,000')
                );
                
                // Clean up
                sessionStorage.removeItem('isViewingSavedSearch');
                sessionStorage.removeItem('selectedSavedSearch');
                sessionStorage.removeItem('appliedFilters');
                
                return hasIndividualFilters;
            });
            
            
            // Run all tests
            let passedTests = 0;
            let totalTests = tests.length;
            
            tests.forEach(test => {
                try {
                    const result = test.test();
                    if (result) {
                        console.log(` ${test.name}: PASSED`);
                        passedTests++;
                    } else {
                        console.log(` ${test.name}: FAILED`);
                    }
                } catch (error) {
                    console.log(` ${test.name}: ERROR - ${error.message}`);
                }
            });
            
            // Summary
            console.log(`\n TEST SUMMARY: ${passedTests}/${totalTests} tests passed`);
            
            if (passedTests === totalTests) {
                console.log(' All tests passed! Prototype is working correctly.');
            } else {
                console.log('  Some tests failed. Check the logs above for details.');
            }
            
            return passedTests === totalTests;
        }

        function applySavedSearchFilters(filters) {
            // Apply price filters
            if (filters.priceMin) {
                // Set minimum price filter
                const minPriceInput = document.querySelector('input[data-filter="price-min"]');
                if (minPriceInput) minPriceInput.value = filters.priceMin;
            }
            if (filters.priceMax) {
                // Set maximum price filter
                const maxPriceInput = document.querySelector('input[data-filter="price-max"]');
                if (maxPriceInput) maxPriceInput.value = filters.priceMax;
            }

            // Apply body style filter
            if (filters.bodyStyle) {
                const bodyStyleMap = {
                    'sedan': 'Sedan',
                    'convertible': 'Convertible', 
                    'suv': 'SUV',
                    'coupe': 'Coupe',
                    'hatchback': 'Hatchback',
                    'truck': 'Truck',
                    'wagon': 'Wagon',
                    'minivan': 'Minivan'
                };
                const bodyStyleName = bodyStyleMap[filters.bodyStyle];
                if (bodyStyleName) {
                    const bodyStyleOption = Array.from(document.querySelectorAll('.body-style-option'))
                        .find(option => option.querySelector('.body-style-name').textContent === bodyStyleName);
                    if (bodyStyleOption) {
                        bodyStyleOption.classList.add('selected');
                    }
                }
            }

            // Apply other filters as needed
            if (filters.transmission) {
                // Apply transmission filter logic here
            }
            if (filters.fuelType) {
                // Apply fuel type filter logic here
            }
            if (filters.drivetrain) {
                // Apply drivetrain filter logic here
            }
            if (filters.yearMin) {
                // Apply year filter logic here
            }

            // Update filter pills to show applied filters
            updateFilterPills();
        }

        function updateFilterPills() {
            console.log('updateFilterPills called');
            
            // Get containers
            const mainPillsRow = document.querySelector('.filter-pills .filter-pills-row');
            const filterMenuPillsRow = document.querySelector('.filter-pills-section .filter-pills-row');
            console.log('Container check - mainPillsRow:', !!mainPillsRow, 'filterMenuPillsRow:', !!filterMenuPillsRow);
            
            if (mainPillsRow) {
                console.log('Main pills row has', mainPillsRow.children.length, 'children before adding pills');
                console.log('Main pills row children:', Array.from(mainPillsRow.children).map(c => c.textContent?.trim()));
                console.log('Main pills row computed style:', window.getComputedStyle(mainPillsRow).display);
                console.log('Main pills row visibility:', window.getComputedStyle(mainPillsRow).visibility);
                console.log('Main pills row position:', mainPillsRow.getBoundingClientRect());
            }
            if (filterMenuPillsRow) {
                console.log('Filter menu pills row has', filterMenuPillsRow.children.length, 'children before adding pills');
                console.log('Filter menu pills row children:', Array.from(filterMenuPillsRow.children).map(c => c.textContent?.trim()));
            }
            
            // Clear all removable pills
            [mainPillsRow, filterMenuPillsRow].forEach(container => {
                if (container) {
                    const removablePills = container.querySelectorAll('.filter-pill.removable');
                    removablePills.forEach(pill => pill.remove());
                }
            });
            
            // Get applied filters from sessionStorage
            const appliedFilters = sessionStorage.getItem('appliedFilters');
            console.log('Applied filters from sessionStorage:', appliedFilters);
            if (!appliedFilters) {
                return;
            }
            
            try {
                const filters = JSON.parse(appliedFilters);
                console.log('Parsed filters:', filters);
                
                // Helper function to add a pill to both containers
                const addPillToBothContainers = (text) => {
                    console.log('Adding pill:', text, 'to containers:', !!mainPillsRow, !!filterMenuPillsRow);
                    [mainPillsRow, filterMenuPillsRow].forEach(container => {
                        if (container) {
                            const pill = document.createElement('div');
                            pill.className = 'filter-pill removable';
                            pill.innerHTML = `
                                <span class="filter-pill-text">${text}</span>
                                <button class="filter-pill-close" onclick="removeFilterPill(this)">
                                    <img src="Illustrations/Filter Bar Icons/X.svg" alt="Close" class="close-icon">
                                </button>
                            `;
                            container.appendChild(pill);
                            console.log('Added pill to container:', container.className);
                            console.log('Container now has', container.children.length, 'children');
                            console.log('Last child text:', container.lastElementChild?.textContent?.trim());
                            console.log('Last child classes:', container.lastElementChild?.className);
                            console.log('Last child computed style:', window.getComputedStyle(container.lastElementChild).display);
                        }
                    });
                };
                
                // Add body style pill
                if (filters.bodyStyle) {
                    const bodyStyleMap = {
                        'sedan': 'Sedan',
                        'convertible': 'Convertible', 
                        'suv': 'SUV',
                        'coupe': 'Coupe',
                        'hatchback': 'Hatchback',
                        'truck': 'Truck',
                        'wagon': 'Wagon',
                        'minivan': 'Minivan'
                    };
                    const bodyStyleName = bodyStyleMap[filters.bodyStyle];
                    if (bodyStyleName) {
                        addPillToBothContainers(bodyStyleName);
                    }
                }
                
                // Add price range pill
                if (filters.priceMin !== undefined || filters.priceMax !== undefined) {
                    const minValue = filters.priceMin !== undefined ? filters.priceMin : 5000;
                    const maxValue = filters.priceMax !== undefined ? filters.priceMax : 70000;
                    const minFormatted = '$' + parseInt(minValue).toLocaleString();
                    const maxFormatted = '$' + parseInt(maxValue).toLocaleString();
                    const pillText = `${minFormatted} - ${maxFormatted}`;
                    addPillToBothContainers(pillText);
                }
                
                // Add transmission pill
                if (filters.transmission) {
                    const transmissionMap = {
                        'automatic': 'Automatic',
                        'manual': 'Manual'
                    };
                    const transmissionName = transmissionMap[filters.transmission];
                    if (transmissionName) {
                        addPillToBothContainers(transmissionName);
                    }
                }
                
                // Add fuel type pill
                if (filters.fuelType) {
                    const fuelTypeMap = {
                        'gas': 'Gas',
                        'hybrid': 'Hybrid',
                        'electric': 'Electric'
                    };
                    const fuelTypeName = fuelTypeMap[filters.fuelType];
                    if (fuelTypeName) {
                        addPillToBothContainers(fuelTypeName);
                    }
                }
                
                // Add drivetrain pill
                if (filters.drivetrain) {
                    const drivetrainMap = {
                        'fwd': 'FWD',
                        'rwd': 'RWD',
                        'awd': 'AWD'
                    };
                    const drivetrainName = drivetrainMap[filters.drivetrain];
                    if (drivetrainName) {
                        addPillToBothContainers(drivetrainName);
                    }
                }
                
                // Add year pill
                if (filters.yearMin) {
                    addPillToBothContainers(`${filters.yearMin}+`);
                }
                
                // Add make pill
                if (filters.make) {
                    addPillToBothContainers(filters.make);
                }
                
                // Add model pill
                if (filters.model) {
                    addPillToBothContainers(filters.model);
                }
                
            } catch (e) {
                console.error('Error parsing applied filters:', e);
            }
        }
        
        function addFilterPill(text) {
            // Add to main SRP filter pills
            addFilterPillToContainer('.filter-pills .filter-pills-row', text);
            
            // Add to filter menu pills
            addFilterPillToContainer('.filter-pills-section .filter-pills-row', text);
        }
        
        function addFilterPillToContainer(containerSelector, text) {
            const container = document.querySelector(containerSelector);
            if (!container) return;
            
            const pill = document.createElement('div');
            pill.className = 'filter-pill removable';
            pill.innerHTML = `
                <span class="filter-pill-text">${text}</span>
                <button class="filter-pill-close" onclick="removeFilterPill(this)">
                    <img src="Illustrations/Filter Bar Icons/X.svg" alt="Close" class="close-icon">
                </button>
            `;
            
            container.appendChild(pill);
        }

        function removeFilterPill(button) {
            // Remove the pill from both containers
            const pill = button.closest('.filter-pill');
            if (pill) {
                pill.remove();
            }
            
            // Clear saved search state when filters are modified
            clearSavedSearchState();
        }
        
        function clearSavedSearchState() {
            // Clear saved search state when filters are modified
            sessionStorage.removeItem('isViewingSavedSearch');
            sessionStorage.removeItem('selectedSavedSearch');
            sessionStorage.removeItem('appliedFilters');
        }

        function openHamburgerMenu() {
            console.log('Hamburger menu clicked');
            document.getElementById('hamburgerOverlay').style.display = 'block';
            document.getElementById('hamburgerMenu').classList.add('open');
            document.querySelector('.mobile-container').classList.add('menu-open');
            // Prevent background scrolling
            document.body.style.overflow = 'hidden';
        }

        function closeHamburgerMenu() {
            document.getElementById('hamburgerOverlay').style.display = 'none';
            document.getElementById('hamburgerMenu').classList.remove('open');
            document.querySelector('.mobile-container').classList.remove('menu-open');
            // Restore background scrolling
            document.body.style.overflow = 'auto';
        }

        function navigateToHomepage() {
            window.location.href = 'homepage.html';
        }

        function navigateToSavedSearches() {
            // Always go to saved-searches.html (user is logged in in this prototype)
            window.location.href = 'saved-searches.html';
        }

        function navigateToSearch() {
            // Save current filter state before navigating
            saveFilterState();
            // Navigate to the SRP with applied filters
            window.location.href = 'search-not-saved.html';
        }


        function saveFilterState() {
            // Save selected body styles
            const selectedBodyStyles = Array.from(document.querySelectorAll('.body-style-option.selected'))
                .map(option => option.querySelector('.body-style-name').textContent);
            localStorage.setItem('selectedBodyStyles', JSON.stringify(selectedBodyStyles));
            
            // Price range should already be saved in localStorage from the price filter
            // No need to save it again here since it's already persisted
        }

        function openSignIn() {
            // This will be implemented when we build the sign-in flow
            console.log('Sign in clicked');
            isSignedIn = true;
            localStorage.setItem('isSignedIn', 'true');
            closeToast();
        }

        function openFilterMenu() {
            console.log('Filter menu clicked');
            const filterMenu = document.getElementById('filterMenu');
            if (filterMenu) {
                filterMenu.style.display = 'block';
                // Prevent background scrolling
                document.body.style.overflow = 'hidden';
                // Add slide-in animation
                setTimeout(() => {
                    filterMenu.classList.add('show');
                    // Restore filter states in the menu
                    restoreFilterMenuStates();
                    
                    // Check if a saved search is currently active
                    const isViewingSavedSearch = sessionStorage.getItem('isViewingSavedSearch') === 'true';
                    
                    if (isViewingSavedSearch) {
                        // A saved search is active - default to My searches tab
                        switchToMySearchesTab();
                    } else {
                        // No saved search active - default to Filters tab
                        switchToFiltersTab();
                    }
                }, 10);
            }
        }
        
        function restoreFilterMenuStates() {
            // Restore body style selections
            const selectedBodyStyles = JSON.parse(localStorage.getItem('selectedBodyStyles') || '[]');
            const bodyStyleOptions = document.querySelectorAll('.body-style-option');
            bodyStyleOptions.forEach(option => {
                const styleName = option.querySelector('.body-style-name').textContent;
                if (selectedBodyStyles.includes(styleName)) {
                    option.classList.add('selected');
                } else {
                    option.classList.remove('selected');
                }
            });
            
            // Restore price range sliders
            const savedPriceRange = JSON.parse(localStorage.getItem('priceRange') || '{"min":"5000","max":"70000"}');
            const minSlider = document.getElementById('minPriceRange');
            const maxSlider = document.getElementById('maxPriceRange');
            const minInput = document.getElementById('minPrice');
            const maxInput = document.getElementById('maxPrice');
            
            if (minSlider && maxSlider) {
                minSlider.value = savedPriceRange.min;
                maxSlider.value = savedPriceRange.max;
            }
            
            if (minInput && maxInput) {
                minInput.value = '$' + parseInt(savedPriceRange.min).toLocaleString();
                maxInput.value = '$' + parseInt(savedPriceRange.max).toLocaleString();
            }
            
            // Update price slider visuals if the function exists
            if (typeof updateThumbsAndRange === 'function') {
                updateThumbsAndRange();
            }
        }

        function closeFilterMenu() {
            const filterMenu = document.getElementById('filterMenu');
            if (filterMenu) {
                filterMenu.classList.remove('show');
                // Restore background scrolling
                document.body.style.overflow = 'auto';
                setTimeout(() => {
                    filterMenu.style.display = 'none';
                }, 300);
            }
        }

        let sortMenuClickHandler = null;

        function openSortMenu() {
            const sortMenu = document.getElementById('sortMenu');
            if (sortMenu) {
                // Remove any existing click handler
                if (sortMenuClickHandler) {
                    document.removeEventListener('click', sortMenuClickHandler);
                }
                
                sortMenu.classList.add('show');
                // Prevent background scrolling
                document.body.style.overflow = 'hidden';
                
                // Add click outside to close functionality
                sortMenuClickHandler = (event) => {
                    if (!sortMenu.contains(event.target)) {
                        closeSortMenu();
                    }
                };
                
                // Add event listener after a small delay to prevent immediate closing
                setTimeout(() => {
                    document.addEventListener('click', sortMenuClickHandler);
                }, 100);
            }
        }

        function closeSortMenu() {
            const sortMenu = document.getElementById('sortMenu');
            if (sortMenu) {
                sortMenu.classList.remove('show');
                // Restore background scrolling
                document.body.style.overflow = 'auto';
                
                // Remove click handler
                if (sortMenuClickHandler) {
                    document.removeEventListener('click', sortMenuClickHandler);
                    sortMenuClickHandler = null;
                }
            }
        }

        function updateSortMenuDisplay(sortType) {
            // Remove selected class from all options
            const allOptions = document.querySelectorAll('.sort-option');
            allOptions.forEach(option => option.classList.remove('selected'));
            
            // Add selected class to the specified option
            const targetOption = document.querySelector(`[onclick*="${sortType}"]`);
            if (targetOption) {
                targetOption.classList.add('selected');
            }
        }

        function selectSortOption(element, sortType) {
            // Remove selected class from all options
            const allOptions = document.querySelectorAll('.sort-option');
            allOptions.forEach(option => option.classList.remove('selected'));
            
            // Add selected class to clicked option
            element.classList.add('selected');
            
            // Store sort preference in sessionStorage
            sessionStorage.setItem('sortBy', sortType);
            
            // Reorder the vehicles based on sort type
            reorderVehicles(sortType);
            
            // Close the sort menu
            setTimeout(() => {
                closeSortMenu();
            }, 300);
        }

        function reorderVehicles(sortType) {
            const srpTiles = document.querySelectorAll('.srp-tile');
            const tilesArray = Array.from(srpTiles);
            const container = document.querySelector('.srp-tiles-container');
            
            if (!container || tilesArray.length === 0) return;
            
            // Clear all badges first - they'll be re-added only for saved searches
            const existingBadges = document.querySelectorAll('.srp-tile-new-badge');
            existingBadges.forEach(badge => badge.remove());
            
            // Create a copy of tiles with their data for sorting
            const tilesWithData = tilesArray.map(tile => {
                const priceText = tile.querySelector('.price')?.textContent || '';
                const yearText = tile.querySelector('.year')?.textContent || '';
                const mileageText = tile.querySelector('.mileage')?.textContent || '';
                const hasNewBadge = tile.querySelector('.srp-tile-new-badge') !== null;
                
                // Extract numeric values
                const price = parseInt(priceText.replace(/[$,]/g, '')) || 0;
                const year = parseInt(yearText) || 0;
                const mileage = parseInt(mileageText.replace(/[,\s]/g, '')) || 0;
                
                return {
                    element: tile,
                    price,
                    year,
                    mileage,
                    hasNewBadge
                };
            });
            
            // Sort based on sort type
            let sortedTiles;
            switch (sortType) {
                case 'new-arrivals':
                    // New arrivals: new badges first, then by year (newest first)
                    sortedTiles = tilesWithData.sort((a, b) => {
                        if (a.hasNewBadge && !b.hasNewBadge) return -1;
                        if (!a.hasNewBadge && b.hasNewBadge) return 1;
                        return b.year - a.year;
                    });
                    break;
                case 'price-lowest':
                    // Price lowest: sort by price ascending
                    sortedTiles = tilesWithData.sort((a, b) => a.price - b.price);
                    break;
                case 'price-highest':
                    // Price highest: sort by price descending
                    sortedTiles = tilesWithData.sort((a, b) => b.price - a.price);
                    break;
                case 'year-newest':
                    // Year newest: sort by year descending
                    sortedTiles = tilesWithData.sort((a, b) => b.year - a.year);
                    break;
                case 'year-oldest':
                    // Year oldest: sort by year ascending
                    sortedTiles = tilesWithData.sort((a, b) => a.year - b.year);
                    break;
                case 'mileage-lowest':
                    // Mileage lowest: sort by mileage ascending
                    sortedTiles = tilesWithData.sort((a, b) => a.mileage - b.mileage);
                    break;
                case 'mileage-highest':
                    // Mileage highest: sort by mileage descending
                    sortedTiles = tilesWithData.sort((a, b) => b.mileage - a.mileage);
                    break;
                case 'distance-nearest':
                default:
                    // Distance nearest: keep original order
                    sortedTiles = tilesWithData;
                    break;
            }
            
            // Reorder the DOM elements
            sortedTiles.forEach(tileData => {
                container.appendChild(tileData.element);
            });
            
            // Re-add badges only if we're currently in a saved search
            const isViewingSavedSearch = sessionStorage.getItem('isViewingSavedSearch') === 'true';
            const selectedSavedSearch = sessionStorage.getItem('selectedSavedSearch');
            if (isViewingSavedSearch && selectedSavedSearch) {
                addNewCarBadgesToTiles(selectedSavedSearch);
            }
        }


        function switchToFiltersTab() {
            // Update tab states
            const filtersTab = document.querySelector('.filter-tab:first-child');
            const mySearchesTab = document.querySelector('.filter-tab:last-child');
            
            if (filtersTab && mySearchesTab) {
                filtersTab.classList.add('active');
                mySearchesTab.classList.remove('active');
            }
            
            // Show/hide content
            const filterOptions = document.getElementById('filterOptionsList');
            const mySearchesContent = document.getElementById('mySearchesContent');
            const filterPillsSection = document.querySelector('.filter-pills-section');
            const filterMenuBottom = document.querySelector('.filter-menu-bottom');
            
            if (filterOptions && mySearchesContent) {
                filterOptions.style.display = 'block';
                mySearchesContent.style.display = 'none';
            }
            
            // Show filter pills and bottom button
            if (filterPillsSection) {
                filterPillsSection.style.display = 'block';
            }
            if (filterMenuBottom) {
                filterMenuBottom.style.display = 'block';
            }
        }

        function switchToMySearchesTab() {
            // Update tab states
            const filtersTab = document.querySelector('.filter-tab:first-child');
            const mySearchesTab = document.querySelector('.filter-tab:last-child');
            
            if (filtersTab && mySearchesTab) {
                filtersTab.classList.remove('active');
                mySearchesTab.classList.add('active');
            }
            
            // Show/hide content
            const filterOptions = document.getElementById('filterOptionsList');
            const mySearchesContent = document.getElementById('mySearchesContent');
            const filterPillsSection = document.querySelector('.filter-pills-section');
            const filterMenuBottom = document.querySelector('.filter-menu-bottom');
            
            if (filterOptions && mySearchesContent) {
                filterOptions.style.display = 'none';
                mySearchesContent.style.display = 'flex';
            }
            
            // Show appropriate My searches content based on sign-in status
            updateMySearchesContent();
            
            // Hide filter pills
            if (filterPillsSection) {
                filterPillsSection.style.display = 'none';
            }
            
            // Hide View results button in My searches tab
            if (filterMenuBottom) {
                filterMenuBottom.style.display = 'none';
            }
        }

        function updateMySearchesContent() {
            const notSignedInContent = document.getElementById('mySearchesNotSignedIn');
            const signedInContent = document.getElementById('mySearchesSignedIn');
            const emptyStateContent = document.getElementById('mySearchesEmptyState');
            
            // Always show signed-in content for this prototype
            if (notSignedInContent) notSignedInContent.style.display = 'none';
            
            // Check if user has any saved searches
            const hasSavedSearches = checkForSavedSearches();
                
            if (hasSavedSearches) {
                if (signedInContent) signedInContent.style.display = 'flex';
                if (emptyStateContent) emptyStateContent.style.display = 'none';
                // Populate saved searches from localStorage
                populateSavedSearches();
                // Initialize saved search card radio button behavior
                initSavedSearchCards();
                
                // Highlight selected saved search if coming from saved-searches page
                const selectedSavedSearch = sessionStorage.getItem('selectedSavedSearch');
                if (selectedSavedSearch) {
                    highlightSelectedSavedSearch(selectedSavedSearch);
                }
            } else {
                if (signedInContent) signedInContent.style.display = 'none';
                if (emptyStateContent) emptyStateContent.style.display = 'flex';
            }
        }
        
        function highlightSelectedSavedSearch(searchName) {
            // First, remove selected class from all cards
            const savedSearchCards = document.querySelectorAll('.saved-search-card');
            savedSearchCards.forEach(card => {
                card.classList.remove('selected');
                const radioButton = card.querySelector('input[type="radio"]');
                if (radioButton) {
                    radioButton.checked = false;
                }
            });
            
            // Then find and highlight only the matching search
            savedSearchCards.forEach(card => {
                const nameElement = card.querySelector('.saved-search-name');
                if (nameElement && nameElement.textContent === searchName) {
                    card.classList.add('selected');
                    const radioButton = card.querySelector('input[type="radio"]');
                    if (radioButton) {
                        radioButton.checked = true;
                    }
                }
            });
        }

        function checkForSavedSearches() {
            const savedSearches = JSON.parse(localStorage.getItem('savedSearches') || '[]');
            return savedSearches.length > 0;
        }

        function getVehicleCount(searchName) {
            // Generate consistent random numbers between 1-9 for each search
            const seed = searchName.split('').reduce((a, b) => a + b.charCodeAt(0), 0);
            const random = (seed * 9301 + 49297) % 233280;
            return Math.floor((random / 233280) * 9) + 1; // 1-9 range
        }

        function addNewCarBadgesToTiles(searchName) {
            // Remove existing badges first
            const existingBadges = document.querySelectorAll('.srp-tile-new-badge');
            existingBadges.forEach(badge => badge.remove());
            
            // Get the vehicle count for this search
            const vehicleCount = getVehicleCount(searchName);
            
            // Get all SRP tiles
            const srpTiles = document.querySelectorAll('.srp-tile');
            
            console.log(`Found ${srpTiles.length} SRP tiles`);
            console.log(`Vehicle count for "${searchName}": ${vehicleCount}`);
            
            // Add badges to the first N tiles (up to the vehicle count)
            const tilesToBadge = Math.min(vehicleCount, srpTiles.length);
            
            for (let i = 0; i < tilesToBadge; i++) {
                const tile = srpTiles[i];
                const tileMeta = tile.querySelector('.tile-meta');
                if (tileMeta) {
                    const badge = document.createElement('div');
                    badge.className = 'srp-tile-new-badge';
                    badge.innerHTML = `
                        <img src="Illustrations/02_Filter/saved-search-car-icon.svg" alt="New" class="srp-tile-new-badge-icon">
                    `;
                    tileMeta.appendChild(badge);
                    console.log(`Added badge to tile ${i + 1}`);
                }
            }
            
            console.log(`Added ${tilesToBadge} new car badges to SRP tiles for "${searchName}"`);
        }

        function populateSavedSearches() {
            const savedSearches = JSON.parse(localStorage.getItem('savedSearches') || '[]');
            const savedSearchesList = document.querySelector('.saved-searches-list');
            
            console.log('Saved searches from localStorage:', savedSearches);
            
            if (!savedSearchesList) return;
            
            // Get current filter state to check which saved search is active
            const currentBodyStyles = JSON.parse(localStorage.getItem('selectedBodyStyles') || '[]');
            const currentPriceRange = JSON.parse(localStorage.getItem('priceRange') || '{"min":"5000","max":"70000"}');
            
            // Clear existing content
            savedSearchesList.innerHTML = '';
            
            // Find the first matching saved search (only one should be active)
            let activeSearchIndex = -1;
            for (let i = 0; i < savedSearches.length; i++) {
                if (isSearchCurrentlyActive(savedSearches[i], currentBodyStyles, currentPriceRange)) {
                    activeSearchIndex = i;
                    break; // Only mark the first match as active
                }
            }
            
            // Create cards for each saved search
            savedSearches.forEach((search, index) => {
                const card = document.createElement('div');
                card.className = 'saved-search-card';
                card.hasClickHandler = false; // Reset the flag for new cards
                
                // Only mark the first matching search as active
                if (index === activeSearchIndex) {
                    card.classList.add('selected');
                }
                
                // Create criteria text from filter data
                let criteriaText = '';
                if (search.bodyStyles.length > 0) {
                    criteriaText += search.bodyStyles.join(', ');
                }
                if (search.priceRange.min !== '5000' || search.priceRange.max !== '70000') {
                    if (criteriaText) criteriaText += ', ';
                    criteriaText += `$${parseInt(search.priceRange.min).toLocaleString()}-$${parseInt(search.priceRange.max).toLocaleString()}`;
                }
                if (!criteriaText) {
                    criteriaText = 'All cars';
                }
                
                // Check if this is a named search (not auto-generated)
                const isNamedSearch = search.name !== criteriaText && 
                                    search.name !== 'Saved Search' && 
                                    !search.name.includes('All cars') &&
                                    (search.name === 'Under $15k for Sally' || 
                                     search.name === 'Dream car' || 
                                     search.name === 'High safety rating' ||
                                     (!search.name.includes('$') && !search.name.match(/\$\d+/)));
                
                let cardHTML = '';
                if (isNamedSearch) {
                    // Named search: show name and criteria
                    cardHTML = `
                        <div class="saved-search-info">
                            <h4 class="saved-search-name">${search.name}</h4>
                            <p class="saved-search-criteria">${criteriaText}</p>
                        </div>
                        <div class="saved-search-status">
                            <div class="car-icon-container">
                                <img src="Illustrations/02_Filter/saved-search-car-icon.svg" alt="Car" class="car-icon">
                            </div>
                            <span class="new-results">${getVehicleCount(search.name)} new</span>
                        </div>
                    `;
                } else {
                    // Unnamed search: show only criteria
                    cardHTML = `
                        <div class="saved-search-info">
                            <h4 class="saved-search-name">${criteriaText}</h4>
                        </div>
                        <div class="saved-search-status">
                            <div class="car-icon-container">
                                <img src="Illustrations/02_Filter/saved-search-car-icon.svg" alt="Car" class="car-icon">
                            </div>
                            <span class="new-results">${getVehicleCount(search.name)} new</span>
                        </div>
                    `;
                }
                
                card.innerHTML = cardHTML;
                
                savedSearchesList.appendChild(card);
            });
        }

        function initSavedSearchCards() {
            const savedSearchesList = document.querySelector('.saved-searches-list');
            if (!savedSearchesList) return;

            const savedSearchCards = document.querySelectorAll('.saved-search-card');
            
            savedSearchCards.forEach((card, index) => {
                card.addEventListener('click', function(event) {
                    // Remove selected class from all cards
                    const allCards = document.querySelectorAll('.saved-search-card');
                    allCards.forEach(c => c.classList.remove('selected'));
                    
                    // Add selected class to clicked card
                    this.classList.add('selected');
                    
                    // Apply the saved search
                    applySavedSearch(index);
                });
            });
        }
        


        function applySavedSearch(searchIndex) {
            const savedSearches = JSON.parse(localStorage.getItem('savedSearches') || '[]');
            if (searchIndex >= savedSearches.length) return;
            
            const search = savedSearches[searchIndex];
            
            // Create filters object from saved search data
            const filters = {};
            
            // Apply body styles
            if (search.bodyStyles && search.bodyStyles.length > 0) {
                const bodyStyleMap = {
                    'Sedan': 'sedan',
                    'Convertible': 'convertible', 
                    'SUV': 'suv',
                    'Coupe': 'coupe',
                    'Hatchback': 'hatchback',
                    'Truck': 'truck',
                    'Wagon': 'wagon',
                    'Minivan': 'minivan'
                };
                const bodyStyle = search.bodyStyles[0]; // Take first body style
                if (bodyStyleMap[bodyStyle]) {
                    filters.bodyStyle = bodyStyleMap[bodyStyle];
                }
            }
            
            // Apply price range
            if (search.priceRange) {
                const minValue = parseInt(search.priceRange.min);
                const maxValue = parseInt(search.priceRange.max);
                
                if (minValue !== 5000 || maxValue !== 70000) {
                    filters.priceMin = minValue;
                    filters.priceMax = maxValue;
                }
            }
            
            // Apply other filters
            if (search.transmission) {
                filters.transmission = search.transmission;
            }
            if (search.fuelType) {
                filters.fuelType = search.fuelType;
            }
            if (search.drivetrain) {
                filters.drivetrain = search.drivetrain;
            }
            if (search.yearMin) {
                filters.yearMin = search.yearMin;
            }
            if (search.make) {
                filters.make = search.make;
            }
            if (search.model) {
                filters.model = search.model;
            }
            
            // Store the filters in sessionStorage
            sessionStorage.setItem('appliedFilters', JSON.stringify(filters));
            sessionStorage.setItem('isViewingSavedSearch', 'true');
            sessionStorage.setItem('selectedSavedSearch', search.name);
            
            // Set sort to "New arrivals" for saved searches (since they have new car badges)
            sessionStorage.setItem('sortBy', 'new-arrivals');
            
            // Update sort menu to show "New arrivals" as selected
            updateSortMenuDisplay('new-arrivals');
            
            // Apply the filters using the existing function
            applySavedSearchFilters(filters);
            
            // Ensure filter pills are updated
            updateFilterPills();
            
            // Add new car badges to SRP tiles based on the count
            addNewCarBadgesToTiles(search.name);
            
            // Apply the sort order (new arrivals for saved searches)
            reorderVehicles('new-arrivals');
            
            // Update the My searches tab to highlight the selected search
            updateMySearchesContent();
            
            // Mark as saved since we're now in a saved search
            isSearchSaved = true;
            updateSaveSearchButton();
            
            // Ensure the saved search state is properly maintained
            checkIfStillInSavedSearch();
            
            console.log('Applied saved search:', search.name);
            console.log('Filters applied:', filters);
        }

        function updateUIForAppliedSearch(bodyStyles, priceRange) {
            // Clear existing body style pills
            const existingBodyPills = document.querySelectorAll('.body-style-pill');
            existingBodyPills.forEach(pill => pill.remove());
            
            // Clear existing price range pills
            const existingPricePills = document.querySelectorAll('.price-range-pill');
            existingPricePills.forEach(pill => pill.remove());
            
            // Add body style pills
            bodyStyles.forEach(styleName => {
                addBodyStylePill(styleName);
            });
            
            // Add price range pill if not default
            if (priceRange.min !== '5000' || priceRange.max !== '70000') {
                createPriceFilterPill(parseInt(priceRange.min), parseInt(priceRange.max));
            }
            
            // Update body style selections in filter menu
            const bodyStyleOptions = document.querySelectorAll('.body-style-option');
            bodyStyleOptions.forEach(option => {
                const styleName = option.querySelector('.body-style-name').textContent;
                if (bodyStyles.includes(styleName)) {
                    option.classList.add('selected');
                } else {
                    option.classList.remove('selected');
                }
            });
            
            // Update price sliders
            const minSlider = document.getElementById('minPriceRange');
            const maxSlider = document.getElementById('maxPriceRange');
            if (minSlider && maxSlider) {
                minSlider.value = priceRange.min;
                maxSlider.value = priceRange.max;
                
                // Update price inputs
                const minInput = document.getElementById('minPrice');
                const maxInput = document.getElementById('maxPrice');
                if (minInput && maxInput) {
                    minInput.value = `$${parseInt(priceRange.min).toLocaleString()}`;
                    maxInput.value = `$${parseInt(priceRange.max).toLocaleString()}`;
                }
                
                // Update slider UI
                if (typeof updateThumbsAndRange === 'function') {
                    updateThumbsAndRange();
                }
            }
        }

        // Body Style Filter Functions
        function openBodyStyleFilter() {
            console.log('Opening body style filter');
            const overlay = document.getElementById('bodyStyleOverlay');
            if (overlay) {
                overlay.style.display = 'block';
                // Prevent background scrolling
                document.body.style.overflow = 'hidden';
                setTimeout(() => {
                    overlay.classList.add('show');
                }, 10);
            }
        }

        function closeBodyStyleFilter() {
            console.log('Closing body style filter');
            const overlay = document.getElementById('bodyStyleOverlay');
            if (overlay) {
                overlay.classList.remove('show');
                setTimeout(() => {
                    overlay.style.display = 'none';
                }, 300);
            }
        }

        function selectBodyStyle(styleName, count) {
            console.log('Selected body style:', styleName, 'Count:', count);
            
            // Clear saved search state when filters are modified
            clearSavedSearchState();
            
            // Toggle selection state
            const option = event.currentTarget;
            const isSelected = option.classList.contains('selected');
            
            if (isSelected) {
                // Deselect
                option.classList.remove('selected');
                removeBodyStylePill(styleName);
            } else {
                // Select (body styles can have multiple selections)
                option.classList.add('selected');
                addBodyStylePill(styleName);
            }
            
            // Update localStorage with current body style selections
            const selectedBodyStyles = Array.from(document.querySelectorAll('.body-style-option.selected'))
                .map(option => option.querySelector('.body-style-name').textContent);
            localStorage.setItem('selectedBodyStyles', JSON.stringify(selectedBodyStyles));
            
            // Check if we're still in a saved search after changing this filter
            checkIfStillInSavedSearch();
            
            // Update parent filter bold state
            updateParentFilterBoldState();
        }

        function addBodyStylePill(styleName) {
            // Add to main SRP filter pills
            addBodyStylePillToContainer('.filter-pills .filter-pills-row', styleName);
            
            // Add to filter menu pills
            addBodyStylePillToContainer('.filter-pills-section .filter-pills-row', styleName);
        }

        function addBodyStylePillToContainer(containerSelector, styleName) {
            const container = document.querySelector(containerSelector);
            if (!container) return;

            // Check if pill already exists
            const existingPill = container.querySelector(`[data-body-style="${styleName}"]`);
            if (existingPill) return;

            // Create new pill
            const pill = document.createElement('div');
            pill.className = 'filter-pill body-style-pill';
            pill.setAttribute('data-body-style', styleName);
            pill.innerHTML = `
                <span class="filter-pill-text">${styleName}</span>
                <img src="Illustrations/04_UI/x.svg" alt="Remove" class="filter-pill-close" onclick="event.stopPropagation(); removeBodyStylePill('${styleName}');">
            `;

            // Add to the row container
            container.appendChild(pill);
        }

        function removeBodyStylePill(styleName) {
            // Remove from both containers
            const pills = document.querySelectorAll(`[data-body-style="${styleName}"]`);
            pills.forEach(pill => pill.remove());

            // Deselect in body style filter
            const bodyStyleOption = document.querySelector(`[onclick*="selectBodyStyle('${styleName}'"]`);
            if (bodyStyleOption) {
                bodyStyleOption.classList.remove('selected');
            }

            // Update localStorage with current body style selections
            const selectedBodyStyles = Array.from(document.querySelectorAll('.body-style-option.selected'))
                .map(option => option.querySelector('.body-style-name').textContent);
            localStorage.setItem('selectedBodyStyles', JSON.stringify(selectedBodyStyles));

            // Update parent filter bold state
            updateParentFilterBoldState();
            
            // Check if we're still in a saved search after removing this filter
            checkIfStillInSavedSearch();
        }

        function updateParentFilterBoldState() {
            // Check if any body styles are selected
            const selectedBodyStyles = document.querySelectorAll('.body-style-option.selected');
            const bodyStyleParent = document.querySelector('.filter-option[onclick="openBodyStyleFilter()"] .filter-option-text');
            
            if (selectedBodyStyles.length > 0) {
                bodyStyleParent.style.fontWeight = 'bold';
            } else {
                bodyStyleParent.style.fontWeight = 'normal';
            }
        }

        // Price & Payment Filter Functions
        function openPricePaymentFilter() {
            console.log('Opening price & payment filter');
            const overlay = document.getElementById('pricePaymentOverlay');
            if (overlay) {
                overlay.style.display = 'block';
                setTimeout(() => {
                    overlay.classList.add('show');
                }, 10);
            }
        }

        function closePricePaymentFilter() {
            console.log('Closing price & payment filter');
            const overlay = document.getElementById('pricePaymentOverlay');
            if (overlay) {
                overlay.classList.remove('show');
                setTimeout(() => {
                    overlay.style.display = 'none';
                }, 300);
            }
        }


        // Initialize price/payment filter interactions
        function initPricePaymentFilter() {
            const minPriceInput = document.getElementById('minPrice');
            const maxPriceInput = document.getElementById('maxPrice');
            const minPriceRange = document.getElementById('minPriceRange');
            const maxPriceRange = document.getElementById('maxPriceRange');
            const rangeBar = document.getElementById('rangeBar');
            const minThumb = document.getElementById('minThumb');
            const maxThumb = document.getElementById('maxThumb');
            const sliderWrapper = document.querySelector('.range-slider-wrapper');
            
            if (!minPriceInput || !maxPriceInput || !minPriceRange || !maxPriceRange || !rangeBar || !minThumb || !maxThumb || !sliderWrapper) return;

            // Initialize sliders with localStorage values if they exist
            const savedPriceRange = JSON.parse(localStorage.getItem('priceRange') || '{"min":"5000","max":"70000"}');
            minPriceRange.value = savedPriceRange.min;
            maxPriceRange.value = savedPriceRange.max;

            // Format number to currency
            function formatCurrency(value) {
                return '$' + parseInt(value).toLocaleString();
            }

            // Parse currency to number
            function parseCurrency(value) {
                return parseInt(value.replace(/[$,]/g, ''));
            }

            // Update thumb positions and range bar (visual only, no pill updates)
            function updateThumbsAndRangeVisuals() {
                const minValue = parseInt(minPriceRange.value);
                const maxValue = parseInt(maxPriceRange.value);
                const min = parseInt(minPriceRange.min);
                const max = parseInt(minPriceRange.max);
                
                const minPercent = ((minValue - min) / (max - min)) * 100;
                const maxPercent = ((maxValue - min) / (max - min)) * 100;
                
                // Update thumb positions
                minThumb.style.left = `calc(${minPercent}% - 12px)`;
                maxThumb.style.left = `calc(${maxPercent}% - 12px)`;
                
                // Update range bar
                rangeBar.style.left = minPercent + '%';
                rangeBar.style.width = (maxPercent - minPercent) + '%';
            }

            // Update thumb positions and range bar
            function updateThumbsAndRange() {
                const minValue = parseInt(minPriceRange.value);
                const maxValue = parseInt(maxPriceRange.value);
                const min = parseInt(minPriceRange.min);
                const max = parseInt(minPriceRange.max);
                
                const minPercent = ((minValue - min) / (max - min)) * 100;
                const maxPercent = ((maxValue - min) / (max - min)) * 100;
                
                // Update thumb positions
                minThumb.style.left = `calc(${minPercent}% - 12px)`;
                maxThumb.style.left = `calc(${maxPercent}% - 12px)`;
                
                // Update range bar
                rangeBar.style.left = minPercent + '%';
                rangeBar.style.width = (maxPercent - minPercent) + '%';
                
                // Update price filter pill with actual slider values
                updatePriceFilterPill(minValue, maxValue);
                
                // Update localStorage with current price range
                localStorage.setItem('priceRange', JSON.stringify({ min: minValue.toString(), max: maxValue.toString() }));
                
                // Check if we're still in a saved search after changing price range
                checkIfStillInSavedSearch();
            }

            // Update price filter pill
            function updatePriceFilterPill(minValue, maxValue) {
                const defaultMin = 5000;
                const defaultMax = 70000;
                
                // Check if sliders are at default position
                const isAtDefault = (minValue === defaultMin && maxValue === defaultMax);
                
                if (isAtDefault) {
                    // Remove price filter pill if at default
                    removePriceFilterPill();
                } else {
                    // Add or update price filter pill with actual values
                    addPriceFilterPill(minValue, maxValue);
                }
            }

            // Add or update price filter pill
            function addPriceFilterPill(minValue, maxValue) {
                const minFormatted = formatCurrency(minValue);
                const maxFormatted = formatCurrency(maxValue);
                const pillText = `${minFormatted}${maxFormatted}`;
                
                // Update all existing price pills
                const existingPills = document.querySelectorAll('.price-range-pill');
                existingPills.forEach(pill => {
                    const textElement = pill.querySelector('.filter-pill-text');
                    if (textElement) {
                        textElement.textContent = pillText;
                    }
                });
                
                // If no pills exist, create them
                if (existingPills.length === 0) {
                    // Create new pill
                    const pill = document.createElement('div');
                    pill.className = 'filter-pill price-range-pill';
                    pill.innerHTML = `
                        <span class="filter-pill-text">${pillText}</span>
                        <img src="Illustrations/04_UI/x.svg" alt="Remove" class="filter-pill-close" onclick="event.stopPropagation(); removePriceFilterPill();">
                    `;
                    
                    // Add to both main SRP and filter menu
                    addPricePillToContainer(pill, '.filter-pills .filter-pills-row');
                    addPricePillToContainer(pill.cloneNode(true), '.filter-pills-section .filter-pills-row');
                }
            }

            // Add price pill to specific container
            function addPricePillToContainer(pill, selector) {
                const container = document.querySelector(selector);
                if (container) {
                    // Insert after location pill (check both possible location pill classes)
                    const locationPill = container.querySelector('.location-pill') || container.querySelector('.permanent-filter-pill');
                    if (locationPill) {
                        locationPill.insertAdjacentElement('afterend', pill);
                    } else {
                        container.appendChild(pill);
                    }
                }
            }

            // Remove price filter pill
            function removePriceFilterPill() {
                const pills = document.querySelectorAll('.price-range-pill');
                pills.forEach(pill => pill.remove());
            }

            // Handle thumb dragging
            function makeDraggable(thumb, slider, input, isMin) {
                let isDragging = false;
                
                function startDrag(e) {
                    isDragging = true;
                    e.preventDefault();
                    e.stopPropagation();
                    thumb.style.cursor = 'grabbing';
                    
                    // Temporarily disable native slider events to prevent loops
                    slider.style.pointerEvents = 'none';
                }
                
                function drag(e) {
                    if (!isDragging) return;
                    
                    const rect = sliderWrapper.getBoundingClientRect();
                    const clientX = e.clientX || (e.touches && e.touches[0].clientX);
                    const x = clientX - rect.left;
                    const width = rect.width;
                    const percent = Math.max(0, Math.min(100, (x / width) * 100));
                    
                    const min = parseInt(slider.min);
                    const max = parseInt(slider.max);
                    const value = Math.round((percent / 100) * (max - min) / 1000) * 1000;
                    
                    const otherSlider = isMin ? maxPriceRange : minPriceRange;
                    const otherInput = isMin ? maxPriceInput : minPriceInput;
                    const otherValue = parseInt(otherSlider.value);
                    const minStep = 1000; // Minimum step size
                    
                    if (isMin) {
                        // Dragging min thumb
                        if (value >= otherValue) {
                            // Min is trying to go past max, adjust max to min + step
                            const newMaxValue = value + minStep;
                            if (newMaxValue <= max) {
                                otherSlider.value = newMaxValue;
                                otherInput.value = formatCurrency(newMaxValue);
                            }
                        }
                        slider.value = value;
                        input.value = formatCurrency(value);
                    } else {
                        // Dragging max thumb
                        if (value <= otherValue) {
                            // Max is trying to go past min, adjust min to max - step
                            const newMinValue = value - minStep;
                            if (newMinValue >= min) {
                                otherSlider.value = newMinValue;
                                otherInput.value = formatCurrency(newMinValue);
                            }
                        }
                        slider.value = value;
                        input.value = formatCurrency(value);
                    }
                    
                    // Only update visual elements during drag, not the pill
                    updateThumbsAndRangeVisuals();
                }
                
                function endDrag() {
                    isDragging = false;
                    thumb.style.cursor = 'pointer';
                    
                    // Re-enable native slider events
                    slider.style.pointerEvents = 'auto';
                    
                    // Update the pill when drag ends
                    updateThumbsAndRange();
                }
                
                // Mouse events
                thumb.addEventListener('mousedown', startDrag);
                document.addEventListener('mousemove', drag);
                document.addEventListener('mouseup', endDrag);
                
                // Touch events
                thumb.addEventListener('touchstart', startDrag);
                document.addEventListener('touchmove', drag);
                document.addEventListener('touchend', endDrag);
            }


            // Initialize dragging for both thumbs
            makeDraggable(minThumb, minPriceRange, minPriceInput, true);
            makeDraggable(maxThumb, maxPriceRange, maxPriceInput, false);

            // Handle input changes
            minPriceInput.addEventListener('input', function() {
                const value = parseCurrency(this.value);
                if (!isNaN(value)) {
                    const maxValue = parseInt(maxPriceRange.value);
                    if (value < maxValue) {
                        minPriceRange.value = value;
                        updateThumbsAndRange();
                    }
                }
            });

            maxPriceInput.addEventListener('input', function() {
                const value = parseCurrency(this.value);
                if (!isNaN(value)) {
                    const minValue = parseInt(minPriceRange.value);
                    if (value > minValue) {
                        maxPriceRange.value = value;
                        updateThumbsAndRange();
                    }
                }
            });

            // Format inputs on blur
            minPriceInput.addEventListener('blur', function() {
                const value = parseCurrency(this.value);
                if (!isNaN(value)) {
                    this.value = formatCurrency(value);
                }
            });

            maxPriceInput.addEventListener('blur', function() {
                const value = parseCurrency(this.value);
                if (!isNaN(value)) {
                    this.value = formatCurrency(value);
                }
            });

            // Initialize thumb positions and range bar
            updateThumbsAndRange();

            // Add click handler for price range pills
            document.addEventListener('click', function(e) {
                if (e.target.closest('.price-range-pill')) {
                    // Close any open filter menu and open price filter
                    closeFilterMenu();
                    setTimeout(() => {
                        openPricePaymentFilter();
                    }, 100);
                }
            });
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initPricePaymentFilter();
        });


        function restoreFilterState() {
            // Restore selected body styles
            const savedBodyStyles = JSON.parse(localStorage.getItem('selectedBodyStyles') || '[]');
            if (savedBodyStyles.length > 0) {
                savedBodyStyles.forEach(styleName => {
                    addBodyStylePill(styleName);
                });
            }
            
            // Restore price range
            const savedPriceRange = JSON.parse(localStorage.getItem('priceRange') || '{"min":"5000","max":"70000"}');
            const minValue = parseInt(savedPriceRange.min);
            const maxValue = parseInt(savedPriceRange.max);
            
            // Check if price range is different from default
            if (minValue !== 5000 || maxValue !== 70000) {
                // Create price filter pill directly
                createPriceFilterPill(minValue, maxValue);
            }
        }

        // Global function to create price filter pill
        function createPriceFilterPill(minValue, maxValue) {
            const minFormatted = '$' + parseInt(minValue).toLocaleString();
            const maxFormatted = '$' + parseInt(maxValue).toLocaleString();
            const pillText = `${minFormatted}${maxFormatted}`;
            
            // Add to main SRP filter pills
            addPriceFilterPillToContainer('.filter-pills .filter-pills-row', minValue, maxValue, pillText);
            
            // Add to filter menu pills
            addPriceFilterPillToContainer('.filter-pills-section .filter-pills-row', minValue, maxValue, pillText);
        }
        
        function addPriceFilterPillToContainer(containerSelector, minValue, maxValue, pillText) {
            const container = document.querySelector(containerSelector);
            if (!container) return;

            // Check if pill already exists
            const existingPill = container.querySelector('.price-range-pill');
            if (existingPill) return;

            // Create new pill
            const pill = document.createElement('div');
            pill.className = 'filter-pill price-range-pill';
            pill.innerHTML = `
                <span class="filter-pill-text">${pillText}</span>
                <img src="Illustrations/04_UI/x.svg" alt="Remove" class="filter-pill-close" onclick="event.stopPropagation(); removePriceFilterPill();">
            `;

            // Add to the row container
            container.appendChild(pill);
        }

        // Global function to add price pill to container
        function addPricePillToContainer(pill, selector) {
            const container = document.querySelector(selector);
            if (container) {
                // Insert after location pill (check both possible location pill classes)
                const locationPill = container.querySelector('.location-pill') || container.querySelector('.permanent-filter-pill');
                if (locationPill) {
                    locationPill.insertAdjacentElement('afterend', pill);
                } else {
                    container.appendChild(pill);
                }
            }
        }

        function clearFilterState() {
            // Clear saved filter state
            localStorage.removeItem('selectedBodyStyles');
            localStorage.removeItem('priceRange');
        }

        function resetAllFilters() {
            // Clear saved search state from sessionStorage
            sessionStorage.removeItem('isViewingSavedSearch');
            sessionStorage.removeItem('selectedSavedSearch');
            sessionStorage.removeItem('appliedFilters');
            
            // Clear saved search state
            isSearchSaved = false;
            
            // Remove all filter pills (including removable ones)
            const allPills = document.querySelectorAll('.body-style-pill, .price-range-pill, .filter-pill.removable');
            allPills.forEach(pill => pill.remove());
            
            // Clear localStorage
            clearFilterState();
            
            // Reset body style selections
            const bodyStyleOptions = document.querySelectorAll('.body-style-option');
            bodyStyleOptions.forEach(option => option.classList.remove('selected'));
            
            // Reset price sliders to default
            const minSlider = document.getElementById('minPriceRange');
            const maxSlider = document.getElementById('maxPriceRange');
            if (minSlider && maxSlider) {
                minSlider.value = '5000';
                maxSlider.value = '70000';
            }
            
            // Reset price inputs to default
            const minInput = document.getElementById('minPrice');
            const maxInput = document.getElementById('maxPrice');
            if (minInput && maxInput) {
                minInput.value = '$5,000';
                maxInput.value = '$70,000';
            }
            
            // Update price filter UI if it's open
            if (typeof updateThumbsAndRange === 'function') {
                updateThumbsAndRange();
            }
            
            // Update save search button
            updateSaveSearchButton();
            
            // Update My searches content if it's open
            updateMySearchesContent();
            
            // Clear any new car badges from SRP tiles
            const badges = document.querySelectorAll('.srp-tile-new-badge');
            badges.forEach(badge => badge.remove());
        }

        function removePriceFilterPill() {
            // Remove all price range pills
            const pills = document.querySelectorAll('.price-range-pill');
            pills.forEach(pill => pill.remove());
            
            // Reset sliders to default
            const minSlider = document.getElementById('minPriceRange');
            const maxSlider = document.getElementById('maxPriceRange');
            if (minSlider && maxSlider) {
                minSlider.value = '5000';
                maxSlider.value = '70000';
            }
            
            // Update localStorage with default price range
            localStorage.setItem('priceRange', JSON.stringify({ min: '5000', max: '70000' }));
            
            // Check if we're still in a saved search after removing this filter
            checkIfStillInSavedSearch();
        }

        function checkIfStillInSavedSearch() {
            // Check if we're currently viewing a saved search from sessionStorage
            const isViewingSavedSearch = sessionStorage.getItem('isViewingSavedSearch') === 'true';
            const selectedSavedSearch = sessionStorage.getItem('selectedSavedSearch');
            const appliedFilters = sessionStorage.getItem('appliedFilters');
            
            const wasSearchSaved = isSearchSaved;
            
            if (isViewingSavedSearch && selectedSavedSearch && appliedFilters) {
                // Currently viewing a saved search
                isSearchSaved = true;
                
                // Set sort to "New arrivals" for saved searches
                sessionStorage.setItem('sortBy', 'new-arrivals');
                updateSortMenuDisplay('new-arrivals');
                
                // Apply the saved search filters
                try {
                    const filters = JSON.parse(appliedFilters);
                    applySavedSearchFilters(filters);
                    
                    // Update filter pills to show the applied filters
                    updateFilterPills();
                    
                    // Add new car badges to SRP tiles
                    addNewCarBadgesToTiles(selectedSavedSearch);
                } catch (e) {
                    console.error('Error applying saved search filters:', e);
                }
            } else {
                // Not viewing a saved search
                isSearchSaved = false;
                
                // Clear any existing new car badges
                const existingBadges = document.querySelectorAll('.srp-tile-new-badge');
                existingBadges.forEach(badge => badge.remove());
            }
            
            // Only update button if state actually changed
            if (wasSearchSaved !== isSearchSaved) {
                updateSaveSearchButton();
            }
            
            // Always update My searches content to reflect current active state
            updateMySearchesContent();
        }

        function openSignInFromMySearches() {
            // Open sign-in modal but keep "My searches" tab active
            openSignIn();
        }

        function openAccountCreationFromMySearches() {
            console.log('Create account clicked from My searches');
            // Open sign-in modal first, then switch to account creation
            openSignIn();
            // Small delay to ensure modal is open before switching content
            setTimeout(() => {
                console.log('Switching to account creation content');
                showAccountConfirmation();
            }, 100);
        }

        function handleSaveSearch() {
            console.log('=== SAVE SEARCH CLICKED ===');
            console.log('isSignedIn:', isSignedIn);
            console.log('Current isSearchSaved:', isSearchSaved);
            
            if (!isSignedIn) {
                console.log('Showing toast for non-signed-in user');
                showSaveSearchToast();
            } else {
                console.log('User is signed in, toggling search saved');
                
                // Check if this is from account creation (localStorage flag)
                const fromAccountCreation = localStorage.getItem('showAlertToast') === 'true';
                
                // Check conditions BEFORE toggling the search saved state
                const shouldShowToast = (!isSearchSaved && !alertsEnabled && !hasShownAlertToast) || fromAccountCreation;
                console.log('Should show signed-in toast:', shouldShowToast, 'fromAccountCreation:', fromAccountCreation);
                
                // Toggle the search saved state
                console.log('Calling toggleSearchSaved()...');
                toggleSearchSaved();
                console.log('After toggleSearchSaved(), isSearchSaved:', isSearchSaved);
                
                // Show signed-in toast if first time saving and alerts not enabled OR from account creation
                if (shouldShowToast) {
                    console.log('Showing signed-in first-time toast');
                    showSignedInToast();
                    hasShownAlertToast = true; // Mark that we've shown the alert toast
                    localStorage.setItem('hasShownAlertToast', 'true');
                    localStorage.removeItem('showAlertToast'); // Clear the flag
                } else {
                    console.log('Not showing signed-in toast - conditions not met');
                    
                    // Only show name search overlay if:
                    // 1. User has already seen alert toast OR has alerts enabled
                    // 2. AND the search is actually being saved (not unsaved)
                    console.log('Checking name search conditions - alertsEnabled:', alertsEnabled, 'hasShownAlertToast:', hasShownAlertToast, 'isSearchSaved:', isSearchSaved);
                    if ((alertsEnabled || hasShownAlertToast) && isSearchSaved) {
                        console.log('Showing name search overlay');
                        showNameSearchOverlay();
                    } else {
                        console.log('Not showing name search overlay - conditions not met');
                    }
                }
            }
            console.log('=== END SAVE SEARCH ===');
        }

        // Generic toast system
        function showToast(config) {
            const overlay = document.getElementById('toastOverlay');
            const toast = document.getElementById('toast');
            
            if (overlay && toast) {
                // Update toast content based on config
                updateToastContent(toast, config);
                
                // Add alert-toast class if this is an alert toast
                if (config.isAlert) {
                    toast.classList.add('alert-toast');
                } else {
                    toast.classList.remove('alert-toast');
                }
                
                // Show toast
                overlay.style.display = 'block';
                toast.style.display = 'block';
                toast.classList.add('show');
                
                // Add click listener for outside clicks with a small delay
                setTimeout(() => {
                    document.addEventListener('click', handleOutsideClick);
                }, 100);
                
                console.log('Toast shown:', config.type);
            } else {
                console.error('Toast elements not found!');
            }
        }

        function handleOutsideClick(event) {
            const toast = document.getElementById('toast');
            const closeButton = toast.querySelector('.toast-close');
            
            // Check if click is outside the toast and not on the close button
            if (!toast.contains(event.target) && event.target !== closeButton) {
                closeToast();
            }
        }

        function updateToastContent(toast, config) {
            const icon = toast.querySelector('.toast-icon');
            const text = toast.querySelector('.toast-text');
            const link = toast.querySelector('.toast-link');
            
            // Update icon
            if (icon && config.icon) {
                icon.src = config.icon;
                icon.alt = config.iconAlt || 'Info';
            }
            
            // Update text content
            if (text) {
                text.innerHTML = config.text;
            }
            
            // Update link if provided
            if (link && config.link) {
                link.textContent = config.link.text;
                link.href = config.link.href || '#';
                link.onclick = config.link.onclick || null;
                link.style.display = config.link.text ? 'inline' : 'none';
            }
        }

        function showSaveSearchToast() {
            const config = {
                type: 'save-search',
                icon: 'Illustrations/Toast icons/info.svg',
                iconAlt: 'Info',
                text: 'Get notified when new cars match your search. <a href="#" class="toast-link" onclick="openSignIn()">Sign in or create an account</a>',
                link: {
                    text: 'Sign in or create an account',
                    href: '#',
                    onclick: 'openSignIn()'
                }
            };
            showToast(config);
        }

        // Example: Alert notification toast
        function showAlertToast() {
            const config = {
                type: 'alert',
                icon: 'Illustrations/Toast icons/Notification.svg',
                iconAlt: 'Notification',
                text: 'Turn on alerts to get notified when new cars match your search.',
                link: {
                    text: 'Turn on alerts',
                    href: '#',
                    onclick: 'toggleAlerts()'
                }
            };
            showToast(config);
        }

        // Signed-in first time save toast
        function showSignedInToast() {
            console.log('showSignedInToast called');
            const config = {
                type: 'signed-in-first-time',
                icon: 'Illustrations/Toast icons/Notification.svg',
                iconAlt: 'Notification',
                text: 'Get notified when new cars match your search. <a href="#" class="toast-link" onclick="toggleAlerts(event)">Turn on alerts</a>',
                link: {
                    text: 'Turn on alerts',
                    href: '#',
                    onclick: 'toggleAlerts()'
                },
                isAlert: true
            };
            console.log('Calling showToast with config:', config);
            showToast(config);
        }

        // Example: Success toast
        function showSuccessToast() {
            const config = {
                type: 'success',
                icon: 'Illustrations/Toast icons/info.svg',
                iconAlt: 'Success',
                text: 'Search saved successfully!',
                link: {
                    text: '',
                    href: '',
                    onclick: null
                }
            };
            showToast(config);
        }

        // Example: Error toast
        function showErrorToast() {
            const config = {
                type: 'error',
                icon: 'Illustrations/Toast icons/info.svg',
                iconAlt: 'Error',
                text: 'Something went wrong. Please try again.',
                link: {
                    text: '',
                    href: '',
                    onclick: null
                }
            };
            showToast(config);
        }

        function closeToast() {
            const toast = document.getElementById('toast');
            const overlay = document.getElementById('toastOverlay');
            
            // Remove click listener
            document.removeEventListener('click', handleOutsideClick);
            
            // Add hide class for slide-out animation
            toast.classList.remove('show');
            toast.classList.add('hide');
            
            // Hide elements after animation completes
            setTimeout(() => {
                overlay.style.display = 'none';
                toast.style.display = 'none';
                toast.classList.remove('hide');
            }, 300); // Match animation duration
        }

        // Name Search Overlay Functions
        function showNameSearchOverlay() {
            console.log('showNameSearchOverlay called');
            const overlay = document.getElementById('nameSearchOverlay');
            console.log('Overlay element:', overlay);
            if (overlay) {
                overlay.style.display = 'block';
                console.log('Overlay should now be visible');
                
                // Prepopulate with selected filters
                populateSearchName();
                
                // Initialize text field states
                initNameSearchTextFieldStates();
                
                // Add scroll listener after delay to prevent immediate closure
                setTimeout(() => {
                    console.log('Adding scroll listener after delay');
                    // Add test scroll listener first
                    window.addEventListener('scroll', testScroll);
                    // Try multiple scroll targets
                    window.addEventListener('scroll', handleScroll);
                    document.addEventListener('scroll', handleScroll);
                    const mobileContainer = document.querySelector('.mobile-container');
                    if (mobileContainer) {
                        mobileContainer.addEventListener('scroll', handleScroll);
                    }
                    document.addEventListener('click', handleNameSearchOutsideClick);
                }, 500); // Longer delay to ensure drawer is fully visible
            } else {
                console.log('Overlay element not found!');
            }
        }

        function populateSearchName() {
            const input = document.getElementById('searchNameInput');
            if (!input) return;
            
            // Get actual filter data from localStorage
            const bodyStyles = JSON.parse(localStorage.getItem('selectedBodyStyles') || '[]');
            const priceRange = JSON.parse(localStorage.getItem('priceRange') || '{"min":"5000","max":"70000"}');
            
            // Check if there's a previously used custom name for this filter combination
            const previouslyUsedName = getPreviouslyUsedName(bodyStyles, priceRange);
            
            let searchName = '';
            
            if (previouslyUsedName) {
                // Use the previously used custom name
                searchName = previouslyUsedName;
            } else {
                // Create descriptive name from filter data
                if (bodyStyles.length > 0) {
                    searchName += bodyStyles.join(', ');
                }
                if (priceRange.min !== '5000' || priceRange.max !== '70000') {
                    if (searchName) searchName += ', ';
                    searchName += `$${parseInt(priceRange.min).toLocaleString()}-$${parseInt(priceRange.max).toLocaleString()}`;
                }
                
                // Fallback to permanent filter if no other filters selected
                if (!searchName) {
                    const permanentFilter = document.querySelector('.permanent-filter .filter-description')?.textContent?.trim();
                    if (permanentFilter) {
                        searchName = permanentFilter;
                    }
                }
            }
            
            // Set the input value and trigger filled state
            input.value = searchName;
            const inputGroup = document.querySelector('.name-search-input-group');
            if (inputGroup && searchName) {
                inputGroup.setAttribute('data-state', 'filled');
            }
            
            console.log('Populated search name:', searchName);
        }
        
        function getPreviouslyUsedName(bodyStyles, priceRange) {
            // Get the previously used names from localStorage
            const previouslyUsedNames = JSON.parse(localStorage.getItem('previouslyUsedNames') || '{}');
            
            // Create a key for this filter combination
            const filterKey = JSON.stringify({
                bodyStyles: bodyStyles.sort(),
                priceRange: priceRange
            });
            
            return previouslyUsedNames[filterKey] || null;
        }
        
        function savePreviouslyUsedName(bodyStyles, priceRange, customName) {
            // Get existing previously used names
            const previouslyUsedNames = JSON.parse(localStorage.getItem('previouslyUsedNames') || '{}');
            
            // Create a key for this filter combination
            const filterKey = JSON.stringify({
                bodyStyles: bodyStyles.sort(),
                priceRange: priceRange
            });
            
            // Store the custom name for this filter combination
            previouslyUsedNames[filterKey] = customName;
            
            // Save back to localStorage
            localStorage.setItem('previouslyUsedNames', JSON.stringify(previouslyUsedNames));
        }

        function closeNameSearch() {
            console.log('closeNameSearch called');
            const overlay = document.getElementById('nameSearchOverlay');
            const modal = document.getElementById('nameSearchModal');
            if (overlay && modal) {
                console.log('Starting slide-up animation');
                
                // Add slide-up animation class
                modal.classList.add('slide-up');
                
                // Hide overlay after animation completes
                setTimeout(() => {
                    overlay.style.display = 'none';
                    modal.classList.remove('slide-up');
                    console.log('Overlay hidden');
                }, 300); // Match animation duration
                
                // Remove event listeners
                window.removeEventListener('scroll', handleScroll);
                document.removeEventListener('scroll', handleScroll);
                const mobileContainer = document.querySelector('.mobile-container');
                if (mobileContainer) {
                    mobileContainer.removeEventListener('scroll', handleScroll);
                }
                document.removeEventListener('click', handleNameSearchOutsideClick);
                console.log('Event listeners removed');
            } else {
                console.log('Overlay or modal not found in closeNameSearch');
            }
        }

        function saveNamedSearch() {
            const searchName = document.getElementById('searchNameInput').value;
            if (searchName.trim()) {
                console.log('Saving search with name:', searchName);
                
                // Get current filter state
                const currentBodyStyles = JSON.parse(localStorage.getItem('selectedBodyStyles') || '[]');
                const currentPriceRange = JSON.parse(localStorage.getItem('priceRange') || '{"min":"5000","max":"70000"}');
                
                // Check if this search already exists
                const savedSearches = JSON.parse(localStorage.getItem('savedSearches') || '[]');
                const existingSearch = findMatchingSearch(currentBodyStyles, currentPriceRange, savedSearches);
                
                if (existingSearch) {
                    // Update existing search with new name
                    console.log('Updating existing search with new name');
                    existingSearch.name = searchName;
                    existingSearch.timestamp = Date.now();
                } else {
                    // Create new search
                    console.log('Creating new search');
                    const currentFilters = {
                        name: searchName,
                        bodyStyles: currentBodyStyles,
                        priceRange: currentPriceRange,
                        timestamp: Date.now()
                    };
                    savedSearches.push(currentFilters);
                }
                
                localStorage.setItem('savedSearches', JSON.stringify(savedSearches));
                
                // Save the custom name for this filter combination
                savePreviouslyUsedName(currentBodyStyles, currentPriceRange, searchName);
                
                // Update the save search button text to show the saved name
                const saveSearchText = document.querySelector('.save-search-text');
                if (saveSearchText) {
                    saveSearchText.textContent = searchName;
                }
                
                // Close the drawer
                closeNameSearch();
                
                // Update My searches content if it's currently visible
                updateMySearchesContent();
                
                // Show success feedback (optional)
                console.log('Search saved as: ' + searchName);
            } else {
                alert('Please enter a search name');
            }
        }

        function initNameSearchTextFieldStates() {
            const inputGroup = document.querySelector('.name-search-input-group');
            const input = document.getElementById('searchNameInput');
            
            if (!inputGroup || !input) return;
            
            // Focus event
            input.addEventListener('focus', function() {
                inputGroup.setAttribute('data-state', 'focus');
            });
            
            // Blur event
            input.addEventListener('blur', function() {
                if (input.value.trim()) {
                    inputGroup.setAttribute('data-state', 'filled');
                } else {
                    inputGroup.setAttribute('data-state', 'default');
                }
            });
            
            // Input event
            input.addEventListener('input', function() {
                if (input.value.trim()) {
                    inputGroup.setAttribute('data-state', 'filled');
                } else {
                    inputGroup.setAttribute('data-state', 'focus');
                }
            });
        }

        function manageAlerts() {
            console.log('Manage alerts clicked');
            // Here you would typically navigate to alerts management
        }

        // Event handlers for name search drawer
        function handleNameSearchScroll() {
            console.log('Scroll detected, closing name search drawer');
            const overlay = document.getElementById('nameSearchOverlay');
            console.log('Overlay display style:', overlay ? overlay.style.display : 'overlay not found');
            if (overlay && overlay.style.display === 'block') {
                console.log('Closing drawer due to scroll');
                closeNameSearch();
            } else {
                console.log('Drawer not visible, not closing');
            }
        }

        // Simple scroll handler
        function handleScroll() {
            console.log('SCROLL DETECTED - CLOSING DRAWER');
            closeNameSearch();
        }

        // Test scroll handler - just to see if scroll events work at all
        function testScroll() {
            console.log('TEST SCROLL EVENT FIRED');
        }

        function handleNameSearchOutsideClick(event) {
            const overlay = document.getElementById('nameSearchOverlay');
            const modal = document.getElementById('nameSearchModal');
            
            // Check if click is outside the modal
            if (overlay && modal && !modal.contains(event.target)) {
                console.log('Click outside name search drawer, closing');
                closeNameSearch();
            }
        }

        function toggleSearchSaved() {
            console.log('toggleSearchSaved called, current isSearchSaved:', isSearchSaved);
            
            if (isSearchSaved) {
                // Currently saved, so unsave it
                console.log('Unsaving search');
                isSearchSaved = false;
                removeCurrentSearch();
            } else {
                // Currently not saved, so save it
                console.log('Saving search');
                isSearchSaved = true;
                saveCurrentSearch();
            }
            
            console.log('After toggle, isSearchSaved:', isSearchSaved);
            updateSaveSearchButton();
        }

        function saveCurrentSearch() {
            // Get current filter state
            const currentBodyStyles = JSON.parse(localStorage.getItem('selectedBodyStyles') || '[]');
            const currentPriceRange = JSON.parse(localStorage.getItem('priceRange') || '{"min":"5000","max":"70000"}');
            
            // Check if this search already exists
            const savedSearches = JSON.parse(localStorage.getItem('savedSearches') || '[]');
            const existingSearch = findMatchingSearch(currentBodyStyles, currentPriceRange, savedSearches);
            
            if (existingSearch) {
                // Search already exists, just mark as saved (don't create duplicate)
                console.log('Search already exists, marking as saved');
                return;
            }
            
            // Create new search with prepopulated name
            const searchName = generateSearchName(currentBodyStyles, currentPriceRange);
            const currentFilters = {
                name: searchName,
                bodyStyles: currentBodyStyles,
                priceRange: currentPriceRange,
                timestamp: Date.now()
            };
            
            // Save to localStorage
            savedSearches.push(currentFilters);
            localStorage.setItem('savedSearches', JSON.stringify(savedSearches));
            
            console.log('Search saved:', searchName);
            
            // Update My searches content if it's currently visible
            updateMySearchesContent();
        }

        function findMatchingSearch(bodyStyles, priceRange, savedSearches) {
            return savedSearches.find(search => {
                const bodyStylesMatch = JSON.stringify(search.bodyStyles.sort()) === JSON.stringify(bodyStyles.sort());
                const priceRangeMatch = search.priceRange.min === priceRange.min && 
                                      search.priceRange.max === priceRange.max;
                return bodyStylesMatch && priceRangeMatch;
            });
        }

        function isSearchCurrentlyActive(search, currentBodyStyles, currentPriceRange) {
            const bodyStylesMatch = JSON.stringify(search.bodyStyles.sort()) === JSON.stringify(currentBodyStyles.sort());
            const priceRangeMatch = search.priceRange.min === currentPriceRange.min && 
                                  search.priceRange.max === currentPriceRange.max;
            
            return bodyStylesMatch && priceRangeMatch;
        }

        function cleanupDuplicateSearches() {
            const savedSearches = JSON.parse(localStorage.getItem('savedSearches') || '[]');
            const uniqueSearches = [];
            const seen = new Set();
            
            // Process searches in reverse order (newest first) to keep the most recent version
            for (let i = savedSearches.length - 1; i >= 0; i--) {
                const search = savedSearches[i];
                const key = JSON.stringify({
                    bodyStyles: search.bodyStyles.sort(),
                    priceRange: search.priceRange
                });
                
                if (!seen.has(key)) {
                    seen.add(key);
                    uniqueSearches.unshift(search); // Add to beginning to maintain order
                }
            }
            
            // Only update if we found duplicates
            if (uniqueSearches.length !== savedSearches.length) {
                console.log(`Cleaned up ${savedSearches.length - uniqueSearches.length} duplicate searches`);
                localStorage.setItem('savedSearches', JSON.stringify(uniqueSearches));
                savedSearches.length = 0;
                savedSearches.push(...uniqueSearches);
                updateMySearchesContent();
            }
        }

        function generateSearchName(bodyStyles, priceRange) {
            let name = '';
            
            // Add body styles
            if (bodyStyles.length > 0) {
                name += bodyStyles.join(', ');
            }
            
            // Add price range if not default
            if (priceRange.min !== '5000' || priceRange.max !== '70000') {
                if (name) name += ', ';
                name += `$${parseInt(priceRange.min).toLocaleString()}-$${parseInt(priceRange.max).toLocaleString()}`;
            }
            
            // Fallback if no filters
            if (!name) {
                name = 'All cars';
            }
            
            // Add ellipsis if too long (more than 30 characters)
            if (name.length > 30) {
                name = name.substring(0, 27) + '...';
            }
            
            return name;
        }

        function removeCurrentSearch() {
            // Get current filter state to match against saved searches
            const currentBodyStyles = JSON.parse(localStorage.getItem('selectedBodyStyles') || '[]');
            const currentPriceRange = JSON.parse(localStorage.getItem('priceRange') || '{"min":"5000","max":"70000"}');
            
            // Get saved searches
            const savedSearches = JSON.parse(localStorage.getItem('savedSearches') || '[]');
            
            // Find and remove the matching search
            const updatedSearches = savedSearches.filter(search => {
                // Compare body styles
                const bodyStylesMatch = JSON.stringify(search.bodyStyles.sort()) === JSON.stringify(currentBodyStyles.sort());
                
                // Compare price range
                const priceRangeMatch = search.priceRange.min === currentPriceRange.min && 
                                      search.priceRange.max === currentPriceRange.max;
                
                // Return false to remove this search if it matches current filters
                return !(bodyStylesMatch && priceRangeMatch);
            });
            
            // Update localStorage
            localStorage.setItem('savedSearches', JSON.stringify(updatedSearches));
            
            console.log('Search removed from saved searches');
            
            // Update the "My searches" tab if it's currently open
            updateMySearchesContent();
        }

        function updateSaveSearchButton() {
            console.log('updateSaveSearchButton called, isSearchSaved:', isSearchSaved);
            const saveSearchText = document.getElementById('saveSearchText');
            const saveSearchIcon = document.getElementById('saveSearchIcon');
            
            console.log('saveSearchText found:', !!saveSearchText);
            console.log('saveSearchIcon found:', !!saveSearchIcon);
            
            if (!saveSearchText || !saveSearchIcon) {
                console.log('ERROR: Save search elements not found!');
                return;
            }
            
            if (isSearchSaved) {
                console.log('Setting button to Saved');
                saveSearchText.textContent = 'Saved';
                saveSearchText.style.color = '#006fa6';
                saveSearchText.style.fontWeight = '500';
                saveSearchIcon.src = 'Illustrations/Search saved.svg';
            } else {
                console.log('Setting button to Save search');
                saveSearchText.textContent = 'Save search';
                saveSearchText.style.color = '#006fa6';
                saveSearchText.style.fontWeight = '500';
                saveSearchIcon.src = 'Illustrations/Filter Bar Icons/Saved search.svg';
            }
        }

        function toggleFavorite(button) {
            const icon = button.querySelector('.favorite-icon');
            if (icon.src.includes('favorite.svg')) {
                icon.src = 'Illustrations/Search saved.svg';
            } else {
                icon.src = 'Illustrations/SRP tile/Icon buttons/favorite.svg';
            }
        }

        // Sign-in Modal Functions
        function openSignIn() {
            console.log('Opening sign-in modal');
            const overlay = document.getElementById('signinOverlay');
            const modal = document.getElementById('signinModal');
            
            if (overlay && modal) {
                overlay.style.display = 'block';
                modal.style.display = 'block';
                
                // Trigger slide-in animation
                setTimeout(() => {
                    modal.classList.add('show');
                }, 10);
            }
        }

        function handleSignInClose() {
            console.log('Close button clicked');
            const accountConfirmationContent = document.getElementById('accountConfirmationContent');
            
            // Check if account confirmation is currently showing
            if (accountConfirmationContent && accountConfirmationContent.style.display !== 'none') {
                console.log('Closing from account confirmation - signing user in');
                // User is on account confirmation screen - sign them in
                isSignedIn = true;
                localStorage.setItem('isSignedIn', 'true');
                closeSignIn();
                closeToast();
                updateSaveSearchButton();
                updateMySearchesContent(); // Update My searches content
                // Set flag so they see alert toast instead of sign-in toast
                hasShownAlertToast = false;
                // Don't set hasShownAlertToast = true here - let them see the alerts toast
            } else {
                console.log('Closing from sign-in form - not signing in');
                // User is on sign-in form - just close without signing in
                closeSignIn();
            }
        }

        function closeSignIn() {
            console.log('Closing sign-in modal');
            const overlay = document.getElementById('signinOverlay');
            const modal = document.getElementById('signinModal');
            
            if (overlay && modal) {
                modal.classList.remove('show');
                
                // Hide elements after animation completes
                setTimeout(() => {
                    overlay.style.display = 'none';
                    modal.style.display = 'none';
                    
                    // Reset content back to sign-in form
                    const signinContent = document.querySelector('.signin-content');
                    const accountConfirmationContent = document.getElementById('accountConfirmationContent');
                    
                    if (signinContent && accountConfirmationContent) {
                        signinContent.style.display = 'flex';
                        accountConfirmationContent.style.display = 'none';
                    }
                }, 300);
            }
        }

        function signInWithGoogle() {
            console.log('Sign in with Google clicked');
            // Mock Google sign-in - in real app, this would use Google OAuth
            isSignedIn = true;
            localStorage.setItem('isSignedIn', 'true');
            closeSignIn();
            closeToast();
            updateSaveSearchButton();
            console.log('User signed in with Google successfully');
        }

        function signIn() {
            console.log('Sign in clicked');
            const email = document.getElementById('signinEmail').value.trim();
            const password = document.getElementById('signinPassword').value.trim();
            
            // Clear any existing errors
            clearSignInErrors();
            
            let hasErrors = false;
            
            // Check if email field is empty (no format validation)
            if (!email) {
                console.log('Email is empty, showing error');
                showSignInError('signinEmail', 'Enter your email address.');
                hasErrors = true;
            }
            
            // Check if password field is empty
            if (!password) {
                console.log('Password is empty, showing error');
                showSignInError('signinPassword', 'Enter your password.');
                hasErrors = true;
            }
            
            console.log('Has errors:', hasErrors);
            
            // If there are errors, don't proceed
            if (hasErrors) {
                console.log('Stopping due to errors');
                return;
            }
            
            // Mock authentication - any text is fine, just need both fields filled
            isSignedIn = true;
            localStorage.setItem('isSignedIn', 'true');
            closeSignIn();
            closeToast();
            updateSaveSearchButton();
            updateMySearchesContent(); // Update My searches content
            console.log('User signed in successfully');
        }

        function isValidEmail(email) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }

        function showSignInError(inputId, message) {
            const inputGroup = document.getElementById(inputId).closest('.signin-input-group');
            // Map input IDs to error element IDs
            const errorElementId = inputId === 'signinEmail' ? 'emailError' : 'passwordError';
            const errorElement = document.getElementById(errorElementId);
            
            console.log('showSignInError called:', inputId, message);
            console.log('inputGroup:', inputGroup);
            console.log('errorElementId:', errorElementId);
            console.log('errorElement:', errorElement);
            
            if (inputGroup && errorElement) {
                inputGroup.setAttribute('data-state', 'error');
                errorElement.textContent = message;
                console.log('Error state set for:', inputId);
            } else {
                console.error('Could not find elements for:', inputId);
            }
        }

        function clearSignInErrors() {
            const emailGroup = document.getElementById('signinEmail').closest('.signin-input-group');
            const passwordGroup = document.getElementById('signinPassword').closest('.signin-input-group');
            
            if (emailGroup) {
                emailGroup.setAttribute('data-state', 'default');
            }
            if (passwordGroup) {
                passwordGroup.setAttribute('data-state', 'default');
            }
        }

        // Account Creation Confirmation Functions
        function showAccountConfirmation() {
            console.log('Showing account confirmation');
            
            // Hide the sign-in content and show account confirmation content
            const signinContent = document.querySelector('.signin-content');
            const accountConfirmationContent = document.getElementById('accountConfirmationContent');
            
            if (signinContent && accountConfirmationContent) {
                signinContent.style.display = 'none';
                accountConfirmationContent.style.display = 'flex';
                console.log('Switched to account confirmation content');
            } else {
                console.error('Could not find content elements');
            }
        }

        function closeAccountConfirmation() {
            console.log('Closing account confirmation');
            // Sign the user in since they just created an account
            isSignedIn = true;
            localStorage.setItem('isSignedIn', 'true');
            closeSignIn();
            closeToast();
            updateSaveSearchButton();
            console.log('User signed in after account creation');
            
            // Don't set hasShownAlertToast = true - let them see the alerts toast
        }

        function shopAllCars() {
            console.log('Shop all cars clicked');
            // Sign the user in since they just created an account
            isSignedIn = true;
            localStorage.setItem('isSignedIn', 'true');
            closeSignIn();
            closeToast();
            updateSaveSearchButton();
            updateMySearchesContent(); // Update My searches content for signed-in state
            // Set flag in localStorage to show alert toast when they press save search
            localStorage.setItem('showAlertToast', 'true');
            // Navigate to search results or homepage
            window.location.href = 'search-not-saved.html';
        }

        function viewAccount() {
            console.log('View account clicked');
            // Sign the user in since they just created an account
            isSignedIn = true;
            localStorage.setItem('isSignedIn', 'true');
            closeSignIn();
            closeToast();
            updateSaveSearchButton();
            // Don't set hasShownAlertToast = true - let them see the alerts toast
            // In a real app, this would navigate to account page
            alert('Account page would open here');
        }

        function toggleAlerts(event) {
            // Prevent default link behavior and password save prompt
            if (event) {
                event.preventDefault();
                event.stopPropagation();
            }
            
            console.log('Toggle alerts clicked');
            alertsEnabled = !alertsEnabled;
            localStorage.setItem('alertsEnabled', alertsEnabled.toString());
            
            // Update the toast link text with fade transition
            const toastLink = document.querySelector('.toast-link');
            if (toastLink) {
                // Fade out current text
                toastLink.style.opacity = '0';
                
                setTimeout(() => {
                    if (alertsEnabled) {
                        toastLink.textContent = 'Undo';
                    } else {
                        toastLink.textContent = 'Turn on alerts';
                    }
                    // Fade in new text
                    toastLink.style.opacity = '1';
                }, 150);
            }
            
            console.log('Alerts enabled:', alertsEnabled);
        }

        // Text field state management
        function initTextFieldStates() {
            const inputGroups = document.querySelectorAll('.signin-input-group');
            
            inputGroups.forEach(group => {
                const input = group.querySelector('.signin-input');
                
                // Focus event
                input.addEventListener('focus', () => {
                    group.setAttribute('data-state', 'focus');
                });
                
                // Blur event
                input.addEventListener('blur', () => {
                    if (input.value.trim() !== '') {
                        group.setAttribute('data-state', 'filled');
                    } else {
                        group.setAttribute('data-state', 'default');
                    }
                });
                
                // Input event (for real-time updates)
                input.addEventListener('input', () => {
                    // Clear error state when user starts typing
                    if (group.getAttribute('data-state') === 'error') {
                        group.setAttribute('data-state', 'default');
                    }
                    
                    if (input.value.trim() !== '') {
                        group.setAttribute('data-state', 'filled');
                    }
                });
            });
        }

        // Initialize text field states when modal opens
        function openSignIn() {
            console.log('Opening sign-in modal');
            const overlay = document.getElementById('signinOverlay');
            const modal = document.getElementById('signinModal');
            
            if (overlay && modal) {
                overlay.style.display = 'block';
                modal.style.display = 'block';
                
                // Trigger slide-in animation
                setTimeout(() => {
                    modal.classList.add('show');
                    // Initialize text field states after modal is visible
                    initTextFieldStates();
                }, 10);
            }
        }
    </script>

    <!-- Sign-in Modal -->
    <div class="signin-overlay" id="signinOverlay"></div>
    <div class="signin-modal" id="signinModal">
        <!-- Title Bar -->
        <div class="signin-header">
            <div class="signin-title-bar">
                <h1 class="signin-title-text">Sign in / Create account</h1>
                <button class="signin-close" onclick="handleSignInClose()">
                    <img src="Illustrations/filter menu icons/Filter menu close.svg" alt="Close" class="signin-close-icon">
                </button>
            </div>
        </div>
        
        <!-- Sign-in Content -->
        <div class="signin-content">
            <div class="signin-welcome">
                <h2 class="signin-hello">Hello!</h2>
                <div class="signin-new-user">
                    <span class="signin-new-text">New?</span>
                    <a href="#" class="signin-create-link" onclick="showAccountConfirmation(); return false;">Create an account</a>
                </div>
            </div>
            
            <div class="signin-form">
                <div class="signin-input-group" data-state="default">
                    <input type="text" class="signin-input" id="signinEmail" placeholder="Email address">
                    <label class="signin-input-label">Email address</label>
                    <div class="signin-input-line"></div>
                    <div class="signin-error-message" id="emailError">Enter your email address.</div>
                </div>
                
                <div class="signin-input-group" data-state="default">
                    <input type="text" class="signin-input" id="signinPassword" placeholder="Password">
                    <label class="signin-input-label">Password</label>
                    <div class="signin-input-line"></div>
                    <div class="signin-error-message" id="passwordError">Enter your password.</div>
                </div>
            </div>
            
            <div class="signin-actions">
                <button class="btn-signin-primary" onclick="signIn()">Sign in</button>
                <a href="#" class="signin-forgot-link">Forgot password?</a>
            </div>
        </div>
        
        <!-- Account Creation Confirmation Content (hidden by default) -->
        <div class="account-confirmation-content" id="accountConfirmationContent" style="display: none;">
            <div class="account-confirmation-icon">
                <div class="success-circle">
                    <div class="success-circle-bg"></div>
                    <img src="Illustrations/02_Filter/check.svg" alt="Check" class="success-check">
                </div>
            </div>
            
            <div class="account-confirmation-text">
                <h2 class="account-confirmation-title">You're in!</h2>
                <p class="account-confirmation-message">
                    Your account is ready to roll! <br>
                    Save your favorites and access them anytime, anywhere, on any device. Happy exploring!
                </p>
            </div>
            
            <div class="account-confirmation-actions">
                <button class="btn-primary" onclick="shopAllCars()">Shop all cars</button>
                <button class="btn-secondary" onclick="viewAccount()">View your account</button>
            </div>
        </div>
    </div>

    <script>
        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Page loaded');
            
            // DEBUG: Check navigation elements visibility
            function debugNavigation() {
                const navContainer = document.querySelector('.navigation-container');
                const navTop = document.querySelector('.navigation-top');
                const navLeft = document.querySelector('.navigation-left');
                const navRight = document.querySelector('.navigation-right');
                const logo = document.querySelector('.logo-icon');
                const location = document.querySelector('.location-info');
                
                console.log('=== NAVIGATION DEBUG (REBUILT) ===');
                console.log('navigation-container:', navContainer ? 'found' : 'NOT FOUND');
                console.log('navigation-top:', navTop ? 'found' : 'NOT FOUND');
                console.log('navigation-left:', navLeft ? 'found' : 'NOT FOUND');
                console.log('navigation-right:', navRight ? 'found' : 'NOT FOUND');
                console.log('logo-icon:', logo ? 'found' : 'NOT FOUND');
                console.log('location-info:', location ? 'found' : 'NOT FOUND');
                
                if (navContainer) {
                    const styles = window.getComputedStyle(navContainer);
                    console.log('navigation-container display:', styles.display);
                    console.log('navigation-container visibility:', styles.visibility);
                    console.log('navigation-container opacity:', styles.opacity);
                }
                
                if (navTop) {
                    const styles = window.getComputedStyle(navTop);
                    console.log('navigation-top display:', styles.display);
                    console.log('navigation-top visibility:', styles.visibility);
                    console.log('navigation-top opacity:', styles.opacity);
                }
            }
            
            // Run debug immediately
            debugNavigation();
            
            // Run debug after a delay
            setTimeout(debugNavigation, 1000);
            
            // Run debug when window resizes (developer tools opening might trigger this)
            window.addEventListener('resize', function() {
                console.log('Window resized - checking navigation');
                debugNavigation();
                
                // Force re-render of navigation elements
                const navElements = document.querySelectorAll('.navigation-container, .navigation-top, .navigation-left, .navigation-right, .logo-icon, .location-info, .icon');
                navElements.forEach(element => {
                    if (element) {
                        // Force reflow by reading offsetHeight
                        element.offsetHeight;
                        // Force repaint by temporarily changing and restoring a property
                        const originalTransform = element.style.transform;
                        element.style.transform = 'translateZ(0)';
                        element.offsetHeight; // Force reflow
                        element.style.transform = originalTransform;
                    }
                });
            });
            
            // Reset search saved state if user is not signed in
            if (!isSignedIn) {
                isSearchSaved = false;
                // Clear any saved search state from localStorage
                localStorage.removeItem('savedSearches');
                console.log('User not signed in, resetting isSearchSaved to false');
            } else {
                console.log('User is signed in, restoring state from localStorage');
                // Restore saved searches from localStorage
                const savedSearchesData = localStorage.getItem('savedSearches');
                if (savedSearchesData) {
                    savedSearches = JSON.parse(savedSearchesData);
                }
            }
            
            // Restore filter state (including price range pills)
            restoreFilterState();
            
            // If navigation came from the search bar, prefer unified flow by index
            const pendingIndex = sessionStorage.getItem('selectedSavedSearchIndex');
            if (pendingIndex !== null) {
                const idx = parseInt(pendingIndex, 10);
                if (!isNaN(idx)) {
                    applySavedSearch(idx);
                }
                sessionStorage.removeItem('selectedSavedSearchIndex');
            } else {
                // Only check for saved searches if user is signed in
                if (isSignedIn) {
                    checkIfStillInSavedSearch();
                }
            }
            
            updateSaveSearchButton();
            
            // Check if user should be signed in (from account creation)
            if (localStorage.getItem('showAlertToast') === 'true') {
                console.log('User signed in from account creation');
                isSignedIn = true;
                localStorage.setItem('isSignedIn', 'true');
                updateSaveSearchButton();
                updateMySearchesContent();
                // Don't show toast yet - wait for them to press save search
            }
            
            // Clean up any existing duplicates
            cleanupDuplicateSearches();
        });
    </script>
</body>
</html>
